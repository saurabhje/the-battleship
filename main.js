(()=>{"use strict";const t=function(t,e){t.innerHTML="";for(let n=0;n<100;n++){const o=document.createElement("div");o.dataset.index=n,"player"==e?(o.classList.add("cell"),o.classList.add(`h${n}`)):"computer"==e&&(o.classList.add("enemycell"),o.classList.add(`e${n}`)),t.appendChild(o)}},e=function(){let t=Array(100).fill(null),e=[],n=[];return{getShips:function(){return e.length},getBoard:function(){return t},placeShip:function(n,o){let r=n.length,l=[];for(let t=0;t<r;t++)l.push(o+t);l.forEach((e=>{t[e]=n})),e.push(n)},receiveAttack:function(e){return null===t[e]?(n.push(e),!1):(t[e].hit(),!0)},allShipsSunk:function(){return e.every((t=>t.isSunk()))},missedAttacks:n}},n=function(t){let e=0;return{length:t,hit:()=>(e++,e),isSunk:()=>e===t,get hits(){return e}}};function o(t,e){let n=t+e-1,o=Math.floor(t/10);return!(Math.floor(n/10)>o)}!function(r,l){let i,c;c=e(),i=e();const a=[],u=document.getElementById("playerboard"),s=document.getElementById("compboard");t(u,"player"),t(s,"computer"),function(t,e){{const t=[5,4,3,2];let r=t.length,l=0;for(;l<r;){let r=n(t[l]),i=Math.floor(100*Math.random());o(i,t[l])&&(e.placeShip(r,i),l++)}}}(0,i),c.getShips(),console.log(i.getShips());let d,f=new Set,h=r,p=!1,g=[];function m(t){if(p)return;const e=t.target.dataset.index,n=i.receiveAttack(e);t.target.style.backgroundColor=!0===n?"#f70202":"#02d91b"}function k(){if(g.length>0){const t=g[g.length-1],e=getAdjacentIndex(t);console.log(e);for(const t of e)if(!f.has(t)){d=t;break}g.pop()}else d=function(){let t=Math.floor(100*Math.random());for(;f.has(t);)t=Math.floor(100*Math.random());return t}();!function(t){if(p)return;const e=c.receiveAttack(t),n=u.querySelector(`[data-index='${t}']`);!0===e?(n.style.backgroundColor="#f70202",g.push(t),console.log(g)):n.style.backgroundColor="#02d91b",f.add(t),S(),h=y()}(d)}function y(){return h=h===r?l:r}function S(){return c.allShipsSunk()?(p=!0,document.getElementById("winner").innerText="Computer Win!",void s.removeEventListener("click",m)):i.allShipsSunk()?(p=!0,void(document.getElementById("winner").innerText="You Win!")):void 0}s.addEventListener("click",(t=>{if(shipPlaced){const e=function(t){const e=t.target.dataset.index;return!a.includes(e)&&(a.push(e),!0)}(t);if(e){if(h!==r||p)return;m(t),S(),h=y(),setTimeout(k,100)}}}))}({name:"Player"},{name:"Computer"})})();
//# sourceMappingURL=data:application/json;charset=utf-8;base64,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R0FqQyxFQUFhbUMsaUJBQWlCLFNBQVVDLElBQ3BDLEdBQUdDLFdBQVcsQ0FDWixNQUFNQyxFQWVaLFNBQXFCRixHQUNuQixNQUFNckIsRUFBWXFCLEVBQUVwQixPQUFPdkQsUUFBUUMsTUFDbkMsT0FBSW1DLEVBQWEwQyxTQUFTeEIsS0FHMUJsQixFQUFhbkIsS0FBS3FDLElBQ1gsRUFDVCxDQXRCMkJ5QixDQUFZSixHQUNqQyxHQUFJRSxFQUFjLENBQ2hCLEdBQUk1QixJQUFrQmpCLEdBQVdrQixFQUMvQixPQUVGRSxFQUFZdUIsR0FDWk4sSUFDQXBCLEVBQWdCcUIsSUFDaEJVLFdBQVdyQixFQUFjLElBQzNCLENBQ0YsSUE0Rk4sQ0MxSEEsQ0FBUyxDQUFDc0IsS0FBTSxVQUFXLENBQUNBLEtBQU0sWSIsInNvdXJjZXMiOlsid2VicGFjazovL3RoZS1iYXR0bGVzaGlwLy4vc2NyaXB0L0RPTS5qcyIsIndlYnBhY2s6Ly90aGUtYmF0dGxlc2hpcC8uL3NjcmlwdC9nYW1lYm9hcmQuanMiLCJ3ZWJwYWNrOi8vdGhlLWJhdHRsZXNoaXAvLi9zY3JpcHQvc2hpcC5qcyIsIndlYnBhY2s6Ly90aGUtYmF0dGxlc2hpcC8uL3NjcmlwdC9wbGFjZXNoaXBzLmpzIiwid2VicGFjazovL3RoZS1iYXR0bGVzaGlwLy4vc2NyaXB0L2dhbWVsb29wLmpzIiwid2VicGFjazovL3RoZS1iYXR0bGVzaGlwLy4vc2NyaXB0L2luZGV4LmpzIl0sInNvdXJjZXNDb250ZW50IjpbImNvbnN0IGRvTSA9ICgoKT0+e1xyXG4gICAgZnVuY3Rpb24gcmVuZGVyQm9hcmQoYm9hcmRFbGVtZW50LCBob2xkZXIpIHtcclxuICAgICAgICBib2FyZEVsZW1lbnQuaW5uZXJIVE1MID0gJyc7XHJcbiAgICAgICAgZm9yIChsZXQgaSA9IDA7IGkgPCAxMDA7IGkrKykge1xyXG4gICAgICAgICAgICBjb25zdCBjZWxsID0gZG9jdW1lbnQuY3JlYXRlRWxlbWVudCgnZGl2Jyk7XHJcbiAgICAgICAgICAgIGNlbGwuZGF0YXNldC5pbmRleCA9IGk7XHJcbiAgICAgICAgICAgIGlmKGhvbGRlciA9PSBcInBsYXllclwiKXtcclxuICAgICAgICAgICAgICAgIGNlbGwuY2xhc3NMaXN0LmFkZCgnY2VsbCcpO1xyXG4gICAgICAgICAgICAgICAgY2VsbC5jbGFzc0xpc3QuYWRkKGBoJHtpfWApO1xyXG4gICAgICAgICAgICB9XHJcbiAgICAgICAgICAgIGVsc2UgaWYoaG9sZGVyID09IFwiY29tcHV0ZXJcIil7XHJcbiAgICAgICAgICAgICAgICBjZWxsLmNsYXNzTGlzdC5hZGQoJ2VuZW15Y2VsbCcpO1xyXG4gICAgICAgICAgICAgICAgY2VsbC5jbGFzc0xpc3QuYWRkKGBlJHtpfWApO1xyXG4gICAgICAgICAgICB9XHJcbiAgICAgICAgICAgIGJvYXJkRWxlbWVudC5hcHBlbmRDaGlsZChjZWxsKTtcclxuICAgICAgICB9XHJcbiAgICB9O1xyXG5cclxuICAgIHJldHVybiB7XHJcbiAgICAgICAgcmVuZGVyQm9hcmRcclxuICAgIH1cclxufSkoKTtcclxuXHJcblxyXG5leHBvcnQgZGVmYXVsdCBkb00iLCJpbXBvcnQgU2hpcCBmcm9tIFwiLi9zaGlwXCI7XHJcbmZ1bmN0aW9uIEdhbWVib2FyZCgpIHtcclxuICBsZXQgYm9hcmQgPSBBcnJheSgxMDApLmZpbGwobnVsbCk7XHJcbiAgbGV0IHNoaXBzID0gW107XHJcbiAgbGV0IG1pc3NlZEF0dGFja3MgPSBbXTtcclxuXHJcblxyXG4gIGZ1bmN0aW9uIHBsYWNlU2hpcChzaGlwLGluZGV4KSB7XHJcbiAgICBsZXQgc2hpcGxlbmd0aCA9IHNoaXAubGVuZ3RoO1xyXG4gICAgbGV0IGNvb3JkaW5hdGVzID0gW107XHJcbiAgICBmb3IobGV0IGk9MDtpPHNoaXBsZW5ndGg7aSsrKXtcclxuICAgICAgY29vcmRpbmF0ZXMucHVzaChpbmRleCtpKTtcclxuICAgIH1cclxuICAgIGNvb3JkaW5hdGVzLmZvckVhY2goY29vcmQgPT4ge1xyXG4gICAgICBib2FyZFtjb29yZF0gPSBzaGlwO1xyXG4gICAgfSk7XHJcbiAgICBzaGlwcy5wdXNoKHNoaXApO1xyXG5cclxuICB9XHJcbiAgXHJcbiAgZnVuY3Rpb24gcmVjZWl2ZUF0dGFjayhjb29yZGluYXRlcykge1xyXG4gICAgaWYgKGJvYXJkW2Nvb3JkaW5hdGVzXSA9PT0gbnVsbCkge1xyXG4gICAgICBtaXNzZWRBdHRhY2tzLnB1c2goY29vcmRpbmF0ZXMpO1xyXG4gICAgICByZXR1cm4gZmFsc2U7XHJcbiAgICB9XHJcbiAgICBjb25zdCBoaXRTaGlwID0gYm9hcmRbY29vcmRpbmF0ZXNdO1xyXG4gICAgaGl0U2hpcC5oaXQoKTtcclxuICAgIHJldHVybiB0cnVlO1xyXG4gIH1cclxuXHJcbiAgZnVuY3Rpb24gYWxsU2hpcHNTdW5rKCkge1xyXG4gICAgcmV0dXJuIHNoaXBzLmV2ZXJ5KHNoaXAgPT4gc2hpcC5pc1N1bmsoKSk7XHJcbiAgfVxyXG4gIGZ1bmN0aW9uIGdldEJvYXJkKCl7XHJcbiAgICByZXR1cm4gYm9hcmQ7XHJcbiAgfVxyXG4gIGZ1bmN0aW9uIGdldFNoaXBzKCl7XHJcbiAgICByZXR1cm4gc2hpcHMubGVuZ3RoO1xyXG4gIH1cclxuICByZXR1cm4ge1xyXG4gICAgZ2V0U2hpcHMsXHJcbiAgICBnZXRCb2FyZCxcclxuICAgIHBsYWNlU2hpcCxcclxuICAgIHJlY2VpdmVBdHRhY2ssXHJcbiAgICBhbGxTaGlwc1N1bmssXHJcbiAgICBtaXNzZWRBdHRhY2tzLFxyXG4gIH07XHJcbn1cclxuXHJcbmV4cG9ydCBkZWZhdWx0IEdhbWVib2FyZDsiLCJmdW5jdGlvbiBTaGlwKGxlbmd0aCkge1xyXG4gIGxldCBoaXRzID0gMDtcclxuXHJcbiAgcmV0dXJuIHtcclxuICAgIGxlbmd0aDogbGVuZ3RoLFxyXG4gICAgaGl0KCkge1xyXG4gICAgICBoaXRzKytcclxuICAgICAgcmV0dXJuIGhpdHM7XHJcbiAgICB9LFxyXG4gICAgaXNTdW5rKCkge1xyXG4gICAgICByZXR1cm4gaGl0cyA9PT0gbGVuZ3RoO1xyXG4gICAgfSxcclxuICAgIGdldCBoaXRzKCl7XHJcbiAgICAgIHJldHVybiBoaXRzO1xyXG4gICAgfVxyXG4gIH07XHJcbn1cclxuZXhwb3J0IGRlZmF1bHQgU2hpcDsiLCJpbXBvcnQgU2hpcCBmcm9tIFwiLi9zaGlwXCI7XHJcbmltcG9ydCBHYW1lYm9hcmQgZnJvbSBcIi4vZ2FtZWJvYXJkXCI7XHJcblxyXG5mdW5jdGlvbiBwbGFjZXNoaXBzKGhvbGRlciwgcGxheWVyYm9hcmQpIHtcclxuICBpZiAoaG9sZGVyID09PSBcInBsYXllclwiKSB7XHJcbiAgICBjb25zdCBzaGlwc0xlbmd0aCA9IFs1LCA0LCAzLCAyXTtcclxuICAgIGxldCBzaGlwc2xlbiA9IHNoaXBzTGVuZ3RoLmxlbmd0aDtcclxuICAgIGNvbnN0IGNlbGxzID0gZG9jdW1lbnQucXVlcnlTZWxlY3RvckFsbCgnLmNlbGwnKTtcclxuICAgIGxldCBnYW1lID0gdHJ1ZTtcclxuICAgIGxldCBpID0gMDtcclxuICAgIGNvbnN0IHR1cm4gPSBkb2N1bWVudC5nZXRFbGVtZW50QnlJZCgndHVybicpO1xyXG4gICAgaWYgKGdhbWUpIHtcclxuICAgICAgY2VsbHMuZm9yRWFjaChjZWxsID0+IHtcclxuICAgICAgICBjZWxsLmFkZEV2ZW50TGlzdGVuZXIoJ2NsaWNrJywgKGV2ZW50KSA9PiB7XHJcbiAgICAgICAgICBjb25zdCBjZWxsID0gZXZlbnQudGFyZ2V0O1xyXG4gICAgICAgICAgY29uc3QgaW5kZXggPSBwYXJzZUludChjZWxsLmRhdGFzZXQuaW5kZXgpO1xyXG4gICAgICAgICAgY29uc3QgY2FuUGxhY2VTaGlwID0gY2hlY2tTaGlwUGxhY2VtZW50KHBsYXllcmJvYXJkLCBpbmRleCwgc2hpcHNMZW5ndGhbaV0pO1xyXG4gICAgICAgICAgY29uc3Qgbm9PdmVybGFwID0gY2hlY2tPdmVybGFwKGluZGV4LCBzaGlwc0xlbmd0aFtpXSk7XHJcbiAgICAgICAgICBpZihpID09MCl7XHJcbiAgICAgICAgICAgIHR1cm4uaW5uZXJUZXh0ID0gXCJQbGFjZSB5b3VyIFN1Ym1hcmluZVwiO1xyXG4gICAgICAgICAgfVxyXG4gICAgICAgICAgZWxzZSBpZihpPT0xKXtcclxuICAgICAgICAgICAgdHVybi5pbm5lclRleHQgPSBcIlBsYWNlIHlvdXIgQXR0YWNrZXJyXCI7XHJcbiAgICAgICAgICB9XHJcbiAgICAgICAgICBlbHNlIGlmKGk9PTIpe1xyXG4gICAgICAgICAgICB0dXJuLmlubmVyVGV4dCA9IFwiUGxhY2UgeW91ciBTaGlwXCI7XHJcbiAgICAgICAgICB9XHJcbiAgICAgICAgICBlbHNle1xyXG4gICAgICAgICAgICB0dXJuLmlubmVyVGV4dCA9IFwiUGxheVwiO1xyXG4gICAgICAgICAgfVxyXG4gICAgICAgICAgaWYgKGNhblBsYWNlU2hpcCAmJiBub092ZXJsYXApIHtcclxuICAgICAgICAgICAgY29uc3Qgc2hpcCA9IFNoaXAoc2hpcHNMZW5ndGhbaV0pO1xyXG4gICAgICAgICAgICBwbGF5ZXJib2FyZC5wbGFjZVNoaXAoc2hpcCwgaW5kZXgpOyAgXHJcbiAgICAgICAgICAgIGZvciAobGV0IGsgPSAwOyBrIDwgc2hpcHNMZW5ndGhbaV07IGsrKykge1xyXG4gICAgICAgICAgICAgIGRvY3VtZW50LnF1ZXJ5U2VsZWN0b3IoYC5oJHtpbmRleCArIGt9YCkuc3R5bGUuYmFja2dyb3VuZENvbG9yID0gXCIjMjkyODI4XCI7XHJcbiAgICAgICAgICAgIH1cclxuICAgICAgICAgICAgaSsrO1xyXG4gICAgICAgICAgICBpZiAoaSA9PT0gc2hpcHNsZW4pIHtcclxuICAgICAgICAgICAgICBnYW1lID0gZmFsc2U7XHJcbiAgICAgICAgICAgIH1cclxuICAgICAgICAgIH1cclxuICAgICAgICB9KTtcclxuICAgICAgfSk7XHJcbiAgICB9XHJcbiAgICByZXR1cm4gdHJ1ZTtcclxuICB9IGVsc2UgaWYgKGhvbGRlciA9PT0gXCJjb21wdXRlclwiKSB7XHJcbiAgICBjb25zdCBzaGlwc0xlbmd0aCA9IFs1LCA0LCAzLCAyXTtcclxuICAgIGxldCBzaGlwc2xlbiA9IHNoaXBzTGVuZ3RoLmxlbmd0aDtcclxuICAgIGxldCBpID0gMDtcclxuICAgIFxyXG4gICAgd2hpbGUgKGkgPCBzaGlwc2xlbikge1xyXG4gICAgICBsZXQgc2hpcCA9IFNoaXAoc2hpcHNMZW5ndGhbaV0pO1xyXG4gICAgICBsZXQgaW5kZXggPSBNYXRoLmZsb29yKE1hdGgucmFuZG9tKCkgKiAxMDApO1xyXG4gICAgICBjb25zdCBub092ZXJsYXAgPSBjaGVja092ZXJsYXAoaW5kZXgsIHNoaXBzTGVuZ3RoW2ldKTtcclxuXHJcbiAgICAgIGlmICghbm9PdmVybGFwKSB7IC8vIENoZWNrIGlmIHRoZSBzaGlwIGlzIG92ZXJsYXBwaW5nXHJcbiAgICAgICAgY29udGludWU7XHJcbiAgICAgIH0gXHJcbiAgICAgIHBsYXllcmJvYXJkLnBsYWNlU2hpcChzaGlwLCBpbmRleCk7XHJcbiAgICAgIGkrKzsgXHJcbiAgICB9ICAgICBcclxuICB9XHJcbn1cclxuXHJcbmZ1bmN0aW9uIGNoZWNrT3ZlcmxhcChzdGFydEluZGV4LCBsZW5ndGgpIHtcclxuICBsZXQgbGFzdENlbGxJbmRleCA9IHN0YXJ0SW5kZXggKyBsZW5ndGggLSAxO1xyXG4gIGxldCBpbmRleHJvdyA9IE1hdGguZmxvb3Ioc3RhcnRJbmRleCAvIDEwKTtcclxuICBsZXQgbGFzdHJvdyA9IE1hdGguZmxvb3IobGFzdENlbGxJbmRleCAvIDEwKTtcclxuICBcclxuICBpZiAobGFzdHJvdyA+IGluZGV4cm93KSB7XHJcbiAgICByZXR1cm4gZmFsc2U7XHJcbiAgfVxyXG4gIFxyXG4gIHJldHVybiB0cnVlO1xyXG59XHJcblxyXG5mdW5jdGlvbiBjaGVja1NoaXBQbGFjZW1lbnQocGxheWVyYm9hcmQsIHN0YXJ0SW5kZXgsIGxlbmd0aCkge1xyXG4gIGNvbnN0IGJvYXJkID0gcGxheWVyYm9hcmQuZ2V0Qm9hcmQoKTtcclxuICBmb3IgKGxldCBpID0gMDsgaSA8IGxlbmd0aDsgaSsrKSB7XHJcbiAgICBjb25zdCBpbmRpY2VzID0gc3RhcnRJbmRleCArIGk7XHJcblxyXG4gICAgaWYgKGJvYXJkW2luZGljZXNdICE9PSBudWxsKSB7XHJcbiAgICAgIHJldHVybiBmYWxzZTtcclxuICAgIH1cclxuICB9XHJcbiAgXHJcbiAgcmV0dXJuIHRydWU7XHJcbn1cclxuXHJcbmV4cG9ydCB7IHBsYWNlc2hpcHMgfTtcclxuIiwiaW1wb3J0IEdhbWVib2FyZCBmcm9tIFwiLi9nYW1lYm9hcmRcIjtcclxuaW1wb3J0IGRvTSBmcm9tIFwiLi9ET01cIjtcclxuaW1wb3J0IHsgcGxhY2VzaGlwcyB9IGZyb20gXCIuL3BsYWNlc2hpcHNcIjtcclxuXHJcbmZ1bmN0aW9uIGdhbWVMb29wKHBsYXllcjEsIHBsYXllcjIpIHtcclxuICBsZXQgY29tcGJvYXJkLCBwbGF5ZXJib2FyZDtcclxuICBwbGF5ZXJib2FyZCA9IEdhbWVib2FyZCgpO1xyXG4gIGNvbXBib2FyZCA9IEdhbWVib2FyZCgpO1xyXG4gIGNvbnN0IGNsaWNrZWRDZWxscyA9IFtdO1xyXG4gIGNvbnN0IHBsYXllcjFib2FyZCA9IGRvY3VtZW50LmdldEVsZW1lbnRCeUlkKFwicGxheWVyYm9hcmRcIik7XHJcbiAgY29uc3QgcGxheWVyMmJvYXJkID0gZG9jdW1lbnQuZ2V0RWxlbWVudEJ5SWQoXCJjb21wYm9hcmRcIik7XHJcbiAgZG9NLnJlbmRlckJvYXJkKHBsYXllcjFib2FyZCwgXCJwbGF5ZXJcIik7XHJcbiAgZG9NLnJlbmRlckJvYXJkKHBsYXllcjJib2FyZCwgXCJjb21wdXRlclwiKTtcclxuXHJcblxyXG4gIHBsYWNlc2hpcHMoXCJjb21wdXRlclwiLCBjb21wYm9hcmQpO1xyXG5cclxuICBsZXQgcGxheWVyU2hpcHMgPSBwbGF5ZXJib2FyZC5nZXRTaGlwcygpO1xyXG4gIGNvbnNvbGUubG9nKGNvbXBib2FyZC5nZXRTaGlwcygpKTtcclxuICBsZXQgcHJldmlvdXNBdHRhY2sgPSBuZXcgU2V0KCk7IC8vdG8gcHJldmVudCB0aGUgY29tcCBmcm9tIGF0dGFja2luZyB0aGUgc2FtZSBpbmRleCB0d2ljZVxyXG4gIGxldCBjdXJyZW50UGxheWVyID0gcGxheWVyMTtcclxuICBsZXQgZ2FtZU92ZXIgPSBmYWxzZTtcclxuICBsZXQgcHJldmlvdXNIaXRzID0gW107XHJcblxyXG4gIFxyXG4gIHBsYXllcjJib2FyZC5hZGRFdmVudExpc3RlbmVyKFwiY2xpY2tcIiwgKGUpID0+IHtcclxuICAgICAgaWYoc2hpcFBsYWNlZCl7XHJcbiAgICAgICAgY29uc3QgaXN2YWxpZGNsaWNrID0gY2hlY2tEb3VibGUoZSk7XHJcbiAgICAgICAgaWYgKGlzdmFsaWRjbGljaykge1xyXG4gICAgICAgICAgaWYgKGN1cnJlbnRQbGF5ZXIgIT09IHBsYXllcjEgfHwgZ2FtZU92ZXIpIHtcclxuICAgICAgICAgICAgcmV0dXJuO1xyXG4gICAgICAgICAgfVxyXG4gICAgICAgICAgaGFuZGxlQ2xpY2soZSk7XHJcbiAgICAgICAgICBjaGVja2dhbWVPdmVyKCk7XHJcbiAgICAgICAgICBjdXJyZW50UGxheWVyID0gc3dpdGNoUGxheWVyKCk7XHJcbiAgICAgICAgICBzZXRUaW1lb3V0KGNvbXB1dGVyVHVybiwgMTAwKTtcclxuICAgICAgICB9XHJcbiAgICAgIH1cclxuXHJcbiAgICB9KTtcclxuXHJcblxyXG4gIGZ1bmN0aW9uIGNoZWNrRG91YmxlKGUpIHtcclxuICAgIGNvbnN0IGNlbGxpbmRleCA9IGUudGFyZ2V0LmRhdGFzZXQuaW5kZXg7XHJcbiAgICBpZiAoY2xpY2tlZENlbGxzLmluY2x1ZGVzKGNlbGxpbmRleCkpIHtcclxuICAgICAgcmV0dXJuIGZhbHNlO1xyXG4gICAgfVxyXG4gICAgY2xpY2tlZENlbGxzLnB1c2goY2VsbGluZGV4KTtcclxuICAgIHJldHVybiB0cnVlO1xyXG4gIH1cclxuXHJcbiAgZnVuY3Rpb24gaGFuZGxlQ2xpY2soZXZlbnQpIHtcclxuICAgIGlmIChnYW1lT3Zlcikge1xyXG4gICAgICByZXR1cm47XHJcbiAgICB9XHJcbiAgICBjb25zdCBjZWxsaW5kZXggPSBldmVudC50YXJnZXQuZGF0YXNldC5pbmRleDtcclxuICAgIGNvbnN0IHJlc3VsdCA9IGNvbXBib2FyZC5yZWNlaXZlQXR0YWNrKGNlbGxpbmRleCk7XHJcbiAgICBpZiAocmVzdWx0ID09PSB0cnVlKSB7XHJcbiAgICAgIGV2ZW50LnRhcmdldC5zdHlsZS5iYWNrZ3JvdW5kQ29sb3IgPSBcIiNmNzAyMDJcIjtcclxuICAgIH0gZWxzZSB7XHJcbiAgICAgIGV2ZW50LnRhcmdldC5zdHlsZS5iYWNrZ3JvdW5kQ29sb3IgPSBcIiMwMmQ5MWJcIjtcclxuICAgIH1cclxuICB9XHJcblxyXG4gIGxldCBhdHRhY2tJbmRleDtcclxuXHJcbiAgZnVuY3Rpb24gY29tcHV0ZXJUdXJuKCkge1xyXG4gICAgaWYocHJldmlvdXNIaXRzLmxlbmd0aCA+IDApe1xyXG4gICAgICBjb25zdCBsYXN0QXR0YWNrID0gcHJldmlvdXNIaXRzW3ByZXZpb3VzSGl0cy5sZW5ndGggLSAxXTtcclxuICAgICAgY29uc3QgbGFzdEFkamFjZW50SW5kZXggPSBnZXRBZGphY2VudEluZGV4KGxhc3RBdHRhY2spO1xyXG4gICAgICBjb25zb2xlLmxvZyhsYXN0QWRqYWNlbnRJbmRleCk7XHJcbiAgICAgIGZvcihjb25zdCBpbmRleCBvZiBsYXN0QWRqYWNlbnRJbmRleCl7XHJcbiAgICAgICAgaWYoIXByZXZpb3VzQXR0YWNrLmhhcyhpbmRleCkpe1xyXG4gICAgICAgICAgYXR0YWNrSW5kZXggPSBpbmRleDtcclxuICAgICAgICAgIGJyZWFrO1xyXG4gICAgICAgIH1cclxuICAgICAgfVxyXG4gICAgICBwcmV2aW91c0hpdHMucG9wKCk7IFxyXG4gICAgfVxyXG4gICAgZWxzZXtcclxuICAgICAgYXR0YWNrSW5kZXggPSByYW5kb21BdHRhY2soKTtcclxuICAgIH1cclxuXHJcbiAgICBjb21wdXRlckFJKGF0dGFja0luZGV4KTtcclxuICB9XHJcblxyXG4gIGZ1bmN0aW9uIHJhbmRvbUF0dGFjaygpIHtcclxuICAgIGxldCB4ID0gTWF0aC5mbG9vcihNYXRoLnJhbmRvbSgpICogMTAwKTtcclxuICAgIHdoaWxlIChwcmV2aW91c0F0dGFjay5oYXMoeCkpIHtcclxuICAgICAgeCA9IE1hdGguZmxvb3IoTWF0aC5yYW5kb20oKSAqIDEwMCk7XHJcbiAgICB9XHJcbiAgICByZXR1cm4geDtcclxuICB9XHJcblxyXG4gIGZ1bmN0aW9uIGNvbXB1dGVyQUkoaSkge1xyXG4gICAgaWYgKGdhbWVPdmVyKSB7XHJcbiAgICAgIHJldHVybjtcclxuICAgIH1cclxuICAgIGNvbnN0IGNvbXBoaXQgPSBwbGF5ZXJib2FyZC5yZWNlaXZlQXR0YWNrKGkpO1xyXG4gICAgY29uc3QgY2VsbCA9IHBsYXllcjFib2FyZC5xdWVyeVNlbGVjdG9yKGBbZGF0YS1pbmRleD0nJHtpfSddYCk7XHJcbiAgICBpZiAoY29tcGhpdCA9PT0gdHJ1ZSkge1xyXG4gICAgICBjZWxsLnN0eWxlLmJhY2tncm91bmRDb2xvciA9IFwiI2Y3MDIwMlwiO1xyXG4gICAgICBwcmV2aW91c0hpdHMucHVzaChpKTtcclxuICAgICAgY29uc29sZS5sb2cocHJldmlvdXNIaXRzKTtcclxuICAgIH0gZWxzZSB7XHJcbiAgICAgIGNlbGwuc3R5bGUuYmFja2dyb3VuZENvbG9yID0gXCIjMDJkOTFiXCI7XHJcbiAgICB9XHJcbiAgICBwcmV2aW91c0F0dGFjay5hZGQoaSk7XHJcbiAgICBjaGVja2dhbWVPdmVyKCk7XHJcbiAgICBjdXJyZW50UGxheWVyID0gc3dpdGNoUGxheWVyKCk7XHJcbiAgfVxyXG5cclxuICBmdW5jdGlvbiBzd2l0Y2hQbGF5ZXIoKSB7XHJcbiAgICByZXR1cm4gKGN1cnJlbnRQbGF5ZXIgPSBjdXJyZW50UGxheWVyID09PSBwbGF5ZXIxID8gcGxheWVyMiA6IHBsYXllcjEpO1xyXG4gIH1cclxuXHJcbiAgZnVuY3Rpb24gY2hlY2tnYW1lT3ZlcigpIHtcclxuICAgIGlmIChwbGF5ZXJib2FyZC5hbGxTaGlwc1N1bmsoKSkge1xyXG4gICAgICBnYW1lT3ZlciA9IHRydWU7XHJcbiAgICAgIGRvY3VtZW50LmdldEVsZW1lbnRCeUlkKCd3aW5uZXInKS5pbm5lclRleHQgPSBcIkNvbXB1dGVyIFdpbiFcIjtcclxuICAgICAgcGxheWVyMmJvYXJkLnJlbW92ZUV2ZW50TGlzdGVuZXIoXCJjbGlja1wiLCBoYW5kbGVDbGljayk7XHJcbiAgICAgIHJldHVybjtcclxuICAgIH1cclxuICAgIGlmIChjb21wYm9hcmQuYWxsU2hpcHNTdW5rKCkpIHtcclxuICAgICAgZ2FtZU92ZXIgPSB0cnVlO1xyXG4gICAgICBkb2N1bWVudC5nZXRFbGVtZW50QnlJZCgnd2lubmVyJykuaW5uZXJUZXh0ID0gXCJZb3UgV2luIVwiO1xyXG4gICAgICByZXR1cm47XHJcbiAgICB9XHJcbiAgfVxyXG59XHJcblxyXG5leHBvcnQgZGVmYXVsdCBnYW1lTG9vcDtcclxuIiwiaW1wb3J0IGRvTSBmcm9tIFwiLi9ET01cIjtcclxuaW1wb3J0IFBsYXllciBmcm9tIFwiLi9wbGF5ZXJcIjtcclxuaW1wb3J0IEdhbWVib2FyZCBmcm9tIFwiLi9nYW1lYm9hcmRcIjtcclxuaW1wb3J0IFNoaXAgZnJvbSBcIi4vc2hpcFwiO1xyXG5pbXBvcnQgZ2FtZUxvb3AgZnJvbSBcIi4vZ2FtZWxvb3BcIjtcclxuXHJcblxyXG5nYW1lTG9vcCh7bmFtZTogXCJQbGF5ZXJcIn0sIHtuYW1lOiBcIkNvbXB1dGVyXCJ9KTtcclxuIl0sIm5hbWVzIjpbImJvYXJkRWxlbWVudCIsImhvbGRlciIsImlubmVySFRNTCIsImkiLCJjZWxsIiwiZG9jdW1lbnQiLCJjcmVhdGVFbGVtZW50IiwiZGF0YXNldCIsImluZGV4IiwiY2xhc3NMaXN0IiwiYWRkIiwiYXBwZW5kQ2hpbGQiLCJib2FyZCIsIkFycmF5IiwiZmlsbCIsInNoaXBzIiwibWlzc2VkQXR0YWNrcyIsImdldFNoaXBzIiwibGVuZ3RoIiwiZ2V0Qm9hcmQiLCJwbGFjZVNoaXAiLCJzaGlwIiwic2hpcGxlbmd0aCIsImNvb3JkaW5hdGVzIiwicHVzaCIsImZvckVhY2giLCJjb29yZCIsInJlY2VpdmVBdHRhY2siLCJoaXQiLCJhbGxTaGlwc1N1bmsiLCJldmVyeSIsImlzU3VuayIsImhpdHMiLCJjaGVja092ZXJsYXAiLCJzdGFydEluZGV4IiwibGFzdENlbGxJbmRleCIsImluZGV4cm93IiwiTWF0aCIsImZsb29yIiwicGxheWVyMSIsInBsYXllcjIiLCJjb21wYm9hcmQiLCJwbGF5ZXJib2FyZCIsImNsaWNrZWRDZWxscyIsInBsYXllcjFib2FyZCIsImdldEVsZW1lbnRCeUlkIiwicGxheWVyMmJvYXJkIiwic2hpcHNMZW5ndGgiLCJzaGlwc2xlbiIsInJhbmRvbSIsInBsYWNlc2hpcHMiLCJjb25zb2xlIiwibG9nIiwiYXR0YWNrSW5kZXgiLCJwcmV2aW91c0F0dGFjayIsIlNldCIsImN1cnJlbnRQbGF5ZXIiLCJnYW1lT3ZlciIsInByZXZpb3VzSGl0cyIsImhhbmRsZUNsaWNrIiwiZXZlbnQiLCJjZWxsaW5kZXgiLCJ0YXJnZXQiLCJyZXN1bHQiLCJzdHlsZSIsImJhY2tncm91bmRDb2xvciIsImNvbXB1dGVyVHVybiIsImxhc3RBdHRhY2siLCJsYXN0QWRqYWNlbnRJbmRleCIsImdldEFkamFjZW50SW5kZXgiLCJoYXMiLCJwb3AiLCJ4IiwicmFuZG9tQXR0YWNrIiwiY29tcGhpdCIsInF1ZXJ5U2VsZWN0b3IiLCJjaGVja2dhbWVPdmVyIiwic3dpdGNoUGxheWVyIiwiY29tcHV0ZXJBSSIsImlubmVyVGV4dCIsInJlbW92ZUV2ZW50TGlzdGVuZXIiLCJhZGRFdmVudExpc3RlbmVyIiwiZSIsInNoaXBQbGFjZWQiLCJpc3ZhbGlkY2xpY2siLCJpbmNsdWRlcyIsImNoZWNrRG91YmxlIiwic2V0VGltZW91dCIsIm5hbWUiXSwic291cmNlUm9vdCI6IiJ9