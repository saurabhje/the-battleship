(()=>{"use strict";const t=function(t,e){t.innerHTML="";for(let n=0;n<100;n++){const l=document.createElement("div");l.dataset.index=n,"player"==e?(l.classList.add("cell"),l.classList.add(`h${n}`)):"computer"==e&&(l.classList.add("enemycell"),l.classList.add(`e${n}`)),t.appendChild(l)}},e=function(){let t=Array(100).fill(null),e=[],n=[];return{getShips:function(){return e.length},getBoard:function(){return t},placeShip:function(n,l){let r=n.length,o=[];for(let t=0;t<r;t++)o.push(l+t);o.forEach((e=>{t[e]=n})),e.push(n)},receiveAttack:function(e){return null===t[e]?(n.push(e),!1):(t[e].hit(),!0)},allShipsSunk:function(){return e.every((t=>t.isSunk()))},missedAttacks:n}},n=function(t){let e=0;return{length:t,hit:()=>(e++,e),isSunk:()=>e===t,get hits(){return e}}};function l(t,e){if("player"===t){const t=[5,4,3,2];let l=t.length;const o=document.querySelectorAll(".cell");let u=!0,c=0;const i=document.getElementById("turn");return u&&o.forEach((o=>{o.addEventListener("click",(o=>{const a=o.target,s=parseInt(a.dataset.index),d=function(t,e,n){const l=t.getBoard();for(let t=0;t<n;t++)if(null!==l[e+t])return!1;return!0}(e,s,t[c]),f=r(s,t[c]);if(i.innerText=0==c?"Place your Submarine":1==c?"Place your Attackerr":2==c?"Place your Ship":"Play",d&&f){const r=n(t[c]);e.placeShip(r,s);for(let e=0;e<t[c];e++)document.querySelector(`.h${s+e}`).style.backgroundColor="#292828";c++,c===l&&(u=!1)}}))})),!0}if("computer"===t){const t=[5,4,3,2];let l=t.length,o=0;for(;o<l;){let l=n(t[o]),u=Math.floor(100*Math.random());r(u,t[o])&&(e.placeShip(l,u),o++)}return!0}}function r(t,e){let n=t+e-1,l=Math.floor(t/10);return!(Math.floor(n/10)>l)}!function(n,r){let o,u;u=e(),o=e();const c=[],i=document.getElementById("playerboard"),a=document.getElementById("compboard");t(i,"player"),t(a,"computer");let s=!1;s=l("player",u);let d=!1;d=l("computer",o),console.log(o.getShips());let f,h=new Set,m=n,p=!1;function y(t){if(p)return;const e=t.target.dataset.index,n=o.receiveAttack(e);t.target.style.backgroundColor=!0===n?"#f70202":"#02d91b"}a.addEventListener("click",(t=>{if(s&&d){const e=function(t){const e=t.target.dataset.index;return!c.includes(e)&&(c.push(e),!0)}(t);if(e){if(m!==n||p)return;y(t),E(),m=v(),setTimeout(k,100)}}}));let g,S=null;function k(){null!=g||null!=S?null!=g?(f=g,g-=1):null!=S&&(f=S,S+=1):f=function(){let t=Math.floor(100*Math.random());for(;h.has(t);)t=Math.floor(100*Math.random());return t}(),function(t){if(p)return;const e=u.receiveAttack(t),n=i.querySelector(`[data-index='${t}']`);!0===e?(n.style.backgroundColor="#f70202",null==g&&(g=t-1),h.has(g)&&(g=null),null==S&&(S=t+1),h.has(S)&&(S=null)):(n.style.backgroundColor="#02d91b",null!=g?g=null:S=null),h.add(t),E(),m=v()}(f)}function v(){return m=m===n?r:n}function E(){return u.allShipsSunk()?(p=!0,document.getElementById("winner").innerText="Computer Win!",void a.removeEventListener("click",y)):o.allShipsSunk()?(p=!0,void(document.getElementById("winner").innerText="You Win!")):void 0}}({name:"Player"},{name:"Computer"})})();
//# sourceMappingURL=data:application/json;charset=utf-8;base64,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VUFDbEIsTUFBUmdDLEVBQ0RBLEVBQU8sS0FHUEMsRUFBUSxNQUdaaEIsRUFBZTlELElBQUlQLEdBQ25CZ0YsSUFDQVQsRUFBZ0JVLEdBQ2xCLENBM0NFUyxDQUFXdEIsRUFDYixDQTRDQSxTQUFTYSxJQUNQLE9BQVFWLEVBQWdCQSxJQUFrQmIsRUFBVUMsRUFBVUQsQ0FDaEUsQ0FFQSxTQUFTc0IsSUFDUCxPQUFJakQsRUFBWUwsZ0JBQ2Q4QyxHQUFXLEVBQ1h0RSxTQUFTb0MsZUFBZSxVQUFVVSxVQUFZLHFCQUM5Q2UsRUFBYTRCLG9CQUFvQixRQUFTbEIsSUFHeENiLEVBQVVsQyxnQkFDWjhDLEdBQVcsT0FDWHRFLFNBQVNvQyxlQUFlLFVBQVVVLFVBQVksa0JBRmhELENBS0YsQ0FDRixDQzFJQSxDQUFTLENBQUM0QyxLQUFNLFVBQVcsQ0FBQ0EsS0FBTSxZIiwic291cmNlcyI6WyJ3ZWJwYWNrOi8vdGhlLWJhdHRsZXNoaXAvLi9zY3JpcHQvRE9NLmpzIiwid2VicGFjazovL3RoZS1iYXR0bGVzaGlwLy4vc2NyaXB0L2dhbWVib2FyZC5qcyIsIndlYnBhY2s6Ly90aGUtYmF0dGxlc2hpcC8uL3NjcmlwdC9zaGlwLmpzIiwid2VicGFjazovL3RoZS1iYXR0bGVzaGlwLy4vc2NyaXB0L3BsYWNlc2hpcHMuanMiLCJ3ZWJwYWNrOi8vdGhlLWJhdHRsZXNoaXAvLi9zY3JpcHQvZ2FtZWxvb3AuanMiLCJ3ZWJwYWNrOi8vdGhlLWJhdHRsZXNoaXAvLi9zY3JpcHQvaW5kZXguanMiXSwic291cmNlc0NvbnRlbnQiOlsiY29uc3QgZG9NID0gKCgpPT57XHJcbiAgICBmdW5jdGlvbiByZW5kZXJCb2FyZChib2FyZEVsZW1lbnQsIGhvbGRlcikge1xyXG4gICAgICAgIGJvYXJkRWxlbWVudC5pbm5lckhUTUwgPSAnJztcclxuICAgICAgICBmb3IgKGxldCBpID0gMDsgaSA8IDEwMDsgaSsrKSB7XHJcbiAgICAgICAgICAgIGNvbnN0IGNlbGwgPSBkb2N1bWVudC5jcmVhdGVFbGVtZW50KCdkaXYnKTtcclxuICAgICAgICAgICAgY2VsbC5kYXRhc2V0LmluZGV4ID0gaTtcclxuICAgICAgICAgICAgaWYoaG9sZGVyID09IFwicGxheWVyXCIpe1xyXG4gICAgICAgICAgICAgICAgY2VsbC5jbGFzc0xpc3QuYWRkKCdjZWxsJyk7XHJcbiAgICAgICAgICAgICAgICBjZWxsLmNsYXNzTGlzdC5hZGQoYGgke2l9YCk7XHJcbiAgICAgICAgICAgIH1cclxuICAgICAgICAgICAgZWxzZSBpZihob2xkZXIgPT0gXCJjb21wdXRlclwiKXtcclxuICAgICAgICAgICAgICAgIGNlbGwuY2xhc3NMaXN0LmFkZCgnZW5lbXljZWxsJyk7XHJcbiAgICAgICAgICAgICAgICBjZWxsLmNsYXNzTGlzdC5hZGQoYGUke2l9YCk7XHJcbiAgICAgICAgICAgIH1cclxuICAgICAgICAgICAgYm9hcmRFbGVtZW50LmFwcGVuZENoaWxkKGNlbGwpO1xyXG4gICAgICAgIH1cclxuICAgIH07XHJcblxyXG4gICAgcmV0dXJuIHtcclxuICAgICAgICByZW5kZXJCb2FyZFxyXG4gICAgfVxyXG59KSgpO1xyXG5cclxuXHJcbmV4cG9ydCBkZWZhdWx0IGRvTSIsImltcG9ydCBTaGlwIGZyb20gXCIuL3NoaXBcIjtcclxuZnVuY3Rpb24gR2FtZWJvYXJkKCkge1xyXG4gIGxldCBib2FyZCA9IEFycmF5KDEwMCkuZmlsbChudWxsKTtcclxuICBsZXQgc2hpcHMgPSBbXTtcclxuICBsZXQgbWlzc2VkQXR0YWNrcyA9IFtdO1xyXG5cclxuXHJcbiAgZnVuY3Rpb24gcGxhY2VTaGlwKHNoaXAsaW5kZXgpIHtcclxuICAgIGxldCBzaGlwbGVuZ3RoID0gc2hpcC5sZW5ndGg7XHJcbiAgICBsZXQgY29vcmRpbmF0ZXMgPSBbXTtcclxuICAgIGZvcihsZXQgaT0wO2k8c2hpcGxlbmd0aDtpKyspe1xyXG4gICAgICBjb29yZGluYXRlcy5wdXNoKGluZGV4K2kpO1xyXG4gICAgfVxyXG4gICAgY29vcmRpbmF0ZXMuZm9yRWFjaChjb29yZCA9PiB7XHJcbiAgICAgIGJvYXJkW2Nvb3JkXSA9IHNoaXA7XHJcbiAgICB9KTtcclxuICAgIHNoaXBzLnB1c2goc2hpcCk7XHJcblxyXG4gIH1cclxuICBcclxuICBmdW5jdGlvbiByZWNlaXZlQXR0YWNrKGNvb3JkaW5hdGVzKSB7XHJcbiAgICBpZiAoYm9hcmRbY29vcmRpbmF0ZXNdID09PSBudWxsKSB7XHJcbiAgICAgIG1pc3NlZEF0dGFja3MucHVzaChjb29yZGluYXRlcyk7XHJcbiAgICAgIHJldHVybiBmYWxzZTtcclxuICAgIH1cclxuICAgIGNvbnN0IGhpdFNoaXAgPSBib2FyZFtjb29yZGluYXRlc107XHJcbiAgICBoaXRTaGlwLmhpdCgpO1xyXG4gICAgcmV0dXJuIHRydWU7XHJcbiAgfVxyXG5cclxuICBmdW5jdGlvbiBhbGxTaGlwc1N1bmsoKSB7XHJcbiAgICByZXR1cm4gc2hpcHMuZXZlcnkoc2hpcCA9PiBzaGlwLmlzU3VuaygpKTtcclxuICB9XHJcbiAgZnVuY3Rpb24gZ2V0Qm9hcmQoKXtcclxuICAgIHJldHVybiBib2FyZDtcclxuICB9XHJcbiAgZnVuY3Rpb24gZ2V0U2hpcHMoKXtcclxuICAgIHJldHVybiBzaGlwcy5sZW5ndGg7XHJcbiAgfVxyXG4gIHJldHVybiB7XHJcbiAgICBnZXRTaGlwcyxcclxuICAgIGdldEJvYXJkLFxyXG4gICAgcGxhY2VTaGlwLFxyXG4gICAgcmVjZWl2ZUF0dGFjayxcclxuICAgIGFsbFNoaXBzU3VuayxcclxuICAgIG1pc3NlZEF0dGFja3MsXHJcbiAgfTtcclxufVxyXG5cclxuZXhwb3J0IGRlZmF1bHQgR2FtZWJvYXJkOyIsImZ1bmN0aW9uIFNoaXAobGVuZ3RoKSB7XHJcbiAgbGV0IGhpdHMgPSAwO1xyXG5cclxuICByZXR1cm4ge1xyXG4gICAgbGVuZ3RoOiBsZW5ndGgsXHJcbiAgICBoaXQoKSB7XHJcbiAgICAgIGhpdHMrK1xyXG4gICAgICByZXR1cm4gaGl0cztcclxuICAgIH0sXHJcbiAgICBpc1N1bmsoKSB7XHJcbiAgICAgIHJldHVybiBoaXRzID09PSBsZW5ndGg7XHJcbiAgICB9LFxyXG4gICAgZ2V0IGhpdHMoKXtcclxuICAgICAgcmV0dXJuIGhpdHM7XHJcbiAgICB9XHJcbiAgfTtcclxufVxyXG5leHBvcnQgZGVmYXVsdCBTaGlwOyIsImltcG9ydCBTaGlwIGZyb20gXCIuL3NoaXBcIjtcclxuaW1wb3J0IEdhbWVib2FyZCBmcm9tIFwiLi9nYW1lYm9hcmRcIjtcclxuXHJcbmZ1bmN0aW9uIHBsYWNlc2hpcHMoaG9sZGVyLCBwbGF5ZXJib2FyZCkge1xyXG4gIGlmIChob2xkZXIgPT09IFwicGxheWVyXCIpIHtcclxuICAgIGNvbnN0IHNoaXBzTGVuZ3RoID0gWzUsIDQsIDMsIDJdO1xyXG4gICAgbGV0IHNoaXBzbGVuID0gc2hpcHNMZW5ndGgubGVuZ3RoO1xyXG4gICAgY29uc3QgY2VsbHMgPSBkb2N1bWVudC5xdWVyeVNlbGVjdG9yQWxsKCcuY2VsbCcpO1xyXG4gICAgbGV0IGdhbWUgPSB0cnVlO1xyXG4gICAgbGV0IGkgPSAwO1xyXG4gICAgY29uc3QgdHVybiA9IGRvY3VtZW50LmdldEVsZW1lbnRCeUlkKCd0dXJuJyk7XHJcbiAgICBpZiAoZ2FtZSkge1xyXG4gICAgICBjZWxscy5mb3JFYWNoKGNlbGwgPT4ge1xyXG4gICAgICAgIGNlbGwuYWRkRXZlbnRMaXN0ZW5lcignY2xpY2snLCAoZXZlbnQpID0+IHtcclxuICAgICAgICAgIGNvbnN0IGNlbGwgPSBldmVudC50YXJnZXQ7XHJcbiAgICAgICAgICBjb25zdCBpbmRleCA9IHBhcnNlSW50KGNlbGwuZGF0YXNldC5pbmRleCk7XHJcbiAgICAgICAgICBjb25zdCBjYW5QbGFjZVNoaXAgPSBjaGVja1NoaXBQbGFjZW1lbnQocGxheWVyYm9hcmQsIGluZGV4LCBzaGlwc0xlbmd0aFtpXSk7XHJcbiAgICAgICAgICBjb25zdCBub092ZXJsYXAgPSBjaGVja092ZXJsYXAoaW5kZXgsIHNoaXBzTGVuZ3RoW2ldKTtcclxuICAgICAgICAgIGlmKGkgPT0wKXtcclxuICAgICAgICAgICAgdHVybi5pbm5lclRleHQgPSBcIlBsYWNlIHlvdXIgU3VibWFyaW5lXCI7XHJcbiAgICAgICAgICB9XHJcbiAgICAgICAgICBlbHNlIGlmKGk9PTEpe1xyXG4gICAgICAgICAgICB0dXJuLmlubmVyVGV4dCA9IFwiUGxhY2UgeW91ciBBdHRhY2tlcnJcIjtcclxuICAgICAgICAgIH1cclxuICAgICAgICAgIGVsc2UgaWYoaT09Mil7XHJcbiAgICAgICAgICAgIHR1cm4uaW5uZXJUZXh0ID0gXCJQbGFjZSB5b3VyIFNoaXBcIjtcclxuICAgICAgICAgIH1cclxuICAgICAgICAgIGVsc2V7XHJcbiAgICAgICAgICAgIHR1cm4uaW5uZXJUZXh0ID0gXCJQbGF5XCI7XHJcbiAgICAgICAgICB9XHJcbiAgICAgICAgICBpZiAoY2FuUGxhY2VTaGlwICYmIG5vT3ZlcmxhcCkge1xyXG4gICAgICAgICAgICBjb25zdCBzaGlwID0gU2hpcChzaGlwc0xlbmd0aFtpXSk7XHJcbiAgICAgICAgICAgIHBsYXllcmJvYXJkLnBsYWNlU2hpcChzaGlwLCBpbmRleCk7ICBcclxuICAgICAgICAgICAgZm9yIChsZXQgayA9IDA7IGsgPCBzaGlwc0xlbmd0aFtpXTsgaysrKSB7XHJcbiAgICAgICAgICAgICAgZG9jdW1lbnQucXVlcnlTZWxlY3RvcihgLmgke2luZGV4ICsga31gKS5zdHlsZS5iYWNrZ3JvdW5kQ29sb3IgPSBcIiMyOTI4MjhcIjtcclxuICAgICAgICAgICAgfVxyXG4gICAgICAgICAgICBpKys7XHJcbiAgICAgICAgICAgIGlmIChpID09PSBzaGlwc2xlbikge1xyXG4gICAgICAgICAgICAgIGdhbWUgPSBmYWxzZTtcclxuICAgICAgICAgICAgfVxyXG4gICAgICAgICAgfVxyXG4gICAgICAgIH0pO1xyXG4gICAgICB9KTtcclxuICAgIH1cclxuICAgIHJldHVybiB0cnVlO1xyXG4gIH0gZWxzZSBpZiAoaG9sZGVyID09PSBcImNvbXB1dGVyXCIpIHtcclxuICAgIGNvbnN0IHNoaXBzTGVuZ3RoID0gWzUsIDQsIDMsIDJdO1xyXG4gICAgbGV0IHNoaXBzbGVuID0gc2hpcHNMZW5ndGgubGVuZ3RoO1xyXG4gICAgbGV0IGkgPSAwO1xyXG4gICAgXHJcbiAgICB3aGlsZSAoaSA8IHNoaXBzbGVuKSB7XHJcbiAgICAgIGxldCBzaGlwID0gU2hpcChzaGlwc0xlbmd0aFtpXSk7XHJcbiAgICAgIGxldCBpbmRleCA9IE1hdGguZmxvb3IoTWF0aC5yYW5kb20oKSAqIDEwMCk7XHJcbiAgICAgIGNvbnN0IG5vT3ZlcmxhcCA9IGNoZWNrT3ZlcmxhcChpbmRleCwgc2hpcHNMZW5ndGhbaV0pO1xyXG5cclxuICAgICAgaWYgKCFub092ZXJsYXApIHsgLy8gQ2hlY2sgaWYgdGhlIHNoaXAgaXMgb3ZlcmxhcHBpbmdcclxuICAgICAgICBjb250aW51ZTtcclxuICAgICAgfSBcclxuICAgICAgcGxheWVyYm9hcmQucGxhY2VTaGlwKHNoaXAsIGluZGV4KTtcclxuICAgICAgaSsrOyBcclxuICAgIH1cclxuICAgIHJldHVybiB0cnVlOyAgICAgXHJcbiAgfVxyXG59XHJcblxyXG5mdW5jdGlvbiBjaGVja092ZXJsYXAoc3RhcnRJbmRleCwgbGVuZ3RoKSB7XHJcbiAgbGV0IGxhc3RDZWxsSW5kZXggPSBzdGFydEluZGV4ICsgbGVuZ3RoIC0gMTtcclxuICBsZXQgaW5kZXhyb3cgPSBNYXRoLmZsb29yKHN0YXJ0SW5kZXggLyAxMCk7XHJcbiAgbGV0IGxhc3Ryb3cgPSBNYXRoLmZsb29yKGxhc3RDZWxsSW5kZXggLyAxMCk7XHJcbiAgXHJcbiAgaWYgKGxhc3Ryb3cgPiBpbmRleHJvdykge1xyXG4gICAgcmV0dXJuIGZhbHNlO1xyXG4gIH1cclxuICBcclxuICByZXR1cm4gdHJ1ZTtcclxufVxyXG5cclxuZnVuY3Rpb24gY2hlY2tTaGlwUGxhY2VtZW50KHBsYXllcmJvYXJkLCBzdGFydEluZGV4LCBsZW5ndGgpIHtcclxuICBjb25zdCBib2FyZCA9IHBsYXllcmJvYXJkLmdldEJvYXJkKCk7XHJcbiAgZm9yIChsZXQgaSA9IDA7IGkgPCBsZW5ndGg7IGkrKykge1xyXG4gICAgY29uc3QgaW5kaWNlcyA9IHN0YXJ0SW5kZXggKyBpO1xyXG5cclxuICAgIGlmIChib2FyZFtpbmRpY2VzXSAhPT0gbnVsbCkge1xyXG4gICAgICByZXR1cm4gZmFsc2U7XHJcbiAgICB9XHJcbiAgfVxyXG4gIFxyXG4gIHJldHVybiB0cnVlO1xyXG59XHJcblxyXG5leHBvcnQgeyBwbGFjZXNoaXBzIH07XHJcbiIsImltcG9ydCBHYW1lYm9hcmQgZnJvbSBcIi4vZ2FtZWJvYXJkXCI7XHJcbmltcG9ydCBkb00gZnJvbSBcIi4vRE9NXCI7XHJcbmltcG9ydCB7IHBsYWNlc2hpcHMgfSBmcm9tIFwiLi9wbGFjZXNoaXBzXCI7XHJcblxyXG5mdW5jdGlvbiBnYW1lTG9vcChwbGF5ZXIxLCBwbGF5ZXIyKSB7XHJcbiAgbGV0IGNvbXBib2FyZCwgcGxheWVyYm9hcmQ7XHJcbiAgcGxheWVyYm9hcmQgPSBHYW1lYm9hcmQoKTtcclxuICBjb21wYm9hcmQgPSBHYW1lYm9hcmQoKTtcclxuICBjb25zdCBjbGlja2VkQ2VsbHMgPSBbXTtcclxuICBjb25zdCBwbGF5ZXIxYm9hcmQgPSBkb2N1bWVudC5nZXRFbGVtZW50QnlJZChcInBsYXllcmJvYXJkXCIpO1xyXG4gIGNvbnN0IHBsYXllcjJib2FyZCA9IGRvY3VtZW50LmdldEVsZW1lbnRCeUlkKFwiY29tcGJvYXJkXCIpO1xyXG4gIGRvTS5yZW5kZXJCb2FyZChwbGF5ZXIxYm9hcmQsIFwicGxheWVyXCIpO1xyXG4gIGRvTS5yZW5kZXJCb2FyZChwbGF5ZXIyYm9hcmQsIFwiY29tcHV0ZXJcIik7XHJcblxyXG5cclxuICBcclxuXHJcbiAgbGV0IHNoaXBQbGFjZWQgPSBmYWxzZTtcclxuICBzaGlwUGxhY2VkID0gcGxhY2VzaGlwcyhcInBsYXllclwiLCBwbGF5ZXJib2FyZClcclxuICBsZXQgY29tcFNoaXBzID0gZmFsc2U7XHJcbiAgY29tcFNoaXBzID0gcGxhY2VzaGlwcyhcImNvbXB1dGVyXCIsIGNvbXBib2FyZCk7XHJcblxyXG4gIGNvbnNvbGUubG9nKGNvbXBib2FyZC5nZXRTaGlwcygpKTtcclxuICBsZXQgcHJldmlvdXNBdHRhY2sgPSBuZXcgU2V0KCk7IC8vdG8gcHJldmVudCB0aGUgY29tcCBmcm9tIGF0dGFja2luZyB0aGUgc2FtZSBpbmRleCB0d2ljZVxyXG4gIGxldCBjdXJyZW50UGxheWVyID0gcGxheWVyMTtcclxuICBsZXQgZ2FtZU92ZXIgPSBmYWxzZTtcclxuXHJcbiAgXHJcbiAgcGxheWVyMmJvYXJkLmFkZEV2ZW50TGlzdGVuZXIoXCJjbGlja1wiLCAoZSkgPT4ge1xyXG4gICAgICBpZihzaGlwUGxhY2VkICYmIGNvbXBTaGlwcyl7XHJcbiAgICAgICAgY29uc3QgaXN2YWxpZGNsaWNrID0gY2hlY2tEb3VibGUoZSk7XHJcbiAgICAgICAgaWYgKGlzdmFsaWRjbGljaykge1xyXG4gICAgICAgICAgaWYgKGN1cnJlbnRQbGF5ZXIgIT09IHBsYXllcjEgfHwgZ2FtZU92ZXIpIHtcclxuICAgICAgICAgICAgcmV0dXJuO1xyXG4gICAgICAgICAgfVxyXG4gICAgICAgICAgaGFuZGxlQ2xpY2soZSk7XHJcbiAgICAgICAgICBjaGVja2dhbWVPdmVyKCk7XHJcbiAgICAgICAgICBjdXJyZW50UGxheWVyID0gc3dpdGNoUGxheWVyKCk7XHJcbiAgICAgICAgICBzZXRUaW1lb3V0KGNvbXB1dGVyVHVybiwgMTAwKTtcclxuICAgICAgICB9XHJcbiAgICAgIH1cclxuXHJcbiAgICB9KTtcclxuXHJcblxyXG4gIGZ1bmN0aW9uIGNoZWNrRG91YmxlKGUpIHtcclxuICAgIGNvbnN0IGNlbGxpbmRleCA9IGUudGFyZ2V0LmRhdGFzZXQuaW5kZXg7XHJcbiAgICBpZiAoY2xpY2tlZENlbGxzLmluY2x1ZGVzKGNlbGxpbmRleCkpIHtcclxuICAgICAgcmV0dXJuIGZhbHNlO1xyXG4gICAgfVxyXG4gICAgY2xpY2tlZENlbGxzLnB1c2goY2VsbGluZGV4KTtcclxuICAgIHJldHVybiB0cnVlO1xyXG4gIH1cclxuXHJcbiAgZnVuY3Rpb24gaGFuZGxlQ2xpY2soZXZlbnQpIHtcclxuICAgIGlmIChnYW1lT3Zlcikge1xyXG4gICAgICByZXR1cm47XHJcbiAgICB9XHJcbiAgICBjb25zdCBjZWxsaW5kZXggPSBldmVudC50YXJnZXQuZGF0YXNldC5pbmRleDtcclxuICAgIGNvbnN0IHJlc3VsdCA9IGNvbXBib2FyZC5yZWNlaXZlQXR0YWNrKGNlbGxpbmRleCk7XHJcbiAgICBpZiAocmVzdWx0ID09PSB0cnVlKSB7XHJcbiAgICAgIGV2ZW50LnRhcmdldC5zdHlsZS5iYWNrZ3JvdW5kQ29sb3IgPSBcIiNmNzAyMDJcIjtcclxuICAgIH0gZWxzZSB7XHJcbiAgICAgIGV2ZW50LnRhcmdldC5zdHlsZS5iYWNrZ3JvdW5kQ29sb3IgPSBcIiMwMmQ5MWJcIjtcclxuICAgIH1cclxuICB9XHJcblxyXG4gIGxldCBhdHRhY2tJbmRleDtcclxuICBsZXQgbGVmdCxyaWdodCA9IG51bGxcclxuICBmdW5jdGlvbiBjb21wdXRlclR1cm4oKSB7XHJcbiAgICBpZihsZWZ0IT0gbnVsbCB8fCByaWdodCE9bnVsbCl7XHJcbiAgICAgIGlmKGxlZnQhPW51bGwpe1xyXG4gICAgICAgIGF0dGFja0luZGV4ID0gbGVmdDtcclxuICAgICAgICBsZWZ0ID0gbGVmdCAtMTtcclxuICAgICAgfVxyXG4gICAgICAgZWxzZSBpZihyaWdodCE9IG51bGwpe1xyXG4gICAgICAgIGF0dGFja0luZGV4ID0gcmlnaHQ7XHJcbiAgICAgICAgcmlnaHQgPSByaWdodCArIDE7XHJcbiAgICAgIH1cclxuICAgIH0gZWxzZXtcclxuICAgICAgYXR0YWNrSW5kZXggPSByYW5kb21BdHRhY2soKTtcclxuICAgIH1cclxuXHJcbiAgICBjb21wdXRlckFJKGF0dGFja0luZGV4KTtcclxuICB9XHJcblxyXG4gIGZ1bmN0aW9uIHJhbmRvbUF0dGFjaygpIHtcclxuICAgIGxldCB4ID0gTWF0aC5mbG9vcihNYXRoLnJhbmRvbSgpICogMTAwKTtcclxuICAgIHdoaWxlIChwcmV2aW91c0F0dGFjay5oYXMoeCkpIHtcclxuICAgICAgeCA9IE1hdGguZmxvb3IoTWF0aC5yYW5kb20oKSAqIDEwMCk7XHJcbiAgICB9XHJcbiAgICByZXR1cm4geDtcclxuICB9XHJcblxyXG4gIGZ1bmN0aW9uIGNvbXB1dGVyQUkoaSkge1xyXG4gICAgaWYgKGdhbWVPdmVyKSB7XHJcbiAgICAgIHJldHVybjtcclxuICAgIH1cclxuICAgIGNvbnN0IGNvbXBoaXQgPSBwbGF5ZXJib2FyZC5yZWNlaXZlQXR0YWNrKGkpO1xyXG4gICAgY29uc3QgY2VsbCA9IHBsYXllcjFib2FyZC5xdWVyeVNlbGVjdG9yKGBbZGF0YS1pbmRleD0nJHtpfSddYCk7XHJcbiAgICBpZiAoY29tcGhpdCA9PT0gdHJ1ZSkge1xyXG4gICAgICBjZWxsLnN0eWxlLmJhY2tncm91bmRDb2xvciA9IFwiI2Y3MDIwMlwiO1xyXG4gICAgICBpZihsZWZ0ID09IG51bGwpe1xyXG4gICAgICAgIGxlZnQgPSBpIC0gMTtcclxuICAgICAgfVxyXG4gICAgICBpZihwcmV2aW91c0F0dGFjay5oYXMobGVmdCkpe1xyXG4gICAgICAgIGxlZnQgPSBudWxsO1xyXG4gICAgICB9XHJcbiAgICAgIGlmKHJpZ2h0ID09IG51bGwpe1xyXG4gICAgICAgIHJpZ2h0ID0gaSArIDE7XHJcbiAgICAgIH1cclxuICAgICAgaWYocHJldmlvdXNBdHRhY2suaGFzKHJpZ2h0KSl7XHJcbiAgICAgICAgcmlnaHQgPSBudWxsO1xyXG4gICAgICB9XHJcbiAgICB9IGVsc2Uge1xyXG4gICAgICBjZWxsLnN0eWxlLmJhY2tncm91bmRDb2xvciA9IFwiIzAyZDkxYlwiO1xyXG4gICAgICBpZihsZWZ0ICE9IG51bGwpe1xyXG4gICAgICAgIGxlZnQgPSBudWxsXHJcbiAgICAgIH1cclxuICAgICAgZWxzZXtcclxuICAgICAgICByaWdodCA9IG51bGw7XHJcbiAgICAgIH1cclxuICAgIH1cclxuICAgIHByZXZpb3VzQXR0YWNrLmFkZChpKTtcclxuICAgIGNoZWNrZ2FtZU92ZXIoKTtcclxuICAgIGN1cnJlbnRQbGF5ZXIgPSBzd2l0Y2hQbGF5ZXIoKTtcclxuICB9XHJcblxyXG4gIGZ1bmN0aW9uIHN3aXRjaFBsYXllcigpIHtcclxuICAgIHJldHVybiAoY3VycmVudFBsYXllciA9IGN1cnJlbnRQbGF5ZXIgPT09IHBsYXllcjEgPyBwbGF5ZXIyIDogcGxheWVyMSk7XHJcbiAgfVxyXG5cclxuICBmdW5jdGlvbiBjaGVja2dhbWVPdmVyKCkge1xyXG4gICAgaWYgKHBsYXllcmJvYXJkLmFsbFNoaXBzU3VuaygpKSB7XHJcbiAgICAgIGdhbWVPdmVyID0gdHJ1ZTtcclxuICAgICAgZG9jdW1lbnQuZ2V0RWxlbWVudEJ5SWQoJ3dpbm5lcicpLmlubmVyVGV4dCA9IFwiQ29tcHV0ZXIgV2luIVwiO1xyXG4gICAgICBwbGF5ZXIyYm9hcmQucmVtb3ZlRXZlbnRMaXN0ZW5lcihcImNsaWNrXCIsIGhhbmRsZUNsaWNrKTtcclxuICAgICAgcmV0dXJuO1xyXG4gICAgfVxyXG4gICAgaWYgKGNvbXBib2FyZC5hbGxTaGlwc1N1bmsoKSkge1xyXG4gICAgICBnYW1lT3ZlciA9IHRydWU7XHJcbiAgICAgIGRvY3VtZW50LmdldEVsZW1lbnRCeUlkKCd3aW5uZXInKS5pbm5lclRleHQgPSBcIllvdSBXaW4hXCI7XHJcbiAgICAgIHJldHVybjtcclxuICAgIH1cclxuICB9XHJcbn1cclxuXHJcbmV4cG9ydCBkZWZhdWx0IGdhbWVMb29wO1xyXG4iLCJpbXBvcnQgZG9NIGZyb20gXCIuL0RPTVwiO1xyXG5pbXBvcnQgUGxheWVyIGZyb20gXCIuL3BsYXllclwiO1xyXG5pbXBvcnQgR2FtZWJvYXJkIGZyb20gXCIuL2dhbWVib2FyZFwiO1xyXG5pbXBvcnQgU2hpcCBmcm9tIFwiLi9zaGlwXCI7XHJcbmltcG9ydCBnYW1lTG9vcCBmcm9tIFwiLi9nYW1lbG9vcFwiO1xyXG5cclxuXHJcbmdhbWVMb29wKHtuYW1lOiBcIlBsYXllclwifSwge25hbWU6IFwiQ29tcHV0ZXJcIn0pO1xyXG4iXSwibmFtZXMiOlsiYm9hcmRFbGVtZW50IiwiaG9sZGVyIiwiaW5uZXJIVE1MIiwiaSIsImNlbGwiLCJkb2N1bWVudCIsImNyZWF0ZUVsZW1lbnQiLCJkYXRhc2V0IiwiaW5kZXgiLCJjbGFzc0xpc3QiLCJhZGQiLCJhcHBlbmRDaGlsZCIsImJvYXJkIiwiQXJyYXkiLCJmaWxsIiwic2hpcHMiLCJtaXNzZWRBdHRhY2tzIiwiZ2V0U2hpcHMiLCJsZW5ndGgiLCJnZXRCb2FyZCIsInBsYWNlU2hpcCIsInNoaXAiLCJzaGlwbGVuZ3RoIiwiY29vcmRpbmF0ZXMiLCJwdXNoIiwiZm9yRWFjaCIsImNvb3JkIiwicmVjZWl2ZUF0dGFjayIsImhpdCIsImFsbFNoaXBzU3VuayIsImV2ZXJ5IiwiaXNTdW5rIiwiaGl0cyIsInBsYWNlc2hpcHMiLCJwbGF5ZXJib2FyZCIsInNoaXBzTGVuZ3RoIiwic2hpcHNsZW4iLCJjZWxscyIsInF1ZXJ5U2VsZWN0b3JBbGwiLCJnYW1lIiwidHVybiIsImdldEVsZW1lbnRCeUlkIiwiYWRkRXZlbnRMaXN0ZW5lciIsImV2ZW50IiwidGFyZ2V0IiwicGFyc2VJbnQiLCJjYW5QbGFjZVNoaXAiLCJzdGFydEluZGV4IiwiY2hlY2tTaGlwUGxhY2VtZW50Iiwibm9PdmVybGFwIiwiY2hlY2tPdmVybGFwIiwiaW5uZXJUZXh0IiwiayIsInF1ZXJ5U2VsZWN0b3IiLCJzdHlsZSIsImJhY2tncm91bmRDb2xvciIsIk1hdGgiLCJmbG9vciIsInJhbmRvbSIsImxhc3RDZWxsSW5kZXgiLCJpbmRleHJvdyIsInBsYXllcjEiLCJwbGF5ZXIyIiwiY29tcGJvYXJkIiwiY2xpY2tlZENlbGxzIiwicGxheWVyMWJvYXJkIiwicGxheWVyMmJvYXJkIiwic2hpcFBsYWNlZCIsImNvbXBTaGlwcyIsImNvbnNvbGUiLCJsb2ciLCJhdHRhY2tJbmRleCIsInByZXZpb3VzQXR0YWNrIiwiU2V0IiwiY3VycmVudFBsYXllciIsImdhbWVPdmVyIiwiaGFuZGxlQ2xpY2siLCJjZWxsaW5kZXgiLCJyZXN1bHQiLCJlIiwiaXN2YWxpZGNsaWNrIiwiaW5jbHVkZXMiLCJjaGVja0RvdWJsZSIsImNoZWNrZ2FtZU92ZXIiLCJzd2l0Y2hQbGF5ZXIiLCJzZXRUaW1lb3V0IiwiY29tcHV0ZXJUdXJuIiwibGVmdCIsInJpZ2h0IiwieCIsImhhcyIsInJhbmRvbUF0dGFjayIsImNvbXBoaXQiLCJjb21wdXRlckFJIiwicmVtb3ZlRXZlbnRMaXN0ZW5lciIsIm5hbWUiXSwic291cmNlUm9vdCI6IiJ9