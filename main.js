(()=>{"use strict";const e=function(e,t){e.innerHTML="";for(let n=0;n<100;n++){const r=document.createElement("div");r.dataset.index=n,"player"==t?(r.classList.add("cell"),r.classList.add(`h${n}`)):"computer"==t&&(r.classList.add("enemycell"),r.classList.add(`e${n}`)),e.appendChild(r)}},t=function(){let e=Array(100).fill(null),t=[],n=[];return{getShips:function(){return t.length},getBoard:function(){return e},placeShip:function(n,r){let o=n.length,l=[];for(let e=0;e<o;e++)l.push(r+e);l.forEach((t=>{e[t]=n})),t.push(n)},receiveAttack:function(t){return null===e[t]?(n.push(t),!1):(e[t].hit(),!0)},allShipsSunk:function(){return t.every((e=>e.isSunk()))},missedAttacks:n}},n=function(e){let t=0;return{length:e,hit:()=>(t++,t),isSunk:()=>t===e,get hits(){return t}}};function r(e,t){if("player"===e){const e=[5,4,3,2];let r=e.length;const l=document.querySelectorAll(".cell");let c=!0,u=0;const i=document.getElementById("turn");c&&l.forEach((l=>{l.addEventListener("click",(l=>{const a=l.target,s=parseInt(a.dataset.index),d=function(e,t,n){const r=e.getBoard();for(let e=0;e<n;e++)if(null!==r[t+e])return!1;return!0}(t,s,e[u]),f=o(s,e[u]);if(i.innerText=0==u?"Place your Submarine":1==u?"Place your Attackerr":2==u?"Place your Ship":"Play",d&&f){const o=n(e[u]);t.placeShip(o,s);for(let t=0;t<e[u];t++)document.querySelector(`.h${s+t}`).style.backgroundColor="#292828";u++,u===r&&(c=!1)}}))}))}else if("computer"===e){const e=[5,4,3,2];let r=e.length,l=0;for(;l<r;){let r=n(e[l]),c=Math.floor(100*Math.random());o(c,e[l])&&(t.placeShip(r,c),l++)}}}function o(e,t){let n=e+t-1,r=Math.floor(e/10);return!(Math.floor(n/10)>r)}!function(n,o){let l,c;c=t(),l=t();const u=[],i=document.getElementById("playerboard"),a=document.getElementById("compboard");e(i,"player"),e(a,"computer"),r("player",c),r("computer",l),console.log(l.getShips());let s,d=new Set,f=n,h=!1,p=[];function m(e){if(h)return;const t=e.target.dataset.index,n=l.receiveAttack(t);e.target.style.backgroundColor=!0===n?"#f70202":"#02d91b"}function g(){if(p.length>0){const e=function(e){const t=[],n=e%10;return n>0&&t.push(e-1),n<9&&t.push(e+1),t}(p[p.length-1]);console.log(e);for(const t of e)if(!d.has(t)){s=t;break}p.pop()}else s=function(){let e=Math.floor(100*Math.random());for(;d.has(e);)e=Math.floor(100*Math.random());return e}();!function(e){if(h)return;const t=c.receiveAttack(e),n=i.querySelector(`[data-index='${e}']`);!0===t?(n.style.backgroundColor="#f70202",p.push(e),console.log(p)):n.style.backgroundColor="#02d91b",d.add(e),S(),f=y()}(s)}function y(){return f=f===n?o:n}function S(){return c.allShipsSunk()?(h=!0,document.getElementById("winner").innerText="Computer Win!",void a.removeEventListener("click",m)):l.allShipsSunk()?(h=!0,void(document.getElementById("winner").innerText="You Win!")):void 0}a.addEventListener("click",(e=>{const t=function(e){const t=e.target.dataset.index;return!u.includes(t)&&(u.push(t),!0)}(e);if(t){if(f!==n||h)return;m(e),S(),f=y(),setTimeout(g,100)}}))}({name:"Player"},{name:"Computer"})})();
//# sourceMappingURL=data:application/json;charset=utf-8;base64,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QixRQUFTaEIsSUFHeENaLEVBQVVsQyxnQkFDWjRDLEdBQVcsT0FDWHBFLFNBQVNvQyxlQUFlLFVBQVVVLFVBQVksa0JBRmhELENBS0YsQ0FoSEFlLEVBQWF4QixpQkFBaUIsU0FBVWtELElBQ3RDLE1BQU1DLEVBYVIsU0FBcUJELEdBQ25CLE1BQU1oQixFQUFZZ0IsRUFBRWhELE9BQU9yQyxRQUFRQyxNQUNuQyxPQUFHd0QsRUFBYThCLFNBQVNsQixLQUd6QlosRUFBYXhDLEtBQUtvRCxJQUNYLEVBQ1QsQ0FwQnVCbUIsQ0FBWUgsR0FDakMsR0FBR0MsRUFBYSxDQUNkLEdBQUlyQixJQUFrQlgsR0FBV1ksRUFDL0IsT0FFRkUsRUFBWWlCLEdBQ1pKLElBQ0FoQixFQUFnQmlCLElBQ2hCTyxXQUFXbEIsRUFBYyxJQUMzQixJQXVHSixDQ3JJQSxDQUFTLENBQUNtQixLQUFNLFVBQVcsQ0FBQ0EsS0FBTSxZIiwic291cmNlcyI6WyJ3ZWJwYWNrOi8vdGhlLWJhdHRsZXNoaXAvLi9zY3JpcHQvRE9NLmpzIiwid2VicGFjazovL3RoZS1iYXR0bGVzaGlwLy4vc2NyaXB0L2dhbWVib2FyZC5qcyIsIndlYnBhY2s6Ly90aGUtYmF0dGxlc2hpcC8uL3NjcmlwdC9zaGlwLmpzIiwid2VicGFjazovL3RoZS1iYXR0bGVzaGlwLy4vc2NyaXB0L3BsYWNlc2hpcHMuanMiLCJ3ZWJwYWNrOi8vdGhlLWJhdHRsZXNoaXAvLi9zY3JpcHQvZ2FtZWxvb3AuanMiLCJ3ZWJwYWNrOi8vdGhlLWJhdHRsZXNoaXAvLi9zY3JpcHQvaW5kZXguanMiXSwic291cmNlc0NvbnRlbnQiOlsiY29uc3QgZG9NID0gKCgpPT57XHJcbiAgICBmdW5jdGlvbiByZW5kZXJCb2FyZChib2FyZEVsZW1lbnQsIGhvbGRlcikge1xyXG4gICAgICAgIGJvYXJkRWxlbWVudC5pbm5lckhUTUwgPSAnJztcclxuICAgICAgICBmb3IgKGxldCBpID0gMDsgaSA8IDEwMDsgaSsrKSB7XHJcbiAgICAgICAgICAgIGNvbnN0IGNlbGwgPSBkb2N1bWVudC5jcmVhdGVFbGVtZW50KCdkaXYnKTtcclxuICAgICAgICAgICAgY2VsbC5kYXRhc2V0LmluZGV4ID0gaTtcclxuICAgICAgICAgICAgaWYoaG9sZGVyID09IFwicGxheWVyXCIpe1xyXG4gICAgICAgICAgICAgICAgY2VsbC5jbGFzc0xpc3QuYWRkKCdjZWxsJyk7XHJcbiAgICAgICAgICAgICAgICBjZWxsLmNsYXNzTGlzdC5hZGQoYGgke2l9YCk7XHJcbiAgICAgICAgICAgIH1cclxuICAgICAgICAgICAgZWxzZSBpZihob2xkZXIgPT0gXCJjb21wdXRlclwiKXtcclxuICAgICAgICAgICAgICAgIGNlbGwuY2xhc3NMaXN0LmFkZCgnZW5lbXljZWxsJyk7XHJcbiAgICAgICAgICAgICAgICBjZWxsLmNsYXNzTGlzdC5hZGQoYGUke2l9YCk7XHJcbiAgICAgICAgICAgIH1cclxuICAgICAgICAgICAgYm9hcmRFbGVtZW50LmFwcGVuZENoaWxkKGNlbGwpO1xyXG4gICAgICAgIH1cclxuICAgIH07XHJcblxyXG4gICAgcmV0dXJuIHtcclxuICAgICAgICByZW5kZXJCb2FyZFxyXG4gICAgfVxyXG59KSgpO1xyXG5cclxuXHJcbmV4cG9ydCBkZWZhdWx0IGRvTSIsImltcG9ydCBTaGlwIGZyb20gXCIuL3NoaXBcIjtcclxuZnVuY3Rpb24gR2FtZWJvYXJkKCkge1xyXG4gIGxldCBib2FyZCA9IEFycmF5KDEwMCkuZmlsbChudWxsKTtcclxuICBsZXQgc2hpcHMgPSBbXTtcclxuICBsZXQgbWlzc2VkQXR0YWNrcyA9IFtdO1xyXG5cclxuXHJcbiAgZnVuY3Rpb24gcGxhY2VTaGlwKHNoaXAsaW5kZXgpIHtcclxuICAgIGxldCBzaGlwbGVuZ3RoID0gc2hpcC5sZW5ndGg7XHJcbiAgICBsZXQgY29vcmRpbmF0ZXMgPSBbXTtcclxuICAgIGZvcihsZXQgaT0wO2k8c2hpcGxlbmd0aDtpKyspe1xyXG4gICAgICBjb29yZGluYXRlcy5wdXNoKGluZGV4K2kpO1xyXG4gICAgfVxyXG4gICAgY29vcmRpbmF0ZXMuZm9yRWFjaChjb29yZCA9PiB7XHJcbiAgICAgIGJvYXJkW2Nvb3JkXSA9IHNoaXA7XHJcbiAgICB9KTtcclxuICAgIHNoaXBzLnB1c2goc2hpcCk7XHJcblxyXG4gIH1cclxuICBcclxuICBmdW5jdGlvbiByZWNlaXZlQXR0YWNrKGNvb3JkaW5hdGVzKSB7XHJcbiAgICBpZiAoYm9hcmRbY29vcmRpbmF0ZXNdID09PSBudWxsKSB7XHJcbiAgICAgIG1pc3NlZEF0dGFja3MucHVzaChjb29yZGluYXRlcyk7XHJcbiAgICAgIHJldHVybiBmYWxzZTtcclxuICAgIH1cclxuICAgIGNvbnN0IGhpdFNoaXAgPSBib2FyZFtjb29yZGluYXRlc107XHJcbiAgICBoaXRTaGlwLmhpdCgpO1xyXG4gICAgcmV0dXJuIHRydWU7XHJcbiAgfVxyXG5cclxuICBmdW5jdGlvbiBhbGxTaGlwc1N1bmsoKSB7XHJcbiAgICByZXR1cm4gc2hpcHMuZXZlcnkoc2hpcCA9PiBzaGlwLmlzU3VuaygpKTtcclxuICB9XHJcbiAgZnVuY3Rpb24gZ2V0Qm9hcmQoKXtcclxuICAgIHJldHVybiBib2FyZDtcclxuICB9XHJcbiAgZnVuY3Rpb24gZ2V0U2hpcHMoKXtcclxuICAgIHJldHVybiBzaGlwcy5sZW5ndGg7XHJcbiAgfVxyXG4gIHJldHVybiB7XHJcbiAgICBnZXRTaGlwcyxcclxuICAgIGdldEJvYXJkLFxyXG4gICAgcGxhY2VTaGlwLFxyXG4gICAgcmVjZWl2ZUF0dGFjayxcclxuICAgIGFsbFNoaXBzU3VuayxcclxuICAgIG1pc3NlZEF0dGFja3MsXHJcbiAgfTtcclxufVxyXG5cclxuZXhwb3J0IGRlZmF1bHQgR2FtZWJvYXJkOyIsImZ1bmN0aW9uIFNoaXAobGVuZ3RoKSB7XHJcbiAgbGV0IGhpdHMgPSAwO1xyXG5cclxuICByZXR1cm4ge1xyXG4gICAgbGVuZ3RoOiBsZW5ndGgsXHJcbiAgICBoaXQoKSB7XHJcbiAgICAgIGhpdHMrK1xyXG4gICAgICByZXR1cm4gaGl0cztcclxuICAgIH0sXHJcbiAgICBpc1N1bmsoKSB7XHJcbiAgICAgIHJldHVybiBoaXRzID09PSBsZW5ndGg7XHJcbiAgICB9LFxyXG4gICAgZ2V0IGhpdHMoKXtcclxuICAgICAgcmV0dXJuIGhpdHM7XHJcbiAgICB9XHJcbiAgfTtcclxufVxyXG5leHBvcnQgZGVmYXVsdCBTaGlwOyIsImltcG9ydCBTaGlwIGZyb20gXCIuL3NoaXBcIjtcclxuaW1wb3J0IEdhbWVib2FyZCBmcm9tIFwiLi9nYW1lYm9hcmRcIjtcclxuXHJcbmZ1bmN0aW9uIHBsYWNlc2hpcHMoaG9sZGVyLCBwbGF5ZXJib2FyZCkge1xyXG4gIGlmIChob2xkZXIgPT09IFwicGxheWVyXCIpIHtcclxuICAgIGNvbnN0IHNoaXBzTGVuZ3RoID0gWzUsIDQsIDMsIDJdO1xyXG4gICAgbGV0IHNoaXBzbGVuID0gc2hpcHNMZW5ndGgubGVuZ3RoO1xyXG4gICAgY29uc3QgY2VsbHMgPSBkb2N1bWVudC5xdWVyeVNlbGVjdG9yQWxsKCcuY2VsbCcpO1xyXG4gICAgbGV0IGdhbWUgPSB0cnVlO1xyXG4gICAgbGV0IGkgPSAwO1xyXG4gICAgY29uc3QgdHVybiA9IGRvY3VtZW50LmdldEVsZW1lbnRCeUlkKCd0dXJuJyk7XHJcbiAgICBpZiAoZ2FtZSkge1xyXG4gICAgICBjZWxscy5mb3JFYWNoKGNlbGwgPT4ge1xyXG4gICAgICAgIGNlbGwuYWRkRXZlbnRMaXN0ZW5lcignY2xpY2snLCAoZXZlbnQpID0+IHtcclxuICAgICAgICAgIGNvbnN0IGNlbGwgPSBldmVudC50YXJnZXQ7XHJcbiAgICAgICAgICBjb25zdCBpbmRleCA9IHBhcnNlSW50KGNlbGwuZGF0YXNldC5pbmRleCk7XHJcbiAgICAgICAgICBjb25zdCBjYW5QbGFjZVNoaXAgPSBjaGVja1NoaXBQbGFjZW1lbnQocGxheWVyYm9hcmQsIGluZGV4LCBzaGlwc0xlbmd0aFtpXSk7XHJcbiAgICAgICAgICBjb25zdCBub092ZXJsYXAgPSBjaGVja092ZXJsYXAoaW5kZXgsIHNoaXBzTGVuZ3RoW2ldKTtcclxuICAgICAgICAgIGlmKGkgPT0wKXtcclxuICAgICAgICAgICAgdHVybi5pbm5lclRleHQgPSBcIlBsYWNlIHlvdXIgU3VibWFyaW5lXCI7XHJcbiAgICAgICAgICB9XHJcbiAgICAgICAgICBlbHNlIGlmKGk9PTEpe1xyXG4gICAgICAgICAgICB0dXJuLmlubmVyVGV4dCA9IFwiUGxhY2UgeW91ciBBdHRhY2tlcnJcIjtcclxuICAgICAgICAgIH1cclxuICAgICAgICAgIGVsc2UgaWYoaT09Mil7XHJcbiAgICAgICAgICAgIHR1cm4uaW5uZXJUZXh0ID0gXCJQbGFjZSB5b3VyIFNoaXBcIjtcclxuICAgICAgICAgIH1cclxuICAgICAgICAgIGVsc2V7XHJcbiAgICAgICAgICAgIHR1cm4uaW5uZXJUZXh0ID0gXCJQbGF5XCI7XHJcbiAgICAgICAgICB9XHJcbiAgICAgICAgICBpZiAoY2FuUGxhY2VTaGlwICYmIG5vT3ZlcmxhcCkge1xyXG4gICAgICAgICAgICBjb25zdCBzaGlwID0gU2hpcChzaGlwc0xlbmd0aFtpXSk7XHJcbiAgICAgICAgICAgIHBsYXllcmJvYXJkLnBsYWNlU2hpcChzaGlwLCBpbmRleCk7ICBcclxuICAgICAgICAgICAgZm9yIChsZXQgayA9IDA7IGsgPCBzaGlwc0xlbmd0aFtpXTsgaysrKSB7XHJcbiAgICAgICAgICAgICAgZG9jdW1lbnQucXVlcnlTZWxlY3RvcihgLmgke2luZGV4ICsga31gKS5zdHlsZS5iYWNrZ3JvdW5kQ29sb3IgPSBcIiMyOTI4MjhcIjtcclxuICAgICAgICAgICAgfVxyXG4gICAgICAgICAgICBpKys7XHJcbiAgICAgICAgICAgIGlmIChpID09PSBzaGlwc2xlbikge1xyXG4gICAgICAgICAgICAgIGdhbWUgPSBmYWxzZTtcclxuICAgICAgICAgICAgfVxyXG4gICAgICAgICAgfVxyXG4gICAgICAgIH0pO1xyXG4gICAgICB9KTtcclxuICAgIH1cclxuICB9IGVsc2UgaWYgKGhvbGRlciA9PT0gXCJjb21wdXRlclwiKSB7XHJcbiAgICBjb25zdCBzaGlwc0xlbmd0aCA9IFs1LCA0LCAzLCAyXTtcclxuICAgIGxldCBzaGlwc2xlbiA9IHNoaXBzTGVuZ3RoLmxlbmd0aDtcclxuICAgIGxldCBpID0gMDtcclxuICAgIFxyXG4gICAgd2hpbGUgKGkgPCBzaGlwc2xlbikge1xyXG4gICAgICBsZXQgc2hpcCA9IFNoaXAoc2hpcHNMZW5ndGhbaV0pO1xyXG4gICAgICBsZXQgaW5kZXggPSBNYXRoLmZsb29yKE1hdGgucmFuZG9tKCkgKiAxMDApO1xyXG4gICAgICBjb25zdCBub092ZXJsYXAgPSBjaGVja092ZXJsYXAoaW5kZXgsIHNoaXBzTGVuZ3RoW2ldKTtcclxuXHJcbiAgICAgIGlmICghbm9PdmVybGFwKSB7IC8vIENoZWNrIGlmIHRoZSBzaGlwIGlzIG92ZXJsYXBwaW5nXHJcbiAgICAgICAgY29udGludWU7XHJcbiAgICAgIH0gXHJcbiAgICAgIHBsYXllcmJvYXJkLnBsYWNlU2hpcChzaGlwLCBpbmRleCk7XHJcbiAgICAgIGkrKzsgXHJcbiAgICB9ICAgICBcclxuICB9XHJcbn1cclxuXHJcbmZ1bmN0aW9uIGNoZWNrT3ZlcmxhcChzdGFydEluZGV4LCBsZW5ndGgpIHtcclxuICBsZXQgbGFzdENlbGxJbmRleCA9IHN0YXJ0SW5kZXggKyBsZW5ndGggLSAxO1xyXG4gIGxldCBpbmRleHJvdyA9IE1hdGguZmxvb3Ioc3RhcnRJbmRleCAvIDEwKTtcclxuICBsZXQgbGFzdHJvdyA9IE1hdGguZmxvb3IobGFzdENlbGxJbmRleCAvIDEwKTtcclxuICBcclxuICBpZiAobGFzdHJvdyA+IGluZGV4cm93KSB7XHJcbiAgICByZXR1cm4gZmFsc2U7XHJcbiAgfVxyXG4gIFxyXG4gIHJldHVybiB0cnVlO1xyXG59XHJcblxyXG5mdW5jdGlvbiBjaGVja1NoaXBQbGFjZW1lbnQocGxheWVyYm9hcmQsIHN0YXJ0SW5kZXgsIGxlbmd0aCkge1xyXG4gIGNvbnN0IGJvYXJkID0gcGxheWVyYm9hcmQuZ2V0Qm9hcmQoKTtcclxuICBmb3IgKGxldCBpID0gMDsgaSA8IGxlbmd0aDsgaSsrKSB7XHJcbiAgICBjb25zdCBpbmRpY2VzID0gc3RhcnRJbmRleCArIGk7XHJcblxyXG4gICAgaWYgKGJvYXJkW2luZGljZXNdICE9PSBudWxsKSB7XHJcbiAgICAgIHJldHVybiBmYWxzZTtcclxuICAgIH1cclxuICB9XHJcbiAgXHJcbiAgcmV0dXJuIHRydWU7XHJcbn1cclxuXHJcbmV4cG9ydCB7IHBsYWNlc2hpcHMgfTtcclxuIiwiaW1wb3J0IFBsYXllcnMgZnJvbSBcIi4vcGxheWVyXCI7XHJcbmltcG9ydCBHYW1lYm9hcmQgZnJvbSBcIi4vZ2FtZWJvYXJkXCI7XHJcbmltcG9ydCBTaGlwIGZyb20gXCIuL3NoaXBcIjtcclxuaW1wb3J0IGRvTSBmcm9tIFwiLi9ET01cIjtcclxuaW1wb3J0IHsgcGxhY2VzaGlwcyB9IGZyb20gXCIuL3BsYWNlc2hpcHNcIjtcclxuXHJcbmZ1bmN0aW9uIGdhbWVMb29wKHBsYXllcjEsIHBsYXllcjIpIHtcclxuICBsZXQgY29tcGJvYXJkLCBwbGF5ZXJib2FyZDtcclxuICBwbGF5ZXJib2FyZCA9IEdhbWVib2FyZCgpO1xyXG4gIGNvbXBib2FyZCA9IEdhbWVib2FyZCgpO1xyXG4gIGNvbnN0IGNsaWNrZWRDZWxscyA9IFtdO1xyXG4gIGNvbnN0IHBsYXllcjFib2FyZCA9IGRvY3VtZW50LmdldEVsZW1lbnRCeUlkKFwicGxheWVyYm9hcmRcIik7XHJcbiAgY29uc3QgcGxheWVyMmJvYXJkID0gZG9jdW1lbnQuZ2V0RWxlbWVudEJ5SWQoXCJjb21wYm9hcmRcIik7XHJcbiAgZG9NLnJlbmRlckJvYXJkKHBsYXllcjFib2FyZCxcInBsYXllclwiKTtcclxuICBkb00ucmVuZGVyQm9hcmQocGxheWVyMmJvYXJkLCBcImNvbXB1dGVyXCIpO1xyXG5cclxuXHJcbiAgcGxhY2VzaGlwcyhcInBsYXllclwiLHBsYXllcmJvYXJkKTtcclxuICBwbGFjZXNoaXBzKFwiY29tcHV0ZXJcIixjb21wYm9hcmQpO1xyXG5cclxuIGNvbnNvbGUubG9nKGNvbXBib2FyZC5nZXRTaGlwcygpKVxyXG4gIGxldCBwcmV2aW91c0F0dGFjayA9IG5ldyBTZXQoKTsgLy90byBwcmV2ZW50IHRoZSBjb21wIGZyb20gYXR0YWNraW5nIHRoZSBzYW1lIGluZGV4IHR3aWNlXHJcbiAgbGV0IGN1cnJlbnRQbGF5ZXIgPSBwbGF5ZXIxO1xyXG4gIGxldCBnYW1lT3ZlciA9IGZhbHNlO1xyXG4gIGxldCBwcmV2aW91c0hpdHMgPSBbXTtcclxuXHJcbiAgXHJcbiAgcGxheWVyMmJvYXJkLmFkZEV2ZW50TGlzdGVuZXIoXCJjbGlja1wiLCAoZSkgPT4ge1xyXG4gICAgY29uc3QgaXN2YWxpZGNsaWNrID0gY2hlY2tEb3VibGUoZSk7XHJcbiAgICBpZihpc3ZhbGlkY2xpY2spe1xyXG4gICAgICBpZiAoY3VycmVudFBsYXllciAhPT0gcGxheWVyMSB8fCBnYW1lT3Zlcikge1xyXG4gICAgICAgIHJldHVybjtcclxuICAgICAgfVxyXG4gICAgICBoYW5kbGVDbGljayhlKTtcclxuICAgICAgY2hlY2tnYW1lT3ZlcigpO1xyXG4gICAgICBjdXJyZW50UGxheWVyID0gc3dpdGNoUGxheWVyKCk7XHJcbiAgICAgIHNldFRpbWVvdXQoY29tcHV0ZXJUdXJuLCAxMDApO1xyXG4gICAgfVxyXG4gICAgXHJcbiAgfSk7XHJcbiAgXHJcbiAgZnVuY3Rpb24gY2hlY2tEb3VibGUoZSl7XHJcbiAgICBjb25zdCBjZWxsaW5kZXggPSBlLnRhcmdldC5kYXRhc2V0LmluZGV4O1xyXG4gICAgaWYoY2xpY2tlZENlbGxzLmluY2x1ZGVzKGNlbGxpbmRleCkpe1xyXG4gICAgICByZXR1cm4gZmFsc2U7XHJcbiAgICB9XHJcbiAgICBjbGlja2VkQ2VsbHMucHVzaChjZWxsaW5kZXgpO1xyXG4gICAgcmV0dXJuIHRydWU7XHJcbiAgfVxyXG5cclxuICBmdW5jdGlvbiBoYW5kbGVDbGljayhldmVudCkge1xyXG4gICAgaWYgKGdhbWVPdmVyKSB7XHJcbiAgICAgIHJldHVybjtcclxuICAgIH1cclxuICAgIGNvbnN0IGNlbGxpbmRleCA9IGV2ZW50LnRhcmdldC5kYXRhc2V0LmluZGV4O1xyXG4gICAgY29uc3QgcmVzdWx0ID0gY29tcGJvYXJkLnJlY2VpdmVBdHRhY2soY2VsbGluZGV4KTtcclxuICAgIGlmIChyZXN1bHQgPT09IHRydWUpIHtcclxuICAgICAgZXZlbnQudGFyZ2V0LnN0eWxlLmJhY2tncm91bmRDb2xvciA9IFwiI2Y3MDIwMlwiO1xyXG4gICAgfSBlbHNlIHtcclxuICAgICAgZXZlbnQudGFyZ2V0LnN0eWxlLmJhY2tncm91bmRDb2xvciA9IFwiIzAyZDkxYlwiO1xyXG4gICAgfVxyXG4gIH1cclxuICBsZXQgYXR0YWNrSW5kZXg7XHJcblxyXG4gIGZ1bmN0aW9uIGNvbXB1dGVyVHVybigpIHtcclxuICAgIGlmKHByZXZpb3VzSGl0cy5sZW5ndGggPiAwKXtcclxuICAgICAgY29uc3QgbGFzdEF0dGFjayA9IHByZXZpb3VzSGl0c1twcmV2aW91c0hpdHMubGVuZ3RoIC0gMV07XHJcbiAgICAgIGNvbnN0IGxhc3RBZGphY2VudEluZGV4ID0gZ2V0QWRqYWNlbnRJbmRleChsYXN0QXR0YWNrKTtcclxuICAgICAgY29uc29sZS5sb2cobGFzdEFkamFjZW50SW5kZXgpO1xyXG4gICAgICBmb3IoY29uc3QgaW5kZXggb2YgbGFzdEFkamFjZW50SW5kZXgpe1xyXG4gICAgICAgIGlmKCFwcmV2aW91c0F0dGFjay5oYXMoaW5kZXgpKXtcclxuICAgICAgICAgIGF0dGFja0luZGV4ID0gaW5kZXg7XHJcbiAgICAgICAgICBicmVhaztcclxuICAgICAgICB9XHJcbiAgICAgIH1cclxuICAgICAgcHJldmlvdXNIaXRzLnBvcCgpOyBcclxuICAgIH1cclxuICAgIGVsc2V7XHJcbiAgICAgIGF0dGFja0luZGV4ID0gcmFuZG9tQXR0YWNrKCk7XHJcbiAgICB9XHJcbiAgICBcclxuICAgIGNvbXB1dGVyQUkoYXR0YWNrSW5kZXgpO1xyXG4gIH1cclxuXHJcbiAgZnVuY3Rpb24gcmFuZG9tQXR0YWNrKCl7XHJcbiAgICBsZXQgeCA9IE1hdGguZmxvb3IoTWF0aC5yYW5kb20oKSAqIDEwMCk7XHJcbiAgICB3aGlsZShwcmV2aW91c0F0dGFjay5oYXMoeCkpe1xyXG4gICAgICB4ID0gTWF0aC5mbG9vcihNYXRoLnJhbmRvbSgpICogMTAwKTtcclxuICAgIH1cclxuICAgIHJldHVybiB4O1xyXG4gIH1cclxuICBcclxuICBmdW5jdGlvbiBjb21wdXRlckFJKGkpe1xyXG4gICAgaWYgKGdhbWVPdmVyKSB7XHJcbiAgICAgIHJldHVybjtcclxuICAgIH1cclxuICAgIGNvbnN0IGNvbXBoaXQgPSBwbGF5ZXJib2FyZC5yZWNlaXZlQXR0YWNrKGkpO1xyXG4gICAgY29uc3QgY2VsbCA9IHBsYXllcjFib2FyZC5xdWVyeVNlbGVjdG9yKGBbZGF0YS1pbmRleD0nJHtpfSddYCk7XHJcbiAgICBpZiAoY29tcGhpdCA9PT0gdHJ1ZSkge1xyXG4gICAgICBjZWxsLnN0eWxlLmJhY2tncm91bmRDb2xvciA9IFwiI2Y3MDIwMlwiO1xyXG4gICAgICBwcmV2aW91c0hpdHMucHVzaChpKTtcclxuICAgICAgY29uc29sZS5sb2cocHJldmlvdXNIaXRzKTtcclxuICAgIH0gZWxzZSB7XHJcbiAgICAgIGNlbGwuc3R5bGUuYmFja2dyb3VuZENvbG9yID0gXCIjMDJkOTFiXCI7XHJcbiAgICB9XHJcbiAgICBwcmV2aW91c0F0dGFjay5hZGQoaSk7XHJcbiAgICBjaGVja2dhbWVPdmVyKCk7XHJcbiAgICBjdXJyZW50UGxheWVyID0gc3dpdGNoUGxheWVyKCk7XHJcbiAgfVxyXG5cclxuICBmdW5jdGlvbiBnZXRBZGphY2VudEluZGV4KGluZGV4KXtcclxuICAgIGNvbnN0IGFkamFjZW50SW5kZXhlcyA9IFtdO1xyXG4gICAgY29uc3QgY29sID0gaW5kZXggJSAxMDtcclxuICAgIGlmKGNvbCA+IDApe1xyXG4gICAgICBhZGphY2VudEluZGV4ZXMucHVzaChpbmRleCAtIDEpO1xyXG4gICAgfVxyXG4gICAgaWYoY29sIDwgOSl7XHJcbiAgICAgIGFkamFjZW50SW5kZXhlcy5wdXNoKGluZGV4ICsgMSk7XHJcbiAgICB9XHJcbiAgICByZXR1cm4gYWRqYWNlbnRJbmRleGVzO1xyXG4gIH1cclxuXHJcblxyXG4gIGZ1bmN0aW9uIHN3aXRjaFBsYXllcigpIHtcclxuICAgIHJldHVybiAoY3VycmVudFBsYXllciA9IGN1cnJlbnRQbGF5ZXIgPT09IHBsYXllcjEgPyBwbGF5ZXIyIDogcGxheWVyMSk7XHJcbiAgfVxyXG5cclxuICBmdW5jdGlvbiBjaGVja2dhbWVPdmVyKCkge1xyXG4gICAgaWYgKHBsYXllcmJvYXJkLmFsbFNoaXBzU3VuaygpKSB7XHJcbiAgICAgIGdhbWVPdmVyID0gdHJ1ZTtcclxuICAgICAgZG9jdW1lbnQuZ2V0RWxlbWVudEJ5SWQoJ3dpbm5lcicpLmlubmVyVGV4dCA9IFwiQ29tcHV0ZXIgV2luIVwiO1xyXG4gICAgICBwbGF5ZXIyYm9hcmQucmVtb3ZlRXZlbnRMaXN0ZW5lcihcImNsaWNrXCIsIGhhbmRsZUNsaWNrKTtcclxuICAgICAgcmV0dXJuO1xyXG4gICAgfVxyXG4gICAgaWYgKGNvbXBib2FyZC5hbGxTaGlwc1N1bmsoKSkge1xyXG4gICAgICBnYW1lT3ZlciA9IHRydWU7XHJcbiAgICAgIGRvY3VtZW50LmdldEVsZW1lbnRCeUlkKCd3aW5uZXInKS5pbm5lclRleHQgPSBcIllvdSBXaW4hXCI7XHJcbiAgICAgIHJldHVybjtcclxuICAgIH1cclxuICB9XHJcbn1cclxuXHJcbmV4cG9ydCBkZWZhdWx0IGdhbWVMb29wO1xyXG4iLCJpbXBvcnQgZG9NIGZyb20gXCIuL0RPTVwiO1xyXG5pbXBvcnQgUGxheWVyIGZyb20gXCIuL3BsYXllclwiO1xyXG5pbXBvcnQgR2FtZWJvYXJkIGZyb20gXCIuL2dhbWVib2FyZFwiO1xyXG5pbXBvcnQgU2hpcCBmcm9tIFwiLi9zaGlwXCI7XHJcbmltcG9ydCBnYW1lTG9vcCBmcm9tIFwiLi9nYW1lbG9vcFwiO1xyXG5cclxuXHJcbmdhbWVMb29wKHtuYW1lOiBcIlBsYXllclwifSwge25hbWU6IFwiQ29tcHV0ZXJcIn0pO1xyXG4iXSwibmFtZXMiOlsiYm9hcmRFbGVtZW50IiwiaG9sZGVyIiwiaW5uZXJIVE1MIiwiaSIsImNlbGwiLCJkb2N1bWVudCIsImNyZWF0ZUVsZW1lbnQiLCJkYXRhc2V0IiwiaW5kZXgiLCJjbGFzc0xpc3QiLCJhZGQiLCJhcHBlbmRDaGlsZCIsImJvYXJkIiwiQXJyYXkiLCJmaWxsIiwic2hpcHMiLCJtaXNzZWRBdHRhY2tzIiwiZ2V0U2hpcHMiLCJsZW5ndGgiLCJnZXRCb2FyZCIsInBsYWNlU2hpcCIsInNoaXAiLCJzaGlwbGVuZ3RoIiwiY29vcmRpbmF0ZXMiLCJwdXNoIiwiZm9yRWFjaCIsImNvb3JkIiwicmVjZWl2ZUF0dGFjayIsImhpdCIsImFsbFNoaXBzU3VuayIsImV2ZXJ5IiwiaXNTdW5rIiwiaGl0cyIsInBsYWNlc2hpcHMiLCJwbGF5ZXJib2FyZCIsInNoaXBzTGVuZ3RoIiwic2hpcHNsZW4iLCJjZWxscyIsInF1ZXJ5U2VsZWN0b3JBbGwiLCJnYW1lIiwidHVybiIsImdldEVsZW1lbnRCeUlkIiwiYWRkRXZlbnRMaXN0ZW5lciIsImV2ZW50IiwidGFyZ2V0IiwicGFyc2VJbnQiLCJjYW5QbGFjZVNoaXAiLCJzdGFydEluZGV4IiwiY2hlY2tTaGlwUGxhY2VtZW50Iiwibm9PdmVybGFwIiwiY2hlY2tPdmVybGFwIiwiaW5uZXJUZXh0IiwiayIsInF1ZXJ5U2VsZWN0b3IiLCJzdHlsZSIsImJhY2tncm91bmRDb2xvciIsIk1hdGgiLCJmbG9vciIsInJhbmRvbSIsImxhc3RDZWxsSW5kZXgiLCJpbmRleHJvdyIsInBsYXllcjEiLCJwbGF5ZXIyIiwiY29tcGJvYXJkIiwiY2xpY2tlZENlbGxzIiwicGxheWVyMWJvYXJkIiwicGxheWVyMmJvYXJkIiwiY29uc29sZSIsImxvZyIsImF0dGFja0luZGV4IiwicHJldmlvdXNBdHRhY2siLCJTZXQiLCJjdXJyZW50UGxheWVyIiwiZ2FtZU92ZXIiLCJwcmV2aW91c0hpdHMiLCJoYW5kbGVDbGljayIsImNlbGxpbmRleCIsInJlc3VsdCIsImNvbXB1dGVyVHVybiIsImxhc3RBZGphY2VudEluZGV4IiwiYWRqYWNlbnRJbmRleGVzIiwiY29sIiwiZ2V0QWRqYWNlbnRJbmRleCIsImhhcyIsInBvcCIsIngiLCJyYW5kb21BdHRhY2siLCJjb21waGl0IiwiY2hlY2tnYW1lT3ZlciIsInN3aXRjaFBsYXllciIsImNvbXB1dGVyQUkiLCJyZW1vdmVFdmVudExpc3RlbmVyIiwiZSIsImlzdmFsaWRjbGljayIsImluY2x1ZGVzIiwiY2hlY2tEb3VibGUiLCJzZXRUaW1lb3V0IiwibmFtZSJdLCJzb3VyY2VSb290IjoiIn0=