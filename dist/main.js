(()=>{"use strict";const e=function(e,t){e.innerHTML="";for(let n=0;n<100;n++){const l=document.createElement("div");l.dataset.index=n,"player"==t?(l.classList.add("cell"),l.classList.add(`h${n}`)):"computer"==t&&(l.classList.add("enemycell"),l.classList.add(`e${n}`)),e.appendChild(l)}},t=function(){let e=Array(100).fill(null),t=[],n=[];return{getShips:function(){return t.length},getBoard:function(){return e},placeShip:function(n,l){let r=n.length,o=[];for(let e=0;e<r;e++)o.push(l+e);o.forEach((t=>{e[t]=n})),t.push(n)},receiveAttack:function(t){return null===e[t]?(n.push(t),!1):(e[t].hit(),!0)},allShipsSunk:function(){return t.every((e=>e.isSunk()))},missedAttacks:n}},n=function(e){let t=0;return{length:e,hit:()=>(t++,t),isSunk:()=>t===e,get hits(){return t}}};function l(e,t){if("player"===e){const e=[5,4,3,2];let l=e.length;const o=document.querySelectorAll(".cell");let u=!0,c=0;const a=document.getElementById("turn");u&&o.forEach((o=>{o.addEventListener("click",(o=>{const i=o.target,s=parseInt(i.dataset.index),d=function(e,t,n){const l=e.getBoard();for(let e=0;e<n;e++)if(null!==l[t+e])return!1;return!0}(t,s,e[c]),f=r(s,e[c]);if(a.innerText=0==c?"Place your Submarine":1==c?"Place your Attackerr":2==c?"Place your Ship":"Play",d&&f){const r=n(e[c]);t.placeShip(r,s);for(let t=0;t<e[c];t++)document.querySelector(`.h${s+t}`).style.backgroundColor="#292828";c++,c===l&&(u=!1)}}))}))}else if("computer"===e){const e=[5,4,3,2];let l=e.length,o=0;for(;o<l;){let l=n(e[o]),u=Math.floor(100*Math.random());r(u,e[o])&&(t.placeShip(l,u),o++)}}}function r(e,t){let n=e+t-1,l=Math.floor(e/10);return!(Math.floor(n/10)>l)}!function(n,r){let o,u;u=t(),o=t();const c=[],a=document.getElementById("playerboard"),i=document.getElementById("compboard");e(a,"player"),e(i,"computer"),l("player",u),l("computer",o),console.log(o.getShips());let s,d=new Set,f=n,h=!1,p=[],m=null,y=null;function g(e){if(h)return;const t=e.target.dataset.index,n=o.receiveAttack(t);e.target.style.backgroundColor=!0===n?"#f70202":"#02d91b"}function S(){null!=m||null!=y?(p.pop(),null!=m?(s=m,m-=1):null!=y&&(s=y,y+=1)):s=k(),function(e){if(h)return;const t=u.receiveAttack(e),n=a.querySelector(`[data-index='${e}']`);!0===t?(n.style.backgroundColor="#f70202",p.push(e),null===m&&(m=e-1),d.has(m)&&(m=null),null===y&&(y=e+1),d.has(y)&&(y=null)):(n.style.backgroundColor="#02d91b",null!=m?m=null:y=null),d.add(e),E(),f=v()}(s)}function k(){let e=Math.floor(100*Math.random());for(;d.has(e);)e=Math.floor(100*Math.random());return d.has(e)&&k(),e}function v(){return f=f===n?r:n}function E(){return u.allShipsSunk()?(h=!0,document.getElementById("winner").innerText="Computer Win!",void i.removeEventListener("click",g)):o.allShipsSunk()?(h=!0,void(document.getElementById("winner").innerText="You Win!")):void 0}i.addEventListener("click",(e=>{const t=function(e){const t=e.target.dataset.index;return!c.includes(t)&&(c.push(t),!0)}(e);if(t){if(f!==n||h)return;g(e),E(),f=v(),setTimeout(S,100)}}))}({name:"Player"},{name:"Computer"})})();
//# sourceMappingURL=data:application/json;charset=utf-8;base64,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QWUsVUFBVVUsVUFBWSxrQkFGaEQsQ0FLRixDQTdJQWUsRUFBYXhCLGlCQUFpQixTQUFVZ0QsSUFDdEMsTUFBTUMsRUFhUixTQUFxQkQsR0FDbkIsTUFBTVosRUFBWVksRUFBRTlDLE9BQU9yQyxRQUFRQyxNQUNuQyxPQUFHd0QsRUFBYTRCLFNBQVNkLEtBR3pCZCxFQUFheEMsS0FBS3NELElBQ1gsRUFDVCxDQXBCdUJlLENBQVlILEdBQ2pDLEdBQUdDLEVBQWEsQ0FDZCxHQUFJbkIsSUFBa0JYLEdBQVdZLEVBQy9CLE9BRUZJLEVBQVlhLEdBQ1pMLElBQ0FiLEVBQWdCYyxJQUNoQlEsV0FBV2QsRUFBYyxJQUMzQixJQW9JSixDQ3BLQSxDQUFTLENBQUNlLEtBQU0sVUFBVyxDQUFDQSxLQUFNLFkiLCJzb3VyY2VzIjpbIndlYnBhY2s6Ly90aGUtYmF0dGxlc2hpcC8uL3NjcmlwdC9ET00uanMiLCJ3ZWJwYWNrOi8vdGhlLWJhdHRsZXNoaXAvLi9zY3JpcHQvZ2FtZWJvYXJkLmpzIiwid2VicGFjazovL3RoZS1iYXR0bGVzaGlwLy4vc2NyaXB0L3NoaXAuanMiLCJ3ZWJwYWNrOi8vdGhlLWJhdHRsZXNoaXAvLi9zY3JpcHQvcGxhY2VzaGlwcy5qcyIsIndlYnBhY2s6Ly90aGUtYmF0dGxlc2hpcC8uL3NjcmlwdC9nYW1lbG9vcC5qcyIsIndlYnBhY2s6Ly90aGUtYmF0dGxlc2hpcC8uL3NjcmlwdC9pbmRleC5qcyJdLCJzb3VyY2VzQ29udGVudCI6WyJjb25zdCBkb00gPSAoKCk9PntcbiAgICBmdW5jdGlvbiByZW5kZXJCb2FyZChib2FyZEVsZW1lbnQsIGhvbGRlcikge1xuICAgICAgICBib2FyZEVsZW1lbnQuaW5uZXJIVE1MID0gJyc7XG4gICAgICAgIGZvciAobGV0IGkgPSAwOyBpIDwgMTAwOyBpKyspIHtcbiAgICAgICAgICAgIGNvbnN0IGNlbGwgPSBkb2N1bWVudC5jcmVhdGVFbGVtZW50KCdkaXYnKTtcbiAgICAgICAgICAgIGNlbGwuZGF0YXNldC5pbmRleCA9IGk7XG4gICAgICAgICAgICBpZihob2xkZXIgPT0gXCJwbGF5ZXJcIil7XG4gICAgICAgICAgICAgICAgY2VsbC5jbGFzc0xpc3QuYWRkKCdjZWxsJyk7XG4gICAgICAgICAgICAgICAgY2VsbC5jbGFzc0xpc3QuYWRkKGBoJHtpfWApO1xuICAgICAgICAgICAgfVxuICAgICAgICAgICAgZWxzZSBpZihob2xkZXIgPT0gXCJjb21wdXRlclwiKXtcbiAgICAgICAgICAgICAgICBjZWxsLmNsYXNzTGlzdC5hZGQoJ2VuZW15Y2VsbCcpO1xuICAgICAgICAgICAgICAgIGNlbGwuY2xhc3NMaXN0LmFkZChgZSR7aX1gKTtcbiAgICAgICAgICAgIH1cbiAgICAgICAgICAgIGJvYXJkRWxlbWVudC5hcHBlbmRDaGlsZChjZWxsKTtcbiAgICAgICAgfVxuICAgIH07XG5cbiAgICByZXR1cm4ge1xuICAgICAgICByZW5kZXJCb2FyZFxuICAgIH1cbn0pKCk7XG5cblxuZXhwb3J0IGRlZmF1bHQgZG9NIiwiaW1wb3J0IFNoaXAgZnJvbSBcIi4vc2hpcFwiO1xuZnVuY3Rpb24gR2FtZWJvYXJkKCkge1xuICBsZXQgYm9hcmQgPSBBcnJheSgxMDApLmZpbGwobnVsbCk7XG4gIGxldCBzaGlwcyA9IFtdO1xuICBsZXQgbWlzc2VkQXR0YWNrcyA9IFtdO1xuXG5cbiAgZnVuY3Rpb24gcGxhY2VTaGlwKHNoaXAsaW5kZXgpIHtcbiAgICBsZXQgc2hpcGxlbmd0aCA9IHNoaXAubGVuZ3RoO1xuICAgIGxldCBjb29yZGluYXRlcyA9IFtdO1xuICAgIGZvcihsZXQgaT0wO2k8c2hpcGxlbmd0aDtpKyspe1xuICAgICAgY29vcmRpbmF0ZXMucHVzaChpbmRleCtpKTtcbiAgICB9XG4gICAgY29vcmRpbmF0ZXMuZm9yRWFjaChjb29yZCA9PiB7XG4gICAgICBib2FyZFtjb29yZF0gPSBzaGlwO1xuICAgIH0pO1xuICAgIHNoaXBzLnB1c2goc2hpcCk7XG5cbiAgfVxuICBcbiAgZnVuY3Rpb24gcmVjZWl2ZUF0dGFjayhjb29yZGluYXRlcykge1xuICAgIGlmIChib2FyZFtjb29yZGluYXRlc10gPT09IG51bGwpIHtcbiAgICAgIG1pc3NlZEF0dGFja3MucHVzaChjb29yZGluYXRlcyk7XG4gICAgICByZXR1cm4gZmFsc2U7XG4gICAgfVxuICAgIGNvbnN0IGhpdFNoaXAgPSBib2FyZFtjb29yZGluYXRlc107XG4gICAgaGl0U2hpcC5oaXQoKTtcbiAgICByZXR1cm4gdHJ1ZTtcbiAgfVxuXG4gIGZ1bmN0aW9uIGFsbFNoaXBzU3VuaygpIHtcbiAgICByZXR1cm4gc2hpcHMuZXZlcnkoc2hpcCA9PiBzaGlwLmlzU3VuaygpKTtcbiAgfVxuICBmdW5jdGlvbiBnZXRCb2FyZCgpe1xuICAgIHJldHVybiBib2FyZDtcbiAgfVxuICBmdW5jdGlvbiBnZXRTaGlwcygpe1xuICAgIHJldHVybiBzaGlwcy5sZW5ndGg7XG4gIH1cbiAgcmV0dXJuIHtcbiAgICBnZXRTaGlwcyxcbiAgICBnZXRCb2FyZCxcbiAgICBwbGFjZVNoaXAsXG4gICAgcmVjZWl2ZUF0dGFjayxcbiAgICBhbGxTaGlwc1N1bmssXG4gICAgbWlzc2VkQXR0YWNrcyxcbiAgfTtcbn1cblxuZXhwb3J0IGRlZmF1bHQgR2FtZWJvYXJkOyIsImZ1bmN0aW9uIFNoaXAobGVuZ3RoKSB7XG4gIGxldCBoaXRzID0gMDtcblxuICByZXR1cm4ge1xuICAgIGxlbmd0aDogbGVuZ3RoLFxuICAgIGhpdCgpIHtcbiAgICAgIGhpdHMrK1xuICAgICAgcmV0dXJuIGhpdHM7XG4gICAgfSxcbiAgICBpc1N1bmsoKSB7XG4gICAgICByZXR1cm4gaGl0cyA9PT0gbGVuZ3RoO1xuICAgIH0sXG4gICAgZ2V0IGhpdHMoKXtcbiAgICAgIHJldHVybiBoaXRzO1xuICAgIH1cbiAgfTtcbn1cbmV4cG9ydCBkZWZhdWx0IFNoaXA7IiwiaW1wb3J0IFNoaXAgZnJvbSBcIi4vc2hpcFwiO1xuaW1wb3J0IEdhbWVib2FyZCBmcm9tIFwiLi9nYW1lYm9hcmRcIjtcblxuZnVuY3Rpb24gcGxhY2VzaGlwcyhob2xkZXIsIHBsYXllcmJvYXJkKSB7XG4gIGlmIChob2xkZXIgPT09IFwicGxheWVyXCIpIHtcbiAgICBjb25zdCBzaGlwc0xlbmd0aCA9IFs1LCA0LCAzLCAyXTtcbiAgICBsZXQgc2hpcHNsZW4gPSBzaGlwc0xlbmd0aC5sZW5ndGg7XG4gICAgY29uc3QgY2VsbHMgPSBkb2N1bWVudC5xdWVyeVNlbGVjdG9yQWxsKCcuY2VsbCcpO1xuICAgIGxldCBnYW1lID0gdHJ1ZTtcbiAgICBsZXQgaSA9IDA7XG4gICAgY29uc3QgdHVybiA9IGRvY3VtZW50LmdldEVsZW1lbnRCeUlkKCd0dXJuJyk7XG4gICAgaWYgKGdhbWUpIHtcbiAgICAgIGNlbGxzLmZvckVhY2goY2VsbCA9PiB7XG4gICAgICAgIGNlbGwuYWRkRXZlbnRMaXN0ZW5lcignY2xpY2snLCAoZXZlbnQpID0+IHtcbiAgICAgICAgICBjb25zdCBjZWxsID0gZXZlbnQudGFyZ2V0O1xuICAgICAgICAgIGNvbnN0IGluZGV4ID0gcGFyc2VJbnQoY2VsbC5kYXRhc2V0LmluZGV4KTtcbiAgICAgICAgICBjb25zdCBjYW5QbGFjZVNoaXAgPSBjaGVja1NoaXBQbGFjZW1lbnQocGxheWVyYm9hcmQsIGluZGV4LCBzaGlwc0xlbmd0aFtpXSk7XG4gICAgICAgICAgY29uc3Qgbm9PdmVybGFwID0gY2hlY2tPdmVybGFwKGluZGV4LCBzaGlwc0xlbmd0aFtpXSk7XG4gICAgICAgICAgaWYoaSA9PTApe1xuICAgICAgICAgICAgdHVybi5pbm5lclRleHQgPSBcIlBsYWNlIHlvdXIgU3VibWFyaW5lXCI7XG4gICAgICAgICAgfVxuICAgICAgICAgIGVsc2UgaWYoaT09MSl7XG4gICAgICAgICAgICB0dXJuLmlubmVyVGV4dCA9IFwiUGxhY2UgeW91ciBBdHRhY2tlcnJcIjtcbiAgICAgICAgICB9XG4gICAgICAgICAgZWxzZSBpZihpPT0yKXtcbiAgICAgICAgICAgIHR1cm4uaW5uZXJUZXh0ID0gXCJQbGFjZSB5b3VyIFNoaXBcIjtcbiAgICAgICAgICB9XG4gICAgICAgICAgZWxzZXtcbiAgICAgICAgICAgIHR1cm4uaW5uZXJUZXh0ID0gXCJQbGF5XCI7XG4gICAgICAgICAgfVxuICAgICAgICAgIGlmIChjYW5QbGFjZVNoaXAgJiYgbm9PdmVybGFwKSB7XG4gICAgICAgICAgICBjb25zdCBzaGlwID0gU2hpcChzaGlwc0xlbmd0aFtpXSk7XG4gICAgICAgICAgICBwbGF5ZXJib2FyZC5wbGFjZVNoaXAoc2hpcCwgaW5kZXgpOyAgXG4gICAgICAgICAgICBmb3IgKGxldCBrID0gMDsgayA8IHNoaXBzTGVuZ3RoW2ldOyBrKyspIHtcbiAgICAgICAgICAgICAgZG9jdW1lbnQucXVlcnlTZWxlY3RvcihgLmgke2luZGV4ICsga31gKS5zdHlsZS5iYWNrZ3JvdW5kQ29sb3IgPSBcIiMyOTI4MjhcIjtcbiAgICAgICAgICAgIH1cbiAgICAgICAgICAgIGkrKztcbiAgICAgICAgICAgIGlmIChpID09PSBzaGlwc2xlbikge1xuICAgICAgICAgICAgICBnYW1lID0gZmFsc2U7XG4gICAgICAgICAgICB9XG4gICAgICAgICAgfVxuICAgICAgICB9KTtcbiAgICAgIH0pO1xuICAgIH1cbiAgfSBlbHNlIGlmIChob2xkZXIgPT09IFwiY29tcHV0ZXJcIikge1xuICAgIGNvbnN0IHNoaXBzTGVuZ3RoID0gWzUsIDQsIDMsIDJdO1xuICAgIGxldCBzaGlwc2xlbiA9IHNoaXBzTGVuZ3RoLmxlbmd0aDtcbiAgICBsZXQgaSA9IDA7XG4gICAgXG4gICAgd2hpbGUgKGkgPCBzaGlwc2xlbikge1xuICAgICAgbGV0IHNoaXAgPSBTaGlwKHNoaXBzTGVuZ3RoW2ldKTtcbiAgICAgIGxldCBpbmRleCA9IE1hdGguZmxvb3IoTWF0aC5yYW5kb20oKSAqIDEwMCk7XG4gICAgICBjb25zdCBub092ZXJsYXAgPSBjaGVja092ZXJsYXAoaW5kZXgsIHNoaXBzTGVuZ3RoW2ldKTtcblxuICAgICAgaWYgKCFub092ZXJsYXApIHsgLy8gQ2hlY2sgaWYgdGhlIHNoaXAgaXMgb3ZlcmxhcHBpbmdcbiAgICAgICAgY29udGludWU7XG4gICAgICB9IFxuICAgICAgcGxheWVyYm9hcmQucGxhY2VTaGlwKHNoaXAsIGluZGV4KTtcbiAgICAgIGkrKzsgXG4gICAgfSAgICAgXG4gIH1cbn1cblxuZnVuY3Rpb24gY2hlY2tPdmVybGFwKHN0YXJ0SW5kZXgsIGxlbmd0aCkge1xuICBsZXQgbGFzdENlbGxJbmRleCA9IHN0YXJ0SW5kZXggKyBsZW5ndGggLSAxO1xuICBsZXQgaW5kZXhyb3cgPSBNYXRoLmZsb29yKHN0YXJ0SW5kZXggLyAxMCk7XG4gIGxldCBsYXN0cm93ID0gTWF0aC5mbG9vcihsYXN0Q2VsbEluZGV4IC8gMTApO1xuICBcbiAgaWYgKGxhc3Ryb3cgPiBpbmRleHJvdykge1xuICAgIHJldHVybiBmYWxzZTtcbiAgfVxuICBcbiAgcmV0dXJuIHRydWU7XG59XG5cbmZ1bmN0aW9uIGNoZWNrU2hpcFBsYWNlbWVudChwbGF5ZXJib2FyZCwgc3RhcnRJbmRleCwgbGVuZ3RoKSB7XG4gIGNvbnN0IGJvYXJkID0gcGxheWVyYm9hcmQuZ2V0Qm9hcmQoKTtcbiAgZm9yIChsZXQgaSA9IDA7IGkgPCBsZW5ndGg7IGkrKykge1xuICAgIGNvbnN0IGluZGljZXMgPSBzdGFydEluZGV4ICsgaTtcblxuICAgIGlmIChib2FyZFtpbmRpY2VzXSAhPT0gbnVsbCkge1xuICAgICAgcmV0dXJuIGZhbHNlO1xuICAgIH1cbiAgfVxuICBcbiAgcmV0dXJuIHRydWU7XG59XG5cbmV4cG9ydCB7IHBsYWNlc2hpcHMgfTtcbiIsImltcG9ydCBQbGF5ZXJzIGZyb20gXCIuL3BsYXllclwiO1xuaW1wb3J0IEdhbWVib2FyZCBmcm9tIFwiLi9nYW1lYm9hcmRcIjtcbmltcG9ydCBTaGlwIGZyb20gXCIuL3NoaXBcIjtcbmltcG9ydCBkb00gZnJvbSBcIi4vRE9NXCI7XG5pbXBvcnQgeyBwbGFjZXNoaXBzIH0gZnJvbSBcIi4vcGxhY2VzaGlwc1wiO1xuXG5mdW5jdGlvbiBnYW1lTG9vcChwbGF5ZXIxLCBwbGF5ZXIyKSB7XG4gIGxldCBjb21wYm9hcmQsIHBsYXllcmJvYXJkO1xuICBwbGF5ZXJib2FyZCA9IEdhbWVib2FyZCgpO1xuICBjb21wYm9hcmQgPSBHYW1lYm9hcmQoKTtcbiAgY29uc3QgY2xpY2tlZENlbGxzID0gW107XG4gIGNvbnN0IHBsYXllcjFib2FyZCA9IGRvY3VtZW50LmdldEVsZW1lbnRCeUlkKFwicGxheWVyYm9hcmRcIik7XG4gIGNvbnN0IHBsYXllcjJib2FyZCA9IGRvY3VtZW50LmdldEVsZW1lbnRCeUlkKFwiY29tcGJvYXJkXCIpO1xuICBkb00ucmVuZGVyQm9hcmQocGxheWVyMWJvYXJkLFwicGxheWVyXCIpO1xuICBkb00ucmVuZGVyQm9hcmQocGxheWVyMmJvYXJkLCBcImNvbXB1dGVyXCIpO1xuXG5cbiAgcGxhY2VzaGlwcyhcInBsYXllclwiLHBsYXllcmJvYXJkKTtcbiAgcGxhY2VzaGlwcyhcImNvbXB1dGVyXCIsY29tcGJvYXJkKTtcblxuIGNvbnNvbGUubG9nKGNvbXBib2FyZC5nZXRTaGlwcygpKVxuICBsZXQgcHJldmlvdXNBdHRhY2sgPSBuZXcgU2V0KCk7IC8vdG8gcHJldmVudCB0aGUgY29tcCBmcm9tIGF0dGFja2luZyB0aGUgc2FtZSBpbmRleCB0d2ljZVxuICBsZXQgY3VycmVudFBsYXllciA9IHBsYXllcjE7XG4gIGxldCBnYW1lT3ZlciA9IGZhbHNlO1xuICBsZXQgcHJldmlvdXNIaXRzID0gW107XG4gIGxldCBsZWZ0ID0gbnVsbDtcbiAgbGV0IHJpZ2h0ID0gbnVsbDtcblxuICBcbiAgcGxheWVyMmJvYXJkLmFkZEV2ZW50TGlzdGVuZXIoXCJjbGlja1wiLCAoZSkgPT4ge1xuICAgIGNvbnN0IGlzdmFsaWRjbGljayA9IGNoZWNrRG91YmxlKGUpO1xuICAgIGlmKGlzdmFsaWRjbGljayl7XG4gICAgICBpZiAoY3VycmVudFBsYXllciAhPT0gcGxheWVyMSB8fCBnYW1lT3Zlcikge1xuICAgICAgICByZXR1cm47XG4gICAgICB9XG4gICAgICBoYW5kbGVDbGljayhlKTtcbiAgICAgIGNoZWNrZ2FtZU92ZXIoKTtcbiAgICAgIGN1cnJlbnRQbGF5ZXIgPSBzd2l0Y2hQbGF5ZXIoKTtcbiAgICAgIHNldFRpbWVvdXQoY29tcHV0ZXJUdXJuLCAxMDApO1xuICAgIH1cbiAgICBcbiAgfSk7XG4gIFxuICBmdW5jdGlvbiBjaGVja0RvdWJsZShlKXtcbiAgICBjb25zdCBjZWxsaW5kZXggPSBlLnRhcmdldC5kYXRhc2V0LmluZGV4O1xuICAgIGlmKGNsaWNrZWRDZWxscy5pbmNsdWRlcyhjZWxsaW5kZXgpKXtcbiAgICAgIHJldHVybiBmYWxzZTtcbiAgICB9XG4gICAgY2xpY2tlZENlbGxzLnB1c2goY2VsbGluZGV4KTtcbiAgICByZXR1cm4gdHJ1ZTtcbiAgfVxuXG4gIGZ1bmN0aW9uIGhhbmRsZUNsaWNrKGV2ZW50KSB7XG4gICAgaWYgKGdhbWVPdmVyKSB7XG4gICAgICByZXR1cm47XG4gICAgfVxuICAgIGNvbnN0IGNlbGxpbmRleCA9IGV2ZW50LnRhcmdldC5kYXRhc2V0LmluZGV4O1xuICAgIGNvbnN0IHJlc3VsdCA9IGNvbXBib2FyZC5yZWNlaXZlQXR0YWNrKGNlbGxpbmRleCk7XG4gICAgaWYgKHJlc3VsdCA9PT0gdHJ1ZSkge1xuICAgICAgZXZlbnQudGFyZ2V0LnN0eWxlLmJhY2tncm91bmRDb2xvciA9IFwiI2Y3MDIwMlwiO1xuICAgIH0gZWxzZSB7XG4gICAgICBldmVudC50YXJnZXQuc3R5bGUuYmFja2dyb3VuZENvbG9yID0gXCIjMDJkOTFiXCI7XG4gICAgfVxuICB9XG4gIGxldCBhdHRhY2tJbmRleDtcblxuICBmdW5jdGlvbiBjb21wdXRlclR1cm4oKSB7XG4gICAgLy8gaWYocHJldmlvdXNIaXRzLmxlbmd0aCA+IDApe1xuICAgIGlmKGxlZnQhPW51bGwgfHwgcmlnaHQhPW51bGwpe1xuICAgICAgLy8gY29uc3QgbGFzdEF0dGFjayA9IHByZXZpb3VzSGl0c1twcmV2aW91c0hpdHMubGVuZ3RoIC0gMV07XG4gICAgICAvLyBjb25zdCBsYXN0QWRqYWNlbnRJbmRleCA9IGdldEFkamFjZW50SW5kZXgobGFzdEF0dGFjayk7XG4gICAgICAvLyBjb25zb2xlLmxvZyhsYXN0QWRqYWNlbnRJbmRleCk7XG4gICAgICAvLyBmb3IoY29uc3QgaW5kZXggb2YgbGFzdEFkamFjZW50SW5kZXgpe1xuICAgICAgLy8gICBpZighcHJldmlvdXNBdHRhY2suaGFzKGluZGV4KSl7XG4gICAgICAvLyAgICAgYXR0YWNrSW5kZXggPSBpbmRleDtcbiAgICAgIC8vICAgICBicmVhaztcbiAgICAgIC8vICAgfVxuICAgICAgLy8gfVxuICAgICAgcHJldmlvdXNIaXRzLnBvcCgpOyBcbiAgICAgIGlmKGxlZnQgIT0gbnVsbCl7XG4gICAgICAgIGF0dGFja0luZGV4ID0gbGVmdFxuICAgICAgICBsZWZ0ID0gbGVmdCAtIDFcbiAgICAgIH1cbiAgICAgIGVsc2UgaWYocmlnaHQgIT0gbnVsbCl7XG4gICAgICAgIGF0dGFja0luZGV4ID0gcmlnaHRcbiAgICAgICAgcmlnaHQgPSByaWdodCArIDFcbiAgICAgIH1cbiAgICB9XG4gICAgZWxzZXtcbiAgICAgIGF0dGFja0luZGV4ID0gcmFuZG9tQXR0YWNrKCk7XG4gICAgfVxuICAgIFxuICAgIGNvbXB1dGVyQUkoYXR0YWNrSW5kZXgpO1xuICB9XG5cbiAgZnVuY3Rpb24gcmFuZG9tQXR0YWNrKCl7XG4gICAgbGV0IHggPSBNYXRoLmZsb29yKE1hdGgucmFuZG9tKCkgKiAxMDApO1xuICAgIHdoaWxlKHByZXZpb3VzQXR0YWNrLmhhcyh4KSl7XG4gICAgICB4ID0gTWF0aC5mbG9vcihNYXRoLnJhbmRvbSgpICogMTAwKTtcbiAgICB9XG4gICAgaWYocHJldmlvdXNBdHRhY2suaGFzKHgpKXtcbiAgICAgIHJhbmRvbUF0dGFjaygpXG4gICAgfVxuICAgIHJldHVybiB4O1xuICB9XG4gIFxuICBmdW5jdGlvbiBjb21wdXRlckFJKGkpe1xuICAgIGlmIChnYW1lT3Zlcikge1xuICAgICAgcmV0dXJuO1xuICAgIH1cbiAgICBjb25zdCBjb21waGl0ID0gcGxheWVyYm9hcmQucmVjZWl2ZUF0dGFjayhpKTtcbiAgICBjb25zdCBjZWxsID0gcGxheWVyMWJvYXJkLnF1ZXJ5U2VsZWN0b3IoYFtkYXRhLWluZGV4PScke2l9J11gKTtcbiAgICBpZiAoY29tcGhpdCA9PT0gdHJ1ZSkge1xuICAgICAgY2VsbC5zdHlsZS5iYWNrZ3JvdW5kQ29sb3IgPSBcIiNmNzAyMDJcIjtcbiAgICAgIHByZXZpb3VzSGl0cy5wdXNoKGkpO1xuICAgICAgaWYobGVmdCA9PT0gbnVsbCl7XG4gICAgICAgIGxlZnQgPSBpIC0gMVxuICAgICAgfVxuICAgICAgaWYgKHByZXZpb3VzQXR0YWNrLmhhcyhsZWZ0KSl7XG4gICAgICAgIGxlZnQgPSBudWxsXG4gICAgICB9XG4gICAgICBpZihyaWdodCA9PT0gbnVsbCl7XG4gICAgICAgIHJpZ2h0ID0gaSArIDFcbiAgICAgIH1cbiAgICAgIGlmIChwcmV2aW91c0F0dGFjay5oYXMocmlnaHQpKXtcbiAgICAgICAgcmlnaHQgPSBudWxsXG4gICAgICB9XG5cbiAgICAgIC8vIGNvbnNvbGUubG9nKHByZXZpb3VzSGl0cyk7XG4gICAgfSBlbHNlIHtcbiAgICAgIGNlbGwuc3R5bGUuYmFja2dyb3VuZENvbG9yID0gXCIjMDJkOTFiXCI7XG4gICAgICBpZihsZWZ0ICE9IG51bGwpXG4gICAgICAgIGxlZnQgPSBudWxsXG4gICAgICBlbHNlXG4gICAgICAgIHJpZ2h0ID0gbnVsbFxuICAgIH1cbiAgICBwcmV2aW91c0F0dGFjay5hZGQoaSk7XG4gICAgY2hlY2tnYW1lT3ZlcigpO1xuICAgIGN1cnJlbnRQbGF5ZXIgPSBzd2l0Y2hQbGF5ZXIoKTtcbiAgfVxuXG4gIGZ1bmN0aW9uIGdldEFkamFjZW50SW5kZXgoaW5kZXgpe1xuICAgIGNvbnN0IGFkamFjZW50SW5kZXhlcyA9IFtdO1xuICAgIGNvbnN0IGNvbCA9IGluZGV4ICUgMTA7XG4gICAgaWYoY29sID4gMCl7XG4gICAgICBhZGphY2VudEluZGV4ZXMucHVzaChpbmRleCAtIDEpO1xuICAgIH1cbiAgICBpZihjb2wgPCA5KXtcbiAgICAgIGFkamFjZW50SW5kZXhlcy5wdXNoKGluZGV4ICsgMSk7XG4gICAgfVxuICAgIHJldHVybiBhZGphY2VudEluZGV4ZXM7XG4gIH1cblxuXG4gIGZ1bmN0aW9uIHN3aXRjaFBsYXllcigpIHtcbiAgICByZXR1cm4gKGN1cnJlbnRQbGF5ZXIgPSBjdXJyZW50UGxheWVyID09PSBwbGF5ZXIxID8gcGxheWVyMiA6IHBsYXllcjEpO1xuICB9XG5cbiAgZnVuY3Rpb24gY2hlY2tnYW1lT3ZlcigpIHtcbiAgICBpZiAocGxheWVyYm9hcmQuYWxsU2hpcHNTdW5rKCkpIHtcbiAgICAgIGdhbWVPdmVyID0gdHJ1ZTtcbiAgICAgIGRvY3VtZW50LmdldEVsZW1lbnRCeUlkKCd3aW5uZXInKS5pbm5lclRleHQgPSBcIkNvbXB1dGVyIFdpbiFcIjtcbiAgICAgIHBsYXllcjJib2FyZC5yZW1vdmVFdmVudExpc3RlbmVyKFwiY2xpY2tcIiwgaGFuZGxlQ2xpY2spO1xuICAgICAgcmV0dXJuO1xuICAgIH1cbiAgICBpZiAoY29tcGJvYXJkLmFsbFNoaXBzU3VuaygpKSB7XG4gICAgICBnYW1lT3ZlciA9IHRydWU7XG4gICAgICBkb2N1bWVudC5nZXRFbGVtZW50QnlJZCgnd2lubmVyJykuaW5uZXJUZXh0ID0gXCJZb3UgV2luIVwiO1xuICAgICAgcmV0dXJuO1xuICAgIH1cbiAgfVxufVxuXG5leHBvcnQgZGVmYXVsdCBnYW1lTG9vcDtcbiIsImltcG9ydCBkb00gZnJvbSBcIi4vRE9NXCI7XG5pbXBvcnQgUGxheWVyIGZyb20gXCIuL3BsYXllclwiO1xuaW1wb3J0IEdhbWVib2FyZCBmcm9tIFwiLi9nYW1lYm9hcmRcIjtcbmltcG9ydCBTaGlwIGZyb20gXCIuL3NoaXBcIjtcbmltcG9ydCBnYW1lTG9vcCBmcm9tIFwiLi9nYW1lbG9vcFwiO1xuXG5cbmdhbWVMb29wKHtuYW1lOiBcIlBsYXllclwifSwge25hbWU6IFwiQ29tcHV0ZXJcIn0pO1xuIl0sIm5hbWVzIjpbImJvYXJkRWxlbWVudCIsImhvbGRlciIsImlubmVySFRNTCIsImkiLCJjZWxsIiwiZG9jdW1lbnQiLCJjcmVhdGVFbGVtZW50IiwiZGF0YXNldCIsImluZGV4IiwiY2xhc3NMaXN0IiwiYWRkIiwiYXBwZW5kQ2hpbGQiLCJib2FyZCIsIkFycmF5IiwiZmlsbCIsInNoaXBzIiwibWlzc2VkQXR0YWNrcyIsImdldFNoaXBzIiwibGVuZ3RoIiwiZ2V0Qm9hcmQiLCJwbGFjZVNoaXAiLCJzaGlwIiwic2hpcGxlbmd0aCIsImNvb3JkaW5hdGVzIiwicHVzaCIsImZvckVhY2giLCJjb29yZCIsInJlY2VpdmVBdHRhY2siLCJoaXQiLCJhbGxTaGlwc1N1bmsiLCJldmVyeSIsImlzU3VuayIsImhpdHMiLCJwbGFjZXNoaXBzIiwicGxheWVyYm9hcmQiLCJzaGlwc0xlbmd0aCIsInNoaXBzbGVuIiwiY2VsbHMiLCJxdWVyeVNlbGVjdG9yQWxsIiwiZ2FtZSIsInR1cm4iLCJnZXRFbGVtZW50QnlJZCIsImFkZEV2ZW50TGlzdGVuZXIiLCJldmVudCIsInRhcmdldCIsInBhcnNlSW50IiwiY2FuUGxhY2VTaGlwIiwic3RhcnRJbmRleCIsImNoZWNrU2hpcFBsYWNlbWVudCIsIm5vT3ZlcmxhcCIsImNoZWNrT3ZlcmxhcCIsImlubmVyVGV4dCIsImsiLCJxdWVyeVNlbGVjdG9yIiwic3R5bGUiLCJiYWNrZ3JvdW5kQ29sb3IiLCJNYXRoIiwiZmxvb3IiLCJyYW5kb20iLCJsYXN0Q2VsbEluZGV4IiwiaW5kZXhyb3ciLCJwbGF5ZXIxIiwicGxheWVyMiIsImNvbXBib2FyZCIsImNsaWNrZWRDZWxscyIsInBsYXllcjFib2FyZCIsInBsYXllcjJib2FyZCIsImNvbnNvbGUiLCJsb2ciLCJhdHRhY2tJbmRleCIsInByZXZpb3VzQXR0YWNrIiwiU2V0IiwiY3VycmVudFBsYXllciIsImdhbWVPdmVyIiwicHJldmlvdXNIaXRzIiwibGVmdCIsInJpZ2h0IiwiaGFuZGxlQ2xpY2siLCJjZWxsaW5kZXgiLCJyZXN1bHQiLCJjb21wdXRlclR1cm4iLCJwb3AiLCJyYW5kb21BdHRhY2siLCJjb21waGl0IiwiaGFzIiwiY2hlY2tnYW1lT3ZlciIsInN3aXRjaFBsYXllciIsImNvbXB1dGVyQUkiLCJ4IiwicmVtb3ZlRXZlbnRMaXN0ZW5lciIsImUiLCJpc3ZhbGlkY2xpY2siLCJpbmNsdWRlcyIsImNoZWNrRG91YmxlIiwic2V0VGltZW91dCIsIm5hbWUiXSwic291cmNlUm9vdCI6IiJ9