(()=>{"use strict";const t=function(t,e){t.innerHTML="";for(let n=0;n<100;n++){const l=document.createElement("div");l.dataset.index=n,"player"==e?(l.classList.add("cell"),l.classList.add(`h${n}`)):"computer"==e&&(l.classList.add("enemycell"),l.classList.add(`e${n}`)),t.appendChild(l)}},e=function(){let t=Array(100).fill(null),e=[],n=[];return{getShips:function(){return e.length},getBoard:function(){return t},placeShip:function(n,l){let r=n.length,o=[];for(let t=0;t<r;t++)o.push(l+t);o.forEach((e=>{t[e]=n})),e.push(n)},receiveAttack:function(e){return null===t[e]?(n.push(e),!1):(t[e].hit(),!0)},allShipsSunk:function(){return e.every((t=>t.isSunk()))},missedAttacks:n}},n=function(t){let e=0;return{length:t,hit:()=>(e++,e),isSunk:()=>e===t,get hits(){return e}}};function l(t,e){if("player"===t){const t=[5,4,3,2];let l=t.length;const o=document.querySelectorAll(".cell");let u=!0,c=0;const i=document.getElementById("turn");return u&&o.forEach((o=>{o.addEventListener("click",(o=>{const a=o.target,s=parseInt(a.dataset.index),d=function(t,e,n){const l=t.getBoard();for(let t=0;t<n;t++)if(null!==l[e+t])return!1;return!0}(e,s,t[c]),f=r(s,t[c]);if(i.innerText=0==c?"Place your Submarine":1==c?"Place your Attackerr":2==c?"Place your Ship":"Play",d&&f){const r=n(t[c]);e.placeShip(r,s);for(let e=0;e<t[c];e++)document.querySelector(`.h${s+e}`).style.backgroundColor="#292828";c++,c===l&&(u=!1)}}))})),!0}if("computer"===t){const t=[5,4,3,2];let l=t.length,o=0;for(;o<l;){let l=n(t[o]),u=Math.floor(100*Math.random());r(u,t[o])&&(e.placeShip(l,u),o++)}}}function r(t,e){let n=t+e-1,l=Math.floor(t/10);return!(Math.floor(n/10)>l)}!function(n,r){let o,u;u=e(),o=e();const c=[],i=document.getElementById("playerboard"),a=document.getElementById("compboard");t(i,"player"),t(a,"computer"),l("computer",o);let s=!1;s=l("player",u),console.log(o.getShips());let d,f=new Set,h=n,m=!1;function p(t){if(m)return;const e=t.target.dataset.index,n=o.receiveAttack(e);t.target.style.backgroundColor=!0===n?"#f70202":"#02d91b"}a.addEventListener("click",(t=>{if(s){const e=function(t){const e=t.target.dataset.index;return!c.includes(e)&&(c.push(e),!0)}(t);if(e){if(h!==n||m)return;p(t),v(),h=k(),setTimeout(S,100)}}}));let y,g=null;function S(){null!=y||null!=g?null!=y?(d=y,y-=1):null!=g&&(d=g,g+=1):d=function(){let t=Math.floor(100*Math.random());for(;f.has(t);)t=Math.floor(100*Math.random());return t}(),function(t){if(m)return;const e=u.receiveAttack(t),n=i.querySelector(`[data-index='${t}']`);!0===e?(n.style.backgroundColor="#f70202",null==y&&(y=t-1),f.has(y)&&(y=null),null==g&&(g=t+1),f.has(g)&&(g=null)):(n.style.backgroundColor="#02d91b",null!=y?y=null:g=null),f.add(t),v(),h=k()}(d)}function k(){return h=h===n?r:n}function v(){return u.allShipsSunk()?(m=!0,document.getElementById("winner").innerText="Computer Win!",void a.removeEventListener("click",p)):o.allShipsSunk()?(m=!0,void(document.getElementById("winner").innerText="You Win!")):void 0}}({name:"Player"},{name:"Computer"})})();
//# sourceMappingURL=data:application/json;charset=utf-8;base64,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QixFQUFlN0QsSUFBSVAsR0FDbkIrRSxJQUNBVCxFQUFnQlUsR0FDbEIsQ0EzQ0VTLENBQVd0QixFQUNiLENBNENBLFNBQVNhLElBQ1AsT0FBUVYsRUFBZ0JBLElBQWtCWixFQUFVQyxFQUFVRCxDQUNoRSxDQUVBLFNBQVNxQixJQUNQLE9BQUloRCxFQUFZTCxnQkFDZDZDLEdBQVcsRUFDWHJFLFNBQVNvQyxlQUFlLFVBQVVVLFVBQVkscUJBQzlDZSxFQUFhMkIsb0JBQW9CLFFBQVNsQixJQUd4Q1osRUFBVWxDLGdCQUNaNkMsR0FBVyxPQUNYckUsU0FBU29DLGVBQWUsVUFBVVUsVUFBWSxrQkFGaEQsQ0FLRixDQUNGLENDeElBLENBQVMsQ0FBQzJDLEtBQU0sVUFBVyxDQUFDQSxLQUFNLFkiLCJzb3VyY2VzIjpbIndlYnBhY2s6Ly90aGUtYmF0dGxlc2hpcC8uL3NjcmlwdC9ET00uanMiLCJ3ZWJwYWNrOi8vdGhlLWJhdHRsZXNoaXAvLi9zY3JpcHQvZ2FtZWJvYXJkLmpzIiwid2VicGFjazovL3RoZS1iYXR0bGVzaGlwLy4vc2NyaXB0L3NoaXAuanMiLCJ3ZWJwYWNrOi8vdGhlLWJhdHRsZXNoaXAvLi9zY3JpcHQvcGxhY2VzaGlwcy5qcyIsIndlYnBhY2s6Ly90aGUtYmF0dGxlc2hpcC8uL3NjcmlwdC9nYW1lbG9vcC5qcyIsIndlYnBhY2s6Ly90aGUtYmF0dGxlc2hpcC8uL3NjcmlwdC9pbmRleC5qcyJdLCJzb3VyY2VzQ29udGVudCI6WyJjb25zdCBkb00gPSAoKCk9PntcclxuICAgIGZ1bmN0aW9uIHJlbmRlckJvYXJkKGJvYXJkRWxlbWVudCwgaG9sZGVyKSB7XHJcbiAgICAgICAgYm9hcmRFbGVtZW50LmlubmVySFRNTCA9ICcnO1xyXG4gICAgICAgIGZvciAobGV0IGkgPSAwOyBpIDwgMTAwOyBpKyspIHtcclxuICAgICAgICAgICAgY29uc3QgY2VsbCA9IGRvY3VtZW50LmNyZWF0ZUVsZW1lbnQoJ2RpdicpO1xyXG4gICAgICAgICAgICBjZWxsLmRhdGFzZXQuaW5kZXggPSBpO1xyXG4gICAgICAgICAgICBpZihob2xkZXIgPT0gXCJwbGF5ZXJcIil7XHJcbiAgICAgICAgICAgICAgICBjZWxsLmNsYXNzTGlzdC5hZGQoJ2NlbGwnKTtcclxuICAgICAgICAgICAgICAgIGNlbGwuY2xhc3NMaXN0LmFkZChgaCR7aX1gKTtcclxuICAgICAgICAgICAgfVxyXG4gICAgICAgICAgICBlbHNlIGlmKGhvbGRlciA9PSBcImNvbXB1dGVyXCIpe1xyXG4gICAgICAgICAgICAgICAgY2VsbC5jbGFzc0xpc3QuYWRkKCdlbmVteWNlbGwnKTtcclxuICAgICAgICAgICAgICAgIGNlbGwuY2xhc3NMaXN0LmFkZChgZSR7aX1gKTtcclxuICAgICAgICAgICAgfVxyXG4gICAgICAgICAgICBib2FyZEVsZW1lbnQuYXBwZW5kQ2hpbGQoY2VsbCk7XHJcbiAgICAgICAgfVxyXG4gICAgfTtcclxuXHJcbiAgICByZXR1cm4ge1xyXG4gICAgICAgIHJlbmRlckJvYXJkXHJcbiAgICB9XHJcbn0pKCk7XHJcblxyXG5cclxuZXhwb3J0IGRlZmF1bHQgZG9NIiwiaW1wb3J0IFNoaXAgZnJvbSBcIi4vc2hpcFwiO1xyXG5mdW5jdGlvbiBHYW1lYm9hcmQoKSB7XHJcbiAgbGV0IGJvYXJkID0gQXJyYXkoMTAwKS5maWxsKG51bGwpO1xyXG4gIGxldCBzaGlwcyA9IFtdO1xyXG4gIGxldCBtaXNzZWRBdHRhY2tzID0gW107XHJcblxyXG5cclxuICBmdW5jdGlvbiBwbGFjZVNoaXAoc2hpcCxpbmRleCkge1xyXG4gICAgbGV0IHNoaXBsZW5ndGggPSBzaGlwLmxlbmd0aDtcclxuICAgIGxldCBjb29yZGluYXRlcyA9IFtdO1xyXG4gICAgZm9yKGxldCBpPTA7aTxzaGlwbGVuZ3RoO2krKyl7XHJcbiAgICAgIGNvb3JkaW5hdGVzLnB1c2goaW5kZXgraSk7XHJcbiAgICB9XHJcbiAgICBjb29yZGluYXRlcy5mb3JFYWNoKGNvb3JkID0+IHtcclxuICAgICAgYm9hcmRbY29vcmRdID0gc2hpcDtcclxuICAgIH0pO1xyXG4gICAgc2hpcHMucHVzaChzaGlwKTtcclxuXHJcbiAgfVxyXG4gIFxyXG4gIGZ1bmN0aW9uIHJlY2VpdmVBdHRhY2soY29vcmRpbmF0ZXMpIHtcclxuICAgIGlmIChib2FyZFtjb29yZGluYXRlc10gPT09IG51bGwpIHtcclxuICAgICAgbWlzc2VkQXR0YWNrcy5wdXNoKGNvb3JkaW5hdGVzKTtcclxuICAgICAgcmV0dXJuIGZhbHNlO1xyXG4gICAgfVxyXG4gICAgY29uc3QgaGl0U2hpcCA9IGJvYXJkW2Nvb3JkaW5hdGVzXTtcclxuICAgIGhpdFNoaXAuaGl0KCk7XHJcbiAgICByZXR1cm4gdHJ1ZTtcclxuICB9XHJcblxyXG4gIGZ1bmN0aW9uIGFsbFNoaXBzU3VuaygpIHtcclxuICAgIHJldHVybiBzaGlwcy5ldmVyeShzaGlwID0+IHNoaXAuaXNTdW5rKCkpO1xyXG4gIH1cclxuICBmdW5jdGlvbiBnZXRCb2FyZCgpe1xyXG4gICAgcmV0dXJuIGJvYXJkO1xyXG4gIH1cclxuICBmdW5jdGlvbiBnZXRTaGlwcygpe1xyXG4gICAgcmV0dXJuIHNoaXBzLmxlbmd0aDtcclxuICB9XHJcbiAgcmV0dXJuIHtcclxuICAgIGdldFNoaXBzLFxyXG4gICAgZ2V0Qm9hcmQsXHJcbiAgICBwbGFjZVNoaXAsXHJcbiAgICByZWNlaXZlQXR0YWNrLFxyXG4gICAgYWxsU2hpcHNTdW5rLFxyXG4gICAgbWlzc2VkQXR0YWNrcyxcclxuICB9O1xyXG59XHJcblxyXG5leHBvcnQgZGVmYXVsdCBHYW1lYm9hcmQ7IiwiZnVuY3Rpb24gU2hpcChsZW5ndGgpIHtcclxuICBsZXQgaGl0cyA9IDA7XHJcblxyXG4gIHJldHVybiB7XHJcbiAgICBsZW5ndGg6IGxlbmd0aCxcclxuICAgIGhpdCgpIHtcclxuICAgICAgaGl0cysrXHJcbiAgICAgIHJldHVybiBoaXRzO1xyXG4gICAgfSxcclxuICAgIGlzU3VuaygpIHtcclxuICAgICAgcmV0dXJuIGhpdHMgPT09IGxlbmd0aDtcclxuICAgIH0sXHJcbiAgICBnZXQgaGl0cygpe1xyXG4gICAgICByZXR1cm4gaGl0cztcclxuICAgIH1cclxuICB9O1xyXG59XHJcbmV4cG9ydCBkZWZhdWx0IFNoaXA7IiwiaW1wb3J0IFNoaXAgZnJvbSBcIi4vc2hpcFwiO1xyXG5pbXBvcnQgR2FtZWJvYXJkIGZyb20gXCIuL2dhbWVib2FyZFwiO1xyXG5cclxuZnVuY3Rpb24gcGxhY2VzaGlwcyhob2xkZXIsIHBsYXllcmJvYXJkKSB7XHJcbiAgaWYgKGhvbGRlciA9PT0gXCJwbGF5ZXJcIikge1xyXG4gICAgY29uc3Qgc2hpcHNMZW5ndGggPSBbNSwgNCwgMywgMl07XHJcbiAgICBsZXQgc2hpcHNsZW4gPSBzaGlwc0xlbmd0aC5sZW5ndGg7XHJcbiAgICBjb25zdCBjZWxscyA9IGRvY3VtZW50LnF1ZXJ5U2VsZWN0b3JBbGwoJy5jZWxsJyk7XHJcbiAgICBsZXQgZ2FtZSA9IHRydWU7XHJcbiAgICBsZXQgaSA9IDA7XHJcbiAgICBjb25zdCB0dXJuID0gZG9jdW1lbnQuZ2V0RWxlbWVudEJ5SWQoJ3R1cm4nKTtcclxuICAgIGlmIChnYW1lKSB7XHJcbiAgICAgIGNlbGxzLmZvckVhY2goY2VsbCA9PiB7XHJcbiAgICAgICAgY2VsbC5hZGRFdmVudExpc3RlbmVyKCdjbGljaycsIChldmVudCkgPT4ge1xyXG4gICAgICAgICAgY29uc3QgY2VsbCA9IGV2ZW50LnRhcmdldDtcclxuICAgICAgICAgIGNvbnN0IGluZGV4ID0gcGFyc2VJbnQoY2VsbC5kYXRhc2V0LmluZGV4KTtcclxuICAgICAgICAgIGNvbnN0IGNhblBsYWNlU2hpcCA9IGNoZWNrU2hpcFBsYWNlbWVudChwbGF5ZXJib2FyZCwgaW5kZXgsIHNoaXBzTGVuZ3RoW2ldKTtcclxuICAgICAgICAgIGNvbnN0IG5vT3ZlcmxhcCA9IGNoZWNrT3ZlcmxhcChpbmRleCwgc2hpcHNMZW5ndGhbaV0pO1xyXG4gICAgICAgICAgaWYoaSA9PTApe1xyXG4gICAgICAgICAgICB0dXJuLmlubmVyVGV4dCA9IFwiUGxhY2UgeW91ciBTdWJtYXJpbmVcIjtcclxuICAgICAgICAgIH1cclxuICAgICAgICAgIGVsc2UgaWYoaT09MSl7XHJcbiAgICAgICAgICAgIHR1cm4uaW5uZXJUZXh0ID0gXCJQbGFjZSB5b3VyIEF0dGFja2VyclwiO1xyXG4gICAgICAgICAgfVxyXG4gICAgICAgICAgZWxzZSBpZihpPT0yKXtcclxuICAgICAgICAgICAgdHVybi5pbm5lclRleHQgPSBcIlBsYWNlIHlvdXIgU2hpcFwiO1xyXG4gICAgICAgICAgfVxyXG4gICAgICAgICAgZWxzZXtcclxuICAgICAgICAgICAgdHVybi5pbm5lclRleHQgPSBcIlBsYXlcIjtcclxuICAgICAgICAgIH1cclxuICAgICAgICAgIGlmIChjYW5QbGFjZVNoaXAgJiYgbm9PdmVybGFwKSB7XHJcbiAgICAgICAgICAgIGNvbnN0IHNoaXAgPSBTaGlwKHNoaXBzTGVuZ3RoW2ldKTtcclxuICAgICAgICAgICAgcGxheWVyYm9hcmQucGxhY2VTaGlwKHNoaXAsIGluZGV4KTsgIFxyXG4gICAgICAgICAgICBmb3IgKGxldCBrID0gMDsgayA8IHNoaXBzTGVuZ3RoW2ldOyBrKyspIHtcclxuICAgICAgICAgICAgICBkb2N1bWVudC5xdWVyeVNlbGVjdG9yKGAuaCR7aW5kZXggKyBrfWApLnN0eWxlLmJhY2tncm91bmRDb2xvciA9IFwiIzI5MjgyOFwiO1xyXG4gICAgICAgICAgICB9XHJcbiAgICAgICAgICAgIGkrKztcclxuICAgICAgICAgICAgaWYgKGkgPT09IHNoaXBzbGVuKSB7XHJcbiAgICAgICAgICAgICAgZ2FtZSA9IGZhbHNlO1xyXG4gICAgICAgICAgICB9XHJcbiAgICAgICAgICB9XHJcbiAgICAgICAgfSk7XHJcbiAgICAgIH0pO1xyXG4gICAgfVxyXG4gICAgcmV0dXJuIHRydWU7XHJcbiAgfSBlbHNlIGlmIChob2xkZXIgPT09IFwiY29tcHV0ZXJcIikge1xyXG4gICAgY29uc3Qgc2hpcHNMZW5ndGggPSBbNSwgNCwgMywgMl07XHJcbiAgICBsZXQgc2hpcHNsZW4gPSBzaGlwc0xlbmd0aC5sZW5ndGg7XHJcbiAgICBsZXQgaSA9IDA7XHJcbiAgICBcclxuICAgIHdoaWxlIChpIDwgc2hpcHNsZW4pIHtcclxuICAgICAgbGV0IHNoaXAgPSBTaGlwKHNoaXBzTGVuZ3RoW2ldKTtcclxuICAgICAgbGV0IGluZGV4ID0gTWF0aC5mbG9vcihNYXRoLnJhbmRvbSgpICogMTAwKTtcclxuICAgICAgY29uc3Qgbm9PdmVybGFwID0gY2hlY2tPdmVybGFwKGluZGV4LCBzaGlwc0xlbmd0aFtpXSk7XHJcblxyXG4gICAgICBpZiAoIW5vT3ZlcmxhcCkgeyAvLyBDaGVjayBpZiB0aGUgc2hpcCBpcyBvdmVybGFwcGluZ1xyXG4gICAgICAgIGNvbnRpbnVlO1xyXG4gICAgICB9IFxyXG4gICAgICBwbGF5ZXJib2FyZC5wbGFjZVNoaXAoc2hpcCwgaW5kZXgpO1xyXG4gICAgICBpKys7IFxyXG4gICAgfSAgICAgXHJcbiAgfVxyXG59XHJcblxyXG5mdW5jdGlvbiBjaGVja092ZXJsYXAoc3RhcnRJbmRleCwgbGVuZ3RoKSB7XHJcbiAgbGV0IGxhc3RDZWxsSW5kZXggPSBzdGFydEluZGV4ICsgbGVuZ3RoIC0gMTtcclxuICBsZXQgaW5kZXhyb3cgPSBNYXRoLmZsb29yKHN0YXJ0SW5kZXggLyAxMCk7XHJcbiAgbGV0IGxhc3Ryb3cgPSBNYXRoLmZsb29yKGxhc3RDZWxsSW5kZXggLyAxMCk7XHJcbiAgXHJcbiAgaWYgKGxhc3Ryb3cgPiBpbmRleHJvdykge1xyXG4gICAgcmV0dXJuIGZhbHNlO1xyXG4gIH1cclxuICBcclxuICByZXR1cm4gdHJ1ZTtcclxufVxyXG5cclxuZnVuY3Rpb24gY2hlY2tTaGlwUGxhY2VtZW50KHBsYXllcmJvYXJkLCBzdGFydEluZGV4LCBsZW5ndGgpIHtcclxuICBjb25zdCBib2FyZCA9IHBsYXllcmJvYXJkLmdldEJvYXJkKCk7XHJcbiAgZm9yIChsZXQgaSA9IDA7IGkgPCBsZW5ndGg7IGkrKykge1xyXG4gICAgY29uc3QgaW5kaWNlcyA9IHN0YXJ0SW5kZXggKyBpO1xyXG5cclxuICAgIGlmIChib2FyZFtpbmRpY2VzXSAhPT0gbnVsbCkge1xyXG4gICAgICByZXR1cm4gZmFsc2U7XHJcbiAgICB9XHJcbiAgfVxyXG4gIFxyXG4gIHJldHVybiB0cnVlO1xyXG59XHJcblxyXG5leHBvcnQgeyBwbGFjZXNoaXBzIH07XHJcbiIsImltcG9ydCBHYW1lYm9hcmQgZnJvbSBcIi4vZ2FtZWJvYXJkXCI7XHJcbmltcG9ydCBkb00gZnJvbSBcIi4vRE9NXCI7XHJcbmltcG9ydCB7IHBsYWNlc2hpcHMgfSBmcm9tIFwiLi9wbGFjZXNoaXBzXCI7XHJcblxyXG5mdW5jdGlvbiBnYW1lTG9vcChwbGF5ZXIxLCBwbGF5ZXIyKSB7XHJcbiAgbGV0IGNvbXBib2FyZCwgcGxheWVyYm9hcmQ7XHJcbiAgcGxheWVyYm9hcmQgPSBHYW1lYm9hcmQoKTtcclxuICBjb21wYm9hcmQgPSBHYW1lYm9hcmQoKTtcclxuICBjb25zdCBjbGlja2VkQ2VsbHMgPSBbXTtcclxuICBjb25zdCBwbGF5ZXIxYm9hcmQgPSBkb2N1bWVudC5nZXRFbGVtZW50QnlJZChcInBsYXllcmJvYXJkXCIpO1xyXG4gIGNvbnN0IHBsYXllcjJib2FyZCA9IGRvY3VtZW50LmdldEVsZW1lbnRCeUlkKFwiY29tcGJvYXJkXCIpO1xyXG4gIGRvTS5yZW5kZXJCb2FyZChwbGF5ZXIxYm9hcmQsIFwicGxheWVyXCIpO1xyXG4gIGRvTS5yZW5kZXJCb2FyZChwbGF5ZXIyYm9hcmQsIFwiY29tcHV0ZXJcIik7XHJcblxyXG5cclxuICBwbGFjZXNoaXBzKFwiY29tcHV0ZXJcIiwgY29tcGJvYXJkKTtcclxuXHJcbiAgbGV0IHNoaXBQbGFjZWQgPSBmYWxzZTtcclxuICBzaGlwUGxhY2VkID0gcGxhY2VzaGlwcyhcInBsYXllclwiLCBwbGF5ZXJib2FyZClcclxuXHJcbiAgY29uc29sZS5sb2coY29tcGJvYXJkLmdldFNoaXBzKCkpO1xyXG4gIGxldCBwcmV2aW91c0F0dGFjayA9IG5ldyBTZXQoKTsgLy90byBwcmV2ZW50IHRoZSBjb21wIGZyb20gYXR0YWNraW5nIHRoZSBzYW1lIGluZGV4IHR3aWNlXHJcbiAgbGV0IGN1cnJlbnRQbGF5ZXIgPSBwbGF5ZXIxO1xyXG4gIGxldCBnYW1lT3ZlciA9IGZhbHNlO1xyXG5cclxuICBcclxuICBwbGF5ZXIyYm9hcmQuYWRkRXZlbnRMaXN0ZW5lcihcImNsaWNrXCIsIChlKSA9PiB7XHJcbiAgICAgIGlmKHNoaXBQbGFjZWQpe1xyXG4gICAgICAgIGNvbnN0IGlzdmFsaWRjbGljayA9IGNoZWNrRG91YmxlKGUpO1xyXG4gICAgICAgIGlmIChpc3ZhbGlkY2xpY2spIHtcclxuICAgICAgICAgIGlmIChjdXJyZW50UGxheWVyICE9PSBwbGF5ZXIxIHx8IGdhbWVPdmVyKSB7XHJcbiAgICAgICAgICAgIHJldHVybjtcclxuICAgICAgICAgIH1cclxuICAgICAgICAgIGhhbmRsZUNsaWNrKGUpO1xyXG4gICAgICAgICAgY2hlY2tnYW1lT3ZlcigpO1xyXG4gICAgICAgICAgY3VycmVudFBsYXllciA9IHN3aXRjaFBsYXllcigpO1xyXG4gICAgICAgICAgc2V0VGltZW91dChjb21wdXRlclR1cm4sIDEwMCk7XHJcbiAgICAgICAgfVxyXG4gICAgICB9XHJcblxyXG4gICAgfSk7XHJcblxyXG5cclxuICBmdW5jdGlvbiBjaGVja0RvdWJsZShlKSB7XHJcbiAgICBjb25zdCBjZWxsaW5kZXggPSBlLnRhcmdldC5kYXRhc2V0LmluZGV4O1xyXG4gICAgaWYgKGNsaWNrZWRDZWxscy5pbmNsdWRlcyhjZWxsaW5kZXgpKSB7XHJcbiAgICAgIHJldHVybiBmYWxzZTtcclxuICAgIH1cclxuICAgIGNsaWNrZWRDZWxscy5wdXNoKGNlbGxpbmRleCk7XHJcbiAgICByZXR1cm4gdHJ1ZTtcclxuICB9XHJcblxyXG4gIGZ1bmN0aW9uIGhhbmRsZUNsaWNrKGV2ZW50KSB7XHJcbiAgICBpZiAoZ2FtZU92ZXIpIHtcclxuICAgICAgcmV0dXJuO1xyXG4gICAgfVxyXG4gICAgY29uc3QgY2VsbGluZGV4ID0gZXZlbnQudGFyZ2V0LmRhdGFzZXQuaW5kZXg7XHJcbiAgICBjb25zdCByZXN1bHQgPSBjb21wYm9hcmQucmVjZWl2ZUF0dGFjayhjZWxsaW5kZXgpO1xyXG4gICAgaWYgKHJlc3VsdCA9PT0gdHJ1ZSkge1xyXG4gICAgICBldmVudC50YXJnZXQuc3R5bGUuYmFja2dyb3VuZENvbG9yID0gXCIjZjcwMjAyXCI7XHJcbiAgICB9IGVsc2Uge1xyXG4gICAgICBldmVudC50YXJnZXQuc3R5bGUuYmFja2dyb3VuZENvbG9yID0gXCIjMDJkOTFiXCI7XHJcbiAgICB9XHJcbiAgfVxyXG5cclxuICBsZXQgYXR0YWNrSW5kZXg7XHJcbiAgbGV0IGxlZnQscmlnaHQgPSBudWxsXHJcbiAgZnVuY3Rpb24gY29tcHV0ZXJUdXJuKCkge1xyXG4gICAgaWYobGVmdCE9IG51bGwgfHwgcmlnaHQhPW51bGwpe1xyXG4gICAgICBpZihsZWZ0IT1udWxsKXtcclxuICAgICAgICBhdHRhY2tJbmRleCA9IGxlZnQ7XHJcbiAgICAgICAgbGVmdCA9IGxlZnQgLTE7XHJcbiAgICAgIH1cclxuICAgICAgIGVsc2UgaWYocmlnaHQhPSBudWxsKXtcclxuICAgICAgICBhdHRhY2tJbmRleCA9IHJpZ2h0O1xyXG4gICAgICAgIHJpZ2h0ID0gcmlnaHQgKyAxO1xyXG4gICAgICB9XHJcbiAgICB9IGVsc2V7XHJcbiAgICAgIGF0dGFja0luZGV4ID0gcmFuZG9tQXR0YWNrKCk7XHJcbiAgICB9XHJcblxyXG4gICAgY29tcHV0ZXJBSShhdHRhY2tJbmRleCk7XHJcbiAgfVxyXG5cclxuICBmdW5jdGlvbiByYW5kb21BdHRhY2soKSB7XHJcbiAgICBsZXQgeCA9IE1hdGguZmxvb3IoTWF0aC5yYW5kb20oKSAqIDEwMCk7XHJcbiAgICB3aGlsZSAocHJldmlvdXNBdHRhY2suaGFzKHgpKSB7XHJcbiAgICAgIHggPSBNYXRoLmZsb29yKE1hdGgucmFuZG9tKCkgKiAxMDApO1xyXG4gICAgfVxyXG4gICAgcmV0dXJuIHg7XHJcbiAgfVxyXG5cclxuICBmdW5jdGlvbiBjb21wdXRlckFJKGkpIHtcclxuICAgIGlmIChnYW1lT3Zlcikge1xyXG4gICAgICByZXR1cm47XHJcbiAgICB9XHJcbiAgICBjb25zdCBjb21waGl0ID0gcGxheWVyYm9hcmQucmVjZWl2ZUF0dGFjayhpKTtcclxuICAgIGNvbnN0IGNlbGwgPSBwbGF5ZXIxYm9hcmQucXVlcnlTZWxlY3RvcihgW2RhdGEtaW5kZXg9JyR7aX0nXWApO1xyXG4gICAgaWYgKGNvbXBoaXQgPT09IHRydWUpIHtcclxuICAgICAgY2VsbC5zdHlsZS5iYWNrZ3JvdW5kQ29sb3IgPSBcIiNmNzAyMDJcIjtcclxuICAgICAgaWYobGVmdCA9PSBudWxsKXtcclxuICAgICAgICBsZWZ0ID0gaSAtIDE7XHJcbiAgICAgIH1cclxuICAgICAgaWYocHJldmlvdXNBdHRhY2suaGFzKGxlZnQpKXtcclxuICAgICAgICBsZWZ0ID0gbnVsbDtcclxuICAgICAgfVxyXG4gICAgICBpZihyaWdodCA9PSBudWxsKXtcclxuICAgICAgICByaWdodCA9IGkgKyAxO1xyXG4gICAgICB9XHJcbiAgICAgIGlmKHByZXZpb3VzQXR0YWNrLmhhcyhyaWdodCkpe1xyXG4gICAgICAgIHJpZ2h0ID0gbnVsbDtcclxuICAgICAgfVxyXG4gICAgfSBlbHNlIHtcclxuICAgICAgY2VsbC5zdHlsZS5iYWNrZ3JvdW5kQ29sb3IgPSBcIiMwMmQ5MWJcIjtcclxuICAgICAgaWYobGVmdCAhPSBudWxsKXtcclxuICAgICAgICBsZWZ0ID0gbnVsbFxyXG4gICAgICB9XHJcbiAgICAgIGVsc2V7XHJcbiAgICAgICAgcmlnaHQgPSBudWxsO1xyXG4gICAgICB9XHJcbiAgICB9XHJcbiAgICBwcmV2aW91c0F0dGFjay5hZGQoaSk7XHJcbiAgICBjaGVja2dhbWVPdmVyKCk7XHJcbiAgICBjdXJyZW50UGxheWVyID0gc3dpdGNoUGxheWVyKCk7XHJcbiAgfVxyXG5cclxuICBmdW5jdGlvbiBzd2l0Y2hQbGF5ZXIoKSB7XHJcbiAgICByZXR1cm4gKGN1cnJlbnRQbGF5ZXIgPSBjdXJyZW50UGxheWVyID09PSBwbGF5ZXIxID8gcGxheWVyMiA6IHBsYXllcjEpO1xyXG4gIH1cclxuXHJcbiAgZnVuY3Rpb24gY2hlY2tnYW1lT3ZlcigpIHtcclxuICAgIGlmIChwbGF5ZXJib2FyZC5hbGxTaGlwc1N1bmsoKSkge1xyXG4gICAgICBnYW1lT3ZlciA9IHRydWU7XHJcbiAgICAgIGRvY3VtZW50LmdldEVsZW1lbnRCeUlkKCd3aW5uZXInKS5pbm5lclRleHQgPSBcIkNvbXB1dGVyIFdpbiFcIjtcclxuICAgICAgcGxheWVyMmJvYXJkLnJlbW92ZUV2ZW50TGlzdGVuZXIoXCJjbGlja1wiLCBoYW5kbGVDbGljayk7XHJcbiAgICAgIHJldHVybjtcclxuICAgIH1cclxuICAgIGlmIChjb21wYm9hcmQuYWxsU2hpcHNTdW5rKCkpIHtcclxuICAgICAgZ2FtZU92ZXIgPSB0cnVlO1xyXG4gICAgICBkb2N1bWVudC5nZXRFbGVtZW50QnlJZCgnd2lubmVyJykuaW5uZXJUZXh0ID0gXCJZb3UgV2luIVwiO1xyXG4gICAgICByZXR1cm47XHJcbiAgICB9XHJcbiAgfVxyXG59XHJcblxyXG5leHBvcnQgZGVmYXVsdCBnYW1lTG9vcDtcclxuIiwiaW1wb3J0IGRvTSBmcm9tIFwiLi9ET01cIjtcclxuaW1wb3J0IFBsYXllciBmcm9tIFwiLi9wbGF5ZXJcIjtcclxuaW1wb3J0IEdhbWVib2FyZCBmcm9tIFwiLi9nYW1lYm9hcmRcIjtcclxuaW1wb3J0IFNoaXAgZnJvbSBcIi4vc2hpcFwiO1xyXG5pbXBvcnQgZ2FtZUxvb3AgZnJvbSBcIi4vZ2FtZWxvb3BcIjtcclxuXHJcblxyXG5nYW1lTG9vcCh7bmFtZTogXCJQbGF5ZXJcIn0sIHtuYW1lOiBcIkNvbXB1dGVyXCJ9KTtcclxuIl0sIm5hbWVzIjpbImJvYXJkRWxlbWVudCIsImhvbGRlciIsImlubmVySFRNTCIsImkiLCJjZWxsIiwiZG9jdW1lbnQiLCJjcmVhdGVFbGVtZW50IiwiZGF0YXNldCIsImluZGV4IiwiY2xhc3NMaXN0IiwiYWRkIiwiYXBwZW5kQ2hpbGQiLCJib2FyZCIsIkFycmF5IiwiZmlsbCIsInNoaXBzIiwibWlzc2VkQXR0YWNrcyIsImdldFNoaXBzIiwibGVuZ3RoIiwiZ2V0Qm9hcmQiLCJwbGFjZVNoaXAiLCJzaGlwIiwic2hpcGxlbmd0aCIsImNvb3JkaW5hdGVzIiwicHVzaCIsImZvckVhY2giLCJjb29yZCIsInJlY2VpdmVBdHRhY2siLCJoaXQiLCJhbGxTaGlwc1N1bmsiLCJldmVyeSIsImlzU3VuayIsImhpdHMiLCJwbGFjZXNoaXBzIiwicGxheWVyYm9hcmQiLCJzaGlwc0xlbmd0aCIsInNoaXBzbGVuIiwiY2VsbHMiLCJxdWVyeVNlbGVjdG9yQWxsIiwiZ2FtZSIsInR1cm4iLCJnZXRFbGVtZW50QnlJZCIsImFkZEV2ZW50TGlzdGVuZXIiLCJldmVudCIsInRhcmdldCIsInBhcnNlSW50IiwiY2FuUGxhY2VTaGlwIiwic3RhcnRJbmRleCIsImNoZWNrU2hpcFBsYWNlbWVudCIsIm5vT3ZlcmxhcCIsImNoZWNrT3ZlcmxhcCIsImlubmVyVGV4dCIsImsiLCJxdWVyeVNlbGVjdG9yIiwic3R5bGUiLCJiYWNrZ3JvdW5kQ29sb3IiLCJNYXRoIiwiZmxvb3IiLCJyYW5kb20iLCJsYXN0Q2VsbEluZGV4IiwiaW5kZXhyb3ciLCJwbGF5ZXIxIiwicGxheWVyMiIsImNvbXBib2FyZCIsImNsaWNrZWRDZWxscyIsInBsYXllcjFib2FyZCIsInBsYXllcjJib2FyZCIsInNoaXBQbGFjZWQiLCJjb25zb2xlIiwibG9nIiwiYXR0YWNrSW5kZXgiLCJwcmV2aW91c0F0dGFjayIsIlNldCIsImN1cnJlbnRQbGF5ZXIiLCJnYW1lT3ZlciIsImhhbmRsZUNsaWNrIiwiY2VsbGluZGV4IiwicmVzdWx0IiwiZSIsImlzdmFsaWRjbGljayIsImluY2x1ZGVzIiwiY2hlY2tEb3VibGUiLCJjaGVja2dhbWVPdmVyIiwic3dpdGNoUGxheWVyIiwic2V0VGltZW91dCIsImNvbXB1dGVyVHVybiIsImxlZnQiLCJyaWdodCIsIngiLCJoYXMiLCJyYW5kb21BdHRhY2siLCJjb21waGl0IiwiY29tcHV0ZXJBSSIsInJlbW92ZUV2ZW50TGlzdGVuZXIiLCJuYW1lIl0sInNvdXJjZVJvb3QiOiIifQ==