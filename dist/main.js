(()=>{"use strict";const e=function(e,t){e.innerHTML="";for(let n=0;n<100;n++){const o=document.createElement("div");o.dataset.index=n,"player"==t?(o.classList.add("cell"),o.classList.add(`h${n}`)):"computer"==t&&(o.classList.add("enemycell"),o.classList.add(`e${n}`)),o.innerText=`${n}`,e.appendChild(o)}},t=function(){let e=Array(100).fill(null),t=[],n=[];return{board:e,getBoard:function(){return e},placeShip:function(n,o){let r=n.length,l=[];for(let e=0;e<r;e++)l.push(o+e);l.forEach((t=>{e[t]=n})),t.push(n)},receiveAttack:function(t){return null===e[t]?(n.push(t),!1):(e[t].hit(),!0)},allShipsSunk:function(){return t.every((e=>e.isSunk()))},missedAttacks:n}},n=function(e){let t=0;return{length:e,hit:()=>(t++,t),isSunk:()=>t===e,get hits(){return t}}};function o(e,t){if("player"===e){const e=[5,4,3,2];let o=e.length;const l=document.querySelectorAll(".cell");let c=!0,a=0;c&&l.forEach((l=>{l.addEventListener("click",(l=>{const u=l.target,i=parseInt(u.dataset.index),s=function(e,t,n){const o=e.getBoard();for(let e=0;e<n;e++)if(null!==o[t+e])return!1;return!0}(t,i,e[a]),d=r(i,e[a]);if(s&&d){console.log(t.board);const r=n(e[a]);t.placeShip(r,i);for(let t=0;t<e[a];t++)document.querySelector(`.h${i+t}`).style.backgroundColor="blue";a++,a===o&&(c=!1)}}))}))}else if("computer"===e){const e=[5,4,3,2];let o=e.length,l=0;for(;l<o;){let o=n(e[l]),c=Math.floor(100*Math.random());if(!r(c,e[l]))continue;let a=c;t.placeShip(o,c);for(let t=0;t<e[l];t++)document.querySelector(`.e${a}`).style.backgroundColor="blue",a++;l++}}}function r(e,t){let n=e+t-1,o=Math.floor(e/10);return!(Math.floor(n/10)>o)}!function(n,r){let l,c;c=t(),l=t();const a=document.getElementById("playerboard"),u=document.getElementById("compboard");e(a,"player"),e(u,"computer"),o("player",c),o("computer",l);let i=new Set,s=n,d=!1;function f(e){if(d)return;const t=e.target.dataset.index,n=l.receiveAttack(t);e.target.style.backgroundColor=!0===n?"#f70202":"#4a4848"}function h(){if(d)return;let e=Math.floor(100*Math.random());for(;i.has(e);)e=Math.floor(100*Math.random());const t=c.receiveAttack(e);a.querySelector(`[data-index='${e}']`).style.backgroundColor=!0===t?"#f70202":"#4a4848",i.add(e),p(),s=m()}function m(){return s=s===n?r:n}function p(){return c.allShipsSunk()?(d=!0,console.log("Game over! Computer won!"),void u.removeEventListener("click",f)):l.allShipsSunk()?(d=!0,void console.log("Game over! Player won!")):void 0}u.addEventListener("click",(e=>{s!==n||d||(f(e),p(),s=m(),setTimeout(h,500))}))}({name:"Player"},{name:"Computer"})})();
//# sourceMappingURL=data:application/json;charset=utf-8;base64,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Q0YsT0FFRixJQUFJSyxFQUFJcEIsS0FBS0MsTUFBc0IsSUFBaEJELEtBQUtFLFVBQ3hCLEtBQU1VLEVBQWVTLElBQUlELElBQ3ZCQSxFQUFJcEIsS0FBS0MsTUFBc0IsSUFBaEJELEtBQUtFLFVBRXRCLE1BQU1vQixFQUFVM0MsRUFBWVAsY0FBY2dELEdBQzdCWCxFQUFhWixjQUFjLGdCQUFnQnVCLE9BRWpEdEIsTUFBTUMsaUJBREcsSUFBWnVCLEVBQzJCLFVBRUEsVUFFL0JWLEVBQWV6RCxJQUFJaUUsR0FDbkJHLElBQ0FULEVBQWdCVSxHQUNsQixDQUVBLFNBQVNBLElBQ1AsT0FBUVYsRUFBZ0JBLElBQWtCUixFQUFVQyxFQUFVRCxDQUNoRSxDQUVBLFNBQVNpQixJQUNQLE9BQUk1QyxFQUFZTCxnQkFDZHlDLEdBQVcsRUFDWHJCLFFBQVFDLElBQUksaUNBQ1pnQixFQUFhYyxvQkFBb0IsUUFBU1QsSUFHeENSLEVBQVVsQyxnQkFDWnlDLEdBQVcsT0FDWHJCLFFBQVFDLElBQUksZ0NBRmQsQ0FLRixDQTNEQWdCLEVBQWExQixpQkFBaUIsU0FBVXlDLElBQ2xDWixJQUFrQlIsR0FBV1MsSUFHakNDLEVBQVlVLEdBQ1pILElBQ0FULEVBQWdCVSxJQUNoQkcsV0FBV1IsRUFBYyxLQUFJLEdBcURqQyxDQzlFQSxDQUFTLENBQUNTLEtBQU0sVUFBVyxDQUFDQSxLQUFNLFkiLCJzb3VyY2VzIjpbIndlYnBhY2s6Ly90aGUtYmF0dGxlc2hpcC8uL3NjcmlwdC9ET00uanMiLCJ3ZWJwYWNrOi8vdGhlLWJhdHRsZXNoaXAvLi9zY3JpcHQvZ2FtZWJvYXJkLmpzIiwid2VicGFjazovL3RoZS1iYXR0bGVzaGlwLy4vc2NyaXB0L3NoaXAuanMiLCJ3ZWJwYWNrOi8vdGhlLWJhdHRsZXNoaXAvLi9zY3JpcHQvcGxhY2VzaGlwcy5qcyIsIndlYnBhY2s6Ly90aGUtYmF0dGxlc2hpcC8uL3NjcmlwdC9nYW1lbG9vcC5qcyIsIndlYnBhY2s6Ly90aGUtYmF0dGxlc2hpcC8uL3NjcmlwdC9pbmRleC5qcyJdLCJzb3VyY2VzQ29udGVudCI6WyJjb25zdCBkb00gPSAoKCk9PntcclxuICAgIGZ1bmN0aW9uIHJlbmRlckJvYXJkKGJvYXJkRWxlbWVudCwgaG9sZGVyKSB7XHJcbiAgICAgICAgYm9hcmRFbGVtZW50LmlubmVySFRNTCA9ICcnO1xyXG4gICAgICAgIGZvciAobGV0IGkgPSAwOyBpIDwgMTAwOyBpKyspIHtcclxuICAgICAgICAgICAgY29uc3QgY2VsbCA9IGRvY3VtZW50LmNyZWF0ZUVsZW1lbnQoJ2RpdicpO1xyXG4gICAgICAgICAgICBjZWxsLmRhdGFzZXQuaW5kZXggPSBpO1xyXG4gICAgICAgICAgICBpZihob2xkZXIgPT0gXCJwbGF5ZXJcIil7XHJcbiAgICAgICAgICAgICAgICBjZWxsLmNsYXNzTGlzdC5hZGQoJ2NlbGwnKTtcclxuICAgICAgICAgICAgICAgIGNlbGwuY2xhc3NMaXN0LmFkZChgaCR7aX1gKTtcclxuICAgICAgICAgICAgfVxyXG4gICAgICAgICAgICBlbHNlIGlmKGhvbGRlciA9PSBcImNvbXB1dGVyXCIpe1xyXG4gICAgICAgICAgICAgICAgY2VsbC5jbGFzc0xpc3QuYWRkKCdlbmVteWNlbGwnKTtcclxuICAgICAgICAgICAgICAgIGNlbGwuY2xhc3NMaXN0LmFkZChgZSR7aX1gKTtcclxuICAgICAgICAgICAgfVxyXG4gICAgICAgICAgICBjZWxsLmlubmVyVGV4dCA9IGAke2l9YDtcclxuICAgICAgICAgICAgYm9hcmRFbGVtZW50LmFwcGVuZENoaWxkKGNlbGwpO1xyXG4gICAgICAgIH1cclxuICAgIH07XHJcblxyXG4gICAgcmV0dXJuIHtcclxuICAgICAgICByZW5kZXJCb2FyZFxyXG4gICAgfVxyXG59KSgpO1xyXG5cclxuXHJcbmV4cG9ydCBkZWZhdWx0IGRvTSIsImltcG9ydCBTaGlwIGZyb20gXCIuL3NoaXBcIjtcclxuZnVuY3Rpb24gR2FtZWJvYXJkKCkge1xyXG4gIGxldCBib2FyZCA9IEFycmF5KDEwMCkuZmlsbChudWxsKTtcclxuICBsZXQgc2hpcHMgPSBbXTtcclxuICBsZXQgbWlzc2VkQXR0YWNrcyA9IFtdO1xyXG5cclxuXHJcbiAgZnVuY3Rpb24gcGxhY2VTaGlwKHNoaXAsaW5kZXgpIHtcclxuICAgIGxldCBzaGlwbGVuZ3RoID0gc2hpcC5sZW5ndGg7XHJcbiAgICBsZXQgY29vcmRpbmF0ZXMgPSBbXTtcclxuICAgIGZvcihsZXQgaT0wO2k8c2hpcGxlbmd0aDtpKyspe1xyXG4gICAgICBjb29yZGluYXRlcy5wdXNoKGluZGV4K2kpO1xyXG4gICAgfVxyXG4gICAgY29vcmRpbmF0ZXMuZm9yRWFjaChjb29yZCA9PiB7XHJcbiAgICAgIGJvYXJkW2Nvb3JkXSA9IHNoaXA7XHJcbiAgICB9KTtcclxuICAgIHNoaXBzLnB1c2goc2hpcCk7XHJcblxyXG4gIH1cclxuICBcclxuICBmdW5jdGlvbiByZWNlaXZlQXR0YWNrKGNvb3JkaW5hdGVzKSB7XHJcbiAgICBpZiAoYm9hcmRbY29vcmRpbmF0ZXNdID09PSBudWxsKSB7XHJcbiAgICAgIG1pc3NlZEF0dGFja3MucHVzaChjb29yZGluYXRlcyk7XHJcbiAgICAgIHJldHVybiBmYWxzZTtcclxuICAgIH1cclxuICAgIGNvbnN0IGhpdFNoaXAgPSBib2FyZFtjb29yZGluYXRlc107XHJcbiAgICBoaXRTaGlwLmhpdCgpO1xyXG4gICAgcmV0dXJuIHRydWU7XHJcbiAgfVxyXG5cclxuICBmdW5jdGlvbiBhbGxTaGlwc1N1bmsoKSB7XHJcbiAgICByZXR1cm4gc2hpcHMuZXZlcnkoc2hpcCA9PiBzaGlwLmlzU3VuaygpKTtcclxuICB9XHJcbiAgZnVuY3Rpb24gZ2V0Qm9hcmQoKXtcclxuICAgIHJldHVybiBib2FyZDtcclxuICB9XHJcblxyXG4gIHJldHVybiB7XHJcbiAgICBib2FyZCxcclxuICAgIGdldEJvYXJkLFxyXG4gICAgcGxhY2VTaGlwLFxyXG4gICAgcmVjZWl2ZUF0dGFjayxcclxuICAgIGFsbFNoaXBzU3VuayxcclxuICAgIG1pc3NlZEF0dGFja3MsXHJcbiAgfTtcclxufVxyXG5cclxuZXhwb3J0IGRlZmF1bHQgR2FtZWJvYXJkOyIsImZ1bmN0aW9uIFNoaXAobGVuZ3RoKSB7XHJcbiAgbGV0IGhpdHMgPSAwO1xyXG5cclxuICByZXR1cm4ge1xyXG4gICAgbGVuZ3RoOiBsZW5ndGgsXHJcbiAgICBoaXQoKSB7XHJcbiAgICAgIGhpdHMrK1xyXG4gICAgICByZXR1cm4gaGl0cztcclxuICAgIH0sXHJcbiAgICBpc1N1bmsoKSB7XHJcbiAgICAgIHJldHVybiBoaXRzID09PSBsZW5ndGg7XHJcbiAgICB9LFxyXG4gICAgZ2V0IGhpdHMoKXtcclxuICAgICAgcmV0dXJuIGhpdHM7XHJcbiAgICB9XHJcbiAgfTtcclxufVxyXG5leHBvcnQgZGVmYXVsdCBTaGlwOyIsImltcG9ydCBTaGlwIGZyb20gXCIuL3NoaXBcIjtcclxuaW1wb3J0IEdhbWVib2FyZCBmcm9tIFwiLi9nYW1lYm9hcmRcIjtcclxuXHJcbmZ1bmN0aW9uIHBsYWNlc2hpcHMoaG9sZGVyLCBwbGF5ZXJib2FyZCkge1xyXG4gIGlmIChob2xkZXIgPT09IFwicGxheWVyXCIpIHtcclxuICAgIGNvbnN0IHNoaXBzTGVuZ3RoID0gWzUsIDQsIDMsIDJdO1xyXG4gICAgbGV0IHNoaXBzbGVuID0gc2hpcHNMZW5ndGgubGVuZ3RoO1xyXG4gICAgY29uc3QgY2VsbHMgPSBkb2N1bWVudC5xdWVyeVNlbGVjdG9yQWxsKCcuY2VsbCcpO1xyXG4gICAgbGV0IGdhbWUgPSB0cnVlO1xyXG4gICAgbGV0IGkgPSAwO1xyXG5cclxuICAgIGlmIChnYW1lKSB7XHJcbiAgICAgIGNlbGxzLmZvckVhY2goY2VsbCA9PiB7XHJcbiAgICAgICAgY2VsbC5hZGRFdmVudExpc3RlbmVyKCdjbGljaycsIChldmVudCkgPT4ge1xyXG4gICAgICAgICAgY29uc3QgY2VsbCA9IGV2ZW50LnRhcmdldDtcclxuICAgICAgICAgIGNvbnN0IGluZGV4ID0gcGFyc2VJbnQoY2VsbC5kYXRhc2V0LmluZGV4KTtcclxuICAgICAgICAgIGNvbnN0IGNhblBsYWNlU2hpcCA9IGNoZWNrU2hpcFBsYWNlbWVudChwbGF5ZXJib2FyZCxpbmRleCxzaGlwc0xlbmd0aFtpXSk7XHJcbiAgICAgICAgICBjb25zdCBub092ZXJMYXAgPSBvdmVyTGFwcGluZyhpbmRleCxzaGlwc0xlbmd0aFtpXSlcclxuXHJcbiAgICAgICAgICBpZihjYW5QbGFjZVNoaXAgJiYgbm9PdmVyTGFwKXtcclxuICAgICAgICAgICAgY29uc29sZS5sb2cocGxheWVyYm9hcmQuYm9hcmQpXHJcbiAgICAgICAgICAgIGNvbnN0IHNoaXAgPSBTaGlwKHNoaXBzTGVuZ3RoW2ldKTtcclxuICAgICAgICAgICAgcGxheWVyYm9hcmQucGxhY2VTaGlwKHNoaXAsIGluZGV4KTsgIFxyXG4gICAgICAgICAgICBmb3IobGV0IGsgPTA7azxzaGlwc0xlbmd0aFtpXTtrKyspe1xyXG4gICAgICAgICAgICAgIGRvY3VtZW50LnF1ZXJ5U2VsZWN0b3IoYC5oJHtpbmRleCArIGt9YCkuc3R5bGUuYmFja2dyb3VuZENvbG9yID0gJ2JsdWUnO1xyXG4gICAgICAgICAgICB9ICBcclxuICAgICAgICAgIFxyXG4gICAgICAgICAgaSsrO1xyXG4gICAgICAgICAgaWYgKGkgPT09IHNoaXBzbGVuKSB7XHJcbiAgICAgICAgICAgIGdhbWUgPSBmYWxzZTtcclxuICAgICAgICAgIH1cclxuICAgICAgICB9XHJcbiAgICAgICAgfSk7XHJcbiAgICAgIH0pO1xyXG4gICAgfVxyXG4gIH0gXHJcbiAgZWxzZSBpZiAoaG9sZGVyID09PSBcImNvbXB1dGVyXCIpIHtcclxuICAgIGNvbnN0IHNoaXBzTGVuZ3RoID0gWzUsIDQsIDMsIDJdO1xyXG4gICAgbGV0IHNoaXBzbGVuID0gc2hpcHNMZW5ndGgubGVuZ3RoO1xyXG4gICAgbGV0IGkgPSAwO1xyXG4gICAgXHJcbiAgICB3aGlsZSAoaSA8IHNoaXBzbGVuKSB7XHJcbiAgICAgIGxldCBzaGlwID0gU2hpcChzaGlwc0xlbmd0aFtpXSk7XHJcbiAgICAgIGxldCBpbmRleCA9IE1hdGguZmxvb3IoTWF0aC5yYW5kb20oKSAqIDEwMCk7XHJcbiAgICAgIGNvbnN0IG5vT3ZlckxhcCA9IG92ZXJMYXBwaW5nKGluZGV4LHNoaXBzTGVuZ3RoW2ldKTtcclxuICAgICAgaWYgKCFub092ZXJMYXApIHsgLy8gQ2hlY2sgaWYgdGhlIHNoaXAgaXMgb3ZlcmZsb3dpbmdcclxuICAgICAgICBjb250aW51ZTtcclxuICAgICAgfVxyXG4gICAgICBsZXQgdGVtcCA9IGluZGV4O1xyXG4gICAgICBwbGF5ZXJib2FyZC5wbGFjZVNoaXAoc2hpcCwgaW5kZXgpO1xyXG4gICAgICBcclxuICAgICAgZm9yIChsZXQgayA9IDA7IGsgPCBzaGlwc0xlbmd0aFtpXTsgaysrKSB7XHJcbiAgICAgICAgZG9jdW1lbnQucXVlcnlTZWxlY3RvcihgLmUke3RlbXB9YCkuc3R5bGUuYmFja2dyb3VuZENvbG9yID0gJ2JsdWUnO1xyXG4gICAgICAgIHRlbXArKztcclxuICAgICAgfVxyXG4gICAgICBcclxuICAgICAgaSsrOyBcclxuICAgIH0gICAgIFxyXG4gIH1cclxufVxyXG5mdW5jdGlvbiBvdmVyTGFwcGluZyhzdGFydEluZGV4LGxlbmd0aCl7XHJcbiAgbGV0IGxhc3RDZWxsSW5kZXggPSBzdGFydEluZGV4ICsgbGVuZ3RoIC0gMTtcclxuICBsZXQgaW5kZXhyb3cgPSBNYXRoLmZsb29yKHN0YXJ0SW5kZXggLyAxMCk7XHJcbiAgbGV0IGxhc3Ryb3cgPSBNYXRoLmZsb29yKGxhc3RDZWxsSW5kZXggLyAxMCk7XHJcbiAgaWYobGFzdHJvdyA+IGluZGV4cm93KXtcclxuICAgIHJldHVybiBmYWxzZTtcclxuICB9XHJcbiAgcmV0dXJuIHRydWU7XHJcbn1cclxuZnVuY3Rpb24gY2hlY2tTaGlwUGxhY2VtZW50KHBsYXllcmJvYXJkLHN0YXJ0SW5kZXgsbGVuZ3RoKXtcclxuICBjb25zdCBib2FyZCA9IHBsYXllcmJvYXJkLmdldEJvYXJkKCk7XHJcbiAgZm9yKGxldCBpID0wO2k8bGVuZ3RoO2krKyl7XHJcbiAgICBjb25zdCBpbmRpY2VzID0gc3RhcnRJbmRleCArIGk7XHJcblxyXG4gICAgaWYoYm9hcmRbaW5kaWNlc10gIT09IG51bGwpe1xyXG4gICAgICByZXR1cm4gZmFsc2U7XHJcbiAgICB9XHJcbiAgfVxyXG4gIHJldHVybiB0cnVlO1xyXG59XHJcblxyXG5leHBvcnQgeyBwbGFjZXNoaXBzIH1cclxuIiwiaW1wb3J0IFBsYXllcnMgZnJvbSBcIi4vcGxheWVyXCI7XHJcbmltcG9ydCBHYW1lYm9hcmQgZnJvbSBcIi4vZ2FtZWJvYXJkXCI7XHJcbmltcG9ydCBTaGlwIGZyb20gXCIuL3NoaXBcIjtcclxuaW1wb3J0IGRvTSBmcm9tIFwiLi9ET01cIjtcclxuaW1wb3J0IHsgcGxhY2VzaGlwcyB9IGZyb20gXCIuL3BsYWNlc2hpcHNcIjtcclxuXHJcbmZ1bmN0aW9uIGdhbWVMb29wKHBsYXllcjEsIHBsYXllcjIpIHtcclxuICBsZXQgY29tcGJvYXJkLCBwbGF5ZXJib2FyZDtcclxuICBwbGF5ZXJib2FyZCA9IEdhbWVib2FyZCgpO1xyXG4gIGNvbXBib2FyZCA9IEdhbWVib2FyZCgpO1xyXG4gIGNvbnN0IHBsYXllcjFib2FyZCA9IGRvY3VtZW50LmdldEVsZW1lbnRCeUlkKFwicGxheWVyYm9hcmRcIik7XHJcbiAgY29uc3QgcGxheWVyMmJvYXJkID0gZG9jdW1lbnQuZ2V0RWxlbWVudEJ5SWQoXCJjb21wYm9hcmRcIik7XHJcbiAgZG9NLnJlbmRlckJvYXJkKHBsYXllcjFib2FyZCxcInBsYXllclwiKTtcclxuICBkb00ucmVuZGVyQm9hcmQocGxheWVyMmJvYXJkLCBcImNvbXB1dGVyXCIpO1xyXG5cclxuXHJcbiAgcGxhY2VzaGlwcyhcInBsYXllclwiLHBsYXllcmJvYXJkKTtcclxuICBwbGFjZXNoaXBzKFwiY29tcHV0ZXJcIixjb21wYm9hcmQpO1xyXG5cclxuIFxyXG4gIGxldCBwcmV2aW91c0F0dGFjayA9IG5ldyBTZXQoKTsgLy90byBwcmV2ZW50IHRoZSBjb21wIGZyb20gYXR0YWNraW5nIHRoZSBzYW1lIGluZGV4IHR3aWNlXHJcbiAgbGV0IGN1cnJlbnRQbGF5ZXIgPSBwbGF5ZXIxO1xyXG4gIGxldCBnYW1lT3ZlciA9IGZhbHNlO1xyXG5cclxuIFxyXG4gIHBsYXllcjJib2FyZC5hZGRFdmVudExpc3RlbmVyKFwiY2xpY2tcIiwgKGUpID0+IHtcclxuICAgIGlmIChjdXJyZW50UGxheWVyICE9PSBwbGF5ZXIxIHx8IGdhbWVPdmVyKSB7XHJcbiAgICAgIHJldHVybjtcclxuICAgIH1cclxuICAgIGhhbmRsZUNsaWNrKGUpO1xyXG4gICAgY2hlY2tnYW1lT3ZlcigpO1xyXG4gICAgY3VycmVudFBsYXllciA9IHN3aXRjaFBsYXllcigpO1xyXG4gICAgc2V0VGltZW91dChjb21wdXRlclR1cm4sIDUwMCk7XHJcbiAgfSk7XHJcblxyXG4gIGZ1bmN0aW9uIGhhbmRsZUNsaWNrKGV2ZW50KSB7XHJcbiAgICBpZiAoZ2FtZU92ZXIpIHtcclxuICAgICAgcmV0dXJuO1xyXG4gICAgfVxyXG4gICAgY29uc3QgY2VsbGluZGV4ID0gZXZlbnQudGFyZ2V0LmRhdGFzZXQuaW5kZXg7XHJcbiAgICBjb25zdCByZXN1bHQgPSBjb21wYm9hcmQucmVjZWl2ZUF0dGFjayhjZWxsaW5kZXgpO1xyXG4gICAgaWYgKHJlc3VsdCA9PT0gdHJ1ZSkge1xyXG4gICAgICBldmVudC50YXJnZXQuc3R5bGUuYmFja2dyb3VuZENvbG9yID0gXCIjZjcwMjAyXCI7XHJcbiAgICB9IGVsc2Uge1xyXG4gICAgICBldmVudC50YXJnZXQuc3R5bGUuYmFja2dyb3VuZENvbG9yID0gXCIjNGE0ODQ4XCI7XHJcbiAgICB9XHJcbiAgfVxyXG5cclxuICBmdW5jdGlvbiBjb21wdXRlclR1cm4oKSB7XHJcbiAgICBpZiAoZ2FtZU92ZXIpIHtcclxuICAgICAgcmV0dXJuO1xyXG4gICAgfVxyXG4gICAgbGV0IHggPSBNYXRoLmZsb29yKE1hdGgucmFuZG9tKCkgKiAxMDApO1xyXG4gICAgd2hpbGUocHJldmlvdXNBdHRhY2suaGFzKHgpKXtcclxuICAgICAgeCA9IE1hdGguZmxvb3IoTWF0aC5yYW5kb20oKSAqIDEwMCk7XHJcbiAgICB9XHJcbiAgICBjb25zdCBjb21waGl0ID0gcGxheWVyYm9hcmQucmVjZWl2ZUF0dGFjayh4KTtcclxuICAgIGNvbnN0IGNlbGwgPSBwbGF5ZXIxYm9hcmQucXVlcnlTZWxlY3RvcihgW2RhdGEtaW5kZXg9JyR7eH0nXWApO1xyXG4gICAgaWYgKGNvbXBoaXQgPT09IHRydWUpIHtcclxuICAgICAgY2VsbC5zdHlsZS5iYWNrZ3JvdW5kQ29sb3IgPSBcIiNmNzAyMDJcIjtcclxuICAgIH0gZWxzZSB7XHJcbiAgICAgIGNlbGwuc3R5bGUuYmFja2dyb3VuZENvbG9yID0gXCIjNGE0ODQ4XCI7XHJcbiAgICB9XHJcbiAgICBwcmV2aW91c0F0dGFjay5hZGQoeCk7XHJcbiAgICBjaGVja2dhbWVPdmVyKCk7XHJcbiAgICBjdXJyZW50UGxheWVyID0gc3dpdGNoUGxheWVyKCk7XHJcbiAgfVxyXG5cclxuICBmdW5jdGlvbiBzd2l0Y2hQbGF5ZXIoKSB7XHJcbiAgICByZXR1cm4gKGN1cnJlbnRQbGF5ZXIgPSBjdXJyZW50UGxheWVyID09PSBwbGF5ZXIxID8gcGxheWVyMiA6IHBsYXllcjEpO1xyXG4gIH1cclxuXHJcbiAgZnVuY3Rpb24gY2hlY2tnYW1lT3ZlcigpIHtcclxuICAgIGlmIChwbGF5ZXJib2FyZC5hbGxTaGlwc1N1bmsoKSkge1xyXG4gICAgICBnYW1lT3ZlciA9IHRydWU7XHJcbiAgICAgIGNvbnNvbGUubG9nKFwiR2FtZSBvdmVyISBDb21wdXRlciB3b24hXCIpO1xyXG4gICAgICBwbGF5ZXIyYm9hcmQucmVtb3ZlRXZlbnRMaXN0ZW5lcihcImNsaWNrXCIsIGhhbmRsZUNsaWNrKTtcclxuICAgICAgcmV0dXJuO1xyXG4gICAgfVxyXG4gICAgaWYgKGNvbXBib2FyZC5hbGxTaGlwc1N1bmsoKSkge1xyXG4gICAgICBnYW1lT3ZlciA9IHRydWU7XHJcbiAgICAgIGNvbnNvbGUubG9nKFwiR2FtZSBvdmVyISBQbGF5ZXIgd29uIVwiKTtcclxuICAgICAgcmV0dXJuO1xyXG4gICAgfVxyXG4gIH1cclxufVxyXG5cclxuZXhwb3J0IGRlZmF1bHQgZ2FtZUxvb3A7XHJcbiIsImltcG9ydCBkb00gZnJvbSBcIi4vRE9NXCI7XHJcbmltcG9ydCBQbGF5ZXIgZnJvbSBcIi4vcGxheWVyXCI7XHJcbmltcG9ydCBHYW1lYm9hcmQgZnJvbSBcIi4vZ2FtZWJvYXJkXCI7XHJcbmltcG9ydCBTaGlwIGZyb20gXCIuL3NoaXBcIjtcclxuaW1wb3J0IGdhbWVMb29wIGZyb20gXCIuL2dhbWVsb29wXCI7XHJcblxyXG5cclxuZ2FtZUxvb3Aoe25hbWU6IFwiUGxheWVyXCJ9LCB7bmFtZTogXCJDb21wdXRlclwifSk7XHJcbiJdLCJuYW1lcyI6WyJib2FyZEVsZW1lbnQiLCJob2xkZXIiLCJpbm5lckhUTUwiLCJpIiwiY2VsbCIsImRvY3VtZW50IiwiY3JlYXRlRWxlbWVudCIsImRhdGFzZXQiLCJpbmRleCIsImNsYXNzTGlzdCIsImFkZCIsImlubmVyVGV4dCIsImFwcGVuZENoaWxkIiwiYm9hcmQiLCJBcnJheSIsImZpbGwiLCJzaGlwcyIsIm1pc3NlZEF0dGFja3MiLCJnZXRCb2FyZCIsInBsYWNlU2hpcCIsInNoaXAiLCJzaGlwbGVuZ3RoIiwibGVuZ3RoIiwiY29vcmRpbmF0ZXMiLCJwdXNoIiwiZm9yRWFjaCIsImNvb3JkIiwicmVjZWl2ZUF0dGFjayIsImhpdCIsImFsbFNoaXBzU3VuayIsImV2ZXJ5IiwiaXNTdW5rIiwiaGl0cyIsInBsYWNlc2hpcHMiLCJwbGF5ZXJib2FyZCIsInNoaXBzTGVuZ3RoIiwic2hpcHNsZW4iLCJjZWxscyIsInF1ZXJ5U2VsZWN0b3JBbGwiLCJnYW1lIiwiYWRkRXZlbnRMaXN0ZW5lciIsImV2ZW50IiwidGFyZ2V0IiwicGFyc2VJbnQiLCJjYW5QbGFjZVNoaXAiLCJzdGFydEluZGV4IiwiY2hlY2tTaGlwUGxhY2VtZW50Iiwibm9PdmVyTGFwIiwib3ZlckxhcHBpbmciLCJjb25zb2xlIiwibG9nIiwiayIsInF1ZXJ5U2VsZWN0b3IiLCJzdHlsZSIsImJhY2tncm91bmRDb2xvciIsIk1hdGgiLCJmbG9vciIsInJhbmRvbSIsInRlbXAiLCJsYXN0Q2VsbEluZGV4IiwiaW5kZXhyb3ciLCJwbGF5ZXIxIiwicGxheWVyMiIsImNvbXBib2FyZCIsInBsYXllcjFib2FyZCIsImdldEVsZW1lbnRCeUlkIiwicGxheWVyMmJvYXJkIiwicHJldmlvdXNBdHRhY2siLCJTZXQiLCJjdXJyZW50UGxheWVyIiwiZ2FtZU92ZXIiLCJoYW5kbGVDbGljayIsImNlbGxpbmRleCIsInJlc3VsdCIsImNvbXB1dGVyVHVybiIsIngiLCJoYXMiLCJjb21waGl0IiwiY2hlY2tnYW1lT3ZlciIsInN3aXRjaFBsYXllciIsInJlbW92ZUV2ZW50TGlzdGVuZXIiLCJlIiwic2V0VGltZW91dCIsIm5hbWUiXSwic291cmNlUm9vdCI6IiJ9