(()=>{"use strict";const e=function(e,t){e.innerHTML="";for(let n=0;n<100;n++){const o=document.createElement("div");o.dataset.index=n,"player"==t?(o.classList.add("cell"),o.classList.add(`h${n}`)):"computer"==t&&(o.classList.add("enemycell"),o.classList.add(`e${n}`)),o.innerText=`${n}`,e.appendChild(o)}},t=function(){let e=Array(100).fill(null),t=[],n=[];return{board:e,getBoard:function(){return e},placeShip:function(n,o){let r=n.length,l=[];for(let e=0;e<r;e++)l.push(o+e);l.forEach((t=>{e[t]=n})),t.push(n)},receiveAttack:function(t){return null===e[t]?(n.push(t),!1):(e[t].hit(),!0)},allShipsSunk:function(){return t.every((e=>e.isSunk()))},missedAttacks:n}},n=function(e){let t=0;return{length:e,hit:()=>(t++,t),isSunk:()=>t===e,get hits(){return t}}};function o(e,t){if("player"===e){const e=[5,4,3,2];let o=e.length;const l=document.querySelectorAll(".cell");let c=!0,a=0;c&&l.forEach((l=>{l.addEventListener("click",(l=>{const u=l.target,i=parseInt(u.dataset.index),s=function(e,t,n){const o=e.getBoard();for(let e=0;e<n;e++)if(null!==o[t+e])return!1;return!0}(t,i,e[a]),d=r(i,e[a]);if(s&&d){console.log(t.board);const r=n(e[a]);t.placeShip(r,i);for(let t=0;t<e[a];t++)document.querySelector(`.h${i+t}`).style.backgroundColor="blue";a++,a===o&&(c=!1)}}))}))}else if("computer"===e){const e=[5,4,3,2];let o=e.length,l=0;for(;l<o;){let o=n(e[l]),c=Math.floor(100*Math.random());if(!r(c,e[l]))continue;let a=c;t.placeShip(o,c);for(let t=0;t<e[l];t++)document.querySelector(`.e${a}`).style.backgroundColor="blue",a++;l++}}}function r(e,t){let n=e+t-1,o=Math.floor(e/10);return!(Math.floor(n/10)>o)}!function(n,r){let l,c;c=t(),l=t();const a=[],u=document.getElementById("playerboard"),i=document.getElementById("compboard");e(u,"player"),e(i,"computer"),o("player",c),o("computer",l);let s=new Set,d=n,f=!1;function h(e){if(f)return;const t=e.target.dataset.index,n=l.receiveAttack(t);e.target.style.backgroundColor=!0===n?"#f70202":"#4a4848"}function m(){if(f)return;let e=Math.floor(100*Math.random());for(;s.has(e);)e=Math.floor(100*Math.random());const t=c.receiveAttack(e);u.querySelector(`[data-index='${e}']`).style.backgroundColor=!0===t?"#f70202":"#4a4848",s.add(e),y(),d=p()}function p(){return d=d===n?r:n}function y(){return c.allShipsSunk()?(f=!0,console.log("Game over! Computer won!"),void i.removeEventListener("click",h)):l.allShipsSunk()?(f=!0,void console.log("Game over! Player won!")):void 0}document.querySelectorAll(".cell"),i.addEventListener("click",(e=>{const t=function(e){const t=e.target.dataset.index;return!a.includes(t)&&(a.push(t),!0)}(e);if(t){if(d!==n||f)return;h(e),y(),d=p(),setTimeout(m,500)}}))}({name:"Player"},{name:"Computer"})})();
//# sourceMappingURL=data:application/json;charset=utf-8;base64,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SUFDUCxHQUFJSixFQUNGLE9BRUYsSUFBSUssRUFBSXJCLEtBQUtDLE1BQXNCLElBQWhCRCxLQUFLRSxVQUN4QixLQUFNVyxFQUFlUyxJQUFJRCxJQUN2QkEsRUFBSXJCLEtBQUtDLE1BQXNCLElBQWhCRCxLQUFLRSxVQUV0QixNQUFNcUIsRUFBVTVDLEVBQVlQLGNBQWNpRCxHQUM3QlgsRUFBYWIsY0FBYyxnQkFBZ0J3QixPQUVqRHZCLE1BQU1DLGlCQURHLElBQVp3QixFQUMyQixVQUVBLFVBRS9CVixFQUFlMUQsSUFBSWtFLEdBQ25CRyxJQUNBVCxFQUFnQlUsR0FDbEIsQ0FFQSxTQUFTQSxJQUNQLE9BQVFWLEVBQWdCQSxJQUFrQlQsRUFBVUMsRUFBVUQsQ0FDaEUsQ0FFQSxTQUFTa0IsSUFDUCxPQUFJN0MsRUFBWUwsZ0JBQ2QwQyxHQUFXLEVBQ1h0QixRQUFRQyxJQUFJLGlDQUNaaUIsRUFBYWMsb0JBQW9CLFFBQVNULElBR3hDVCxFQUFVbEMsZ0JBQ1owQyxHQUFXLE9BQ1h0QixRQUFRQyxJQUFJLGdDQUZkLENBS0YsQ0E1RWM3QyxTQUFTaUMsaUJBQWlCLFNBRXhDNkIsRUFBYTNCLGlCQUFpQixTQUFVMEMsSUFDdEMsTUFBTUMsRUFlUixTQUFxQkQsR0FDbkIsTUFBTVQsRUFBWVMsRUFBRXhDLE9BQU9uQyxRQUFRQyxNQUNuQyxPQUFHd0QsRUFBYW9CLFNBQVNYLEtBR3pCVCxFQUFheEMsS0FBS2lELElBQ1gsRUFDVCxDQXRCdUJZLENBQVlILEdBQ2pDLEdBQUdDLEVBQWEsQ0FDZCxHQUFJYixJQUFrQlQsR0FBV1UsRUFDL0IsT0FFRkMsRUFBWVUsR0FDWkgsSUFDQVQsRUFBZ0JVLElBQ2hCTSxXQUFXWCxFQUFjLElBQzNCLElBaUVKLENDL0ZBLENBQVMsQ0FBQ1ksS0FBTSxVQUFXLENBQUNBLEtBQU0sWSIsInNvdXJjZXMiOlsid2VicGFjazovL3RoZS1iYXR0bGVzaGlwLy4vc2NyaXB0L0RPTS5qcyIsIndlYnBhY2s6Ly90aGUtYmF0dGxlc2hpcC8uL3NjcmlwdC9nYW1lYm9hcmQuanMiLCJ3ZWJwYWNrOi8vdGhlLWJhdHRsZXNoaXAvLi9zY3JpcHQvc2hpcC5qcyIsIndlYnBhY2s6Ly90aGUtYmF0dGxlc2hpcC8uL3NjcmlwdC9wbGFjZXNoaXBzLmpzIiwid2VicGFjazovL3RoZS1iYXR0bGVzaGlwLy4vc2NyaXB0L2dhbWVsb29wLmpzIiwid2VicGFjazovL3RoZS1iYXR0bGVzaGlwLy4vc2NyaXB0L2luZGV4LmpzIl0sInNvdXJjZXNDb250ZW50IjpbImNvbnN0IGRvTSA9ICgoKT0+e1xyXG4gICAgZnVuY3Rpb24gcmVuZGVyQm9hcmQoYm9hcmRFbGVtZW50LCBob2xkZXIpIHtcclxuICAgICAgICBib2FyZEVsZW1lbnQuaW5uZXJIVE1MID0gJyc7XHJcbiAgICAgICAgZm9yIChsZXQgaSA9IDA7IGkgPCAxMDA7IGkrKykge1xyXG4gICAgICAgICAgICBjb25zdCBjZWxsID0gZG9jdW1lbnQuY3JlYXRlRWxlbWVudCgnZGl2Jyk7XHJcbiAgICAgICAgICAgIGNlbGwuZGF0YXNldC5pbmRleCA9IGk7XHJcbiAgICAgICAgICAgIGlmKGhvbGRlciA9PSBcInBsYXllclwiKXtcclxuICAgICAgICAgICAgICAgIGNlbGwuY2xhc3NMaXN0LmFkZCgnY2VsbCcpO1xyXG4gICAgICAgICAgICAgICAgY2VsbC5jbGFzc0xpc3QuYWRkKGBoJHtpfWApO1xyXG4gICAgICAgICAgICB9XHJcbiAgICAgICAgICAgIGVsc2UgaWYoaG9sZGVyID09IFwiY29tcHV0ZXJcIil7XHJcbiAgICAgICAgICAgICAgICBjZWxsLmNsYXNzTGlzdC5hZGQoJ2VuZW15Y2VsbCcpO1xyXG4gICAgICAgICAgICAgICAgY2VsbC5jbGFzc0xpc3QuYWRkKGBlJHtpfWApO1xyXG4gICAgICAgICAgICB9XHJcbiAgICAgICAgICAgIGNlbGwuaW5uZXJUZXh0ID0gYCR7aX1gO1xyXG4gICAgICAgICAgICBib2FyZEVsZW1lbnQuYXBwZW5kQ2hpbGQoY2VsbCk7XHJcbiAgICAgICAgfVxyXG4gICAgfTtcclxuXHJcbiAgICByZXR1cm4ge1xyXG4gICAgICAgIHJlbmRlckJvYXJkXHJcbiAgICB9XHJcbn0pKCk7XHJcblxyXG5cclxuZXhwb3J0IGRlZmF1bHQgZG9NIiwiaW1wb3J0IFNoaXAgZnJvbSBcIi4vc2hpcFwiO1xyXG5mdW5jdGlvbiBHYW1lYm9hcmQoKSB7XHJcbiAgbGV0IGJvYXJkID0gQXJyYXkoMTAwKS5maWxsKG51bGwpO1xyXG4gIGxldCBzaGlwcyA9IFtdO1xyXG4gIGxldCBtaXNzZWRBdHRhY2tzID0gW107XHJcblxyXG5cclxuICBmdW5jdGlvbiBwbGFjZVNoaXAoc2hpcCxpbmRleCkge1xyXG4gICAgbGV0IHNoaXBsZW5ndGggPSBzaGlwLmxlbmd0aDtcclxuICAgIGxldCBjb29yZGluYXRlcyA9IFtdO1xyXG4gICAgZm9yKGxldCBpPTA7aTxzaGlwbGVuZ3RoO2krKyl7XHJcbiAgICAgIGNvb3JkaW5hdGVzLnB1c2goaW5kZXgraSk7XHJcbiAgICB9XHJcbiAgICBjb29yZGluYXRlcy5mb3JFYWNoKGNvb3JkID0+IHtcclxuICAgICAgYm9hcmRbY29vcmRdID0gc2hpcDtcclxuICAgIH0pO1xyXG4gICAgc2hpcHMucHVzaChzaGlwKTtcclxuXHJcbiAgfVxyXG4gIFxyXG4gIGZ1bmN0aW9uIHJlY2VpdmVBdHRhY2soY29vcmRpbmF0ZXMpIHtcclxuICAgIGlmIChib2FyZFtjb29yZGluYXRlc10gPT09IG51bGwpIHtcclxuICAgICAgbWlzc2VkQXR0YWNrcy5wdXNoKGNvb3JkaW5hdGVzKTtcclxuICAgICAgcmV0dXJuIGZhbHNlO1xyXG4gICAgfVxyXG4gICAgY29uc3QgaGl0U2hpcCA9IGJvYXJkW2Nvb3JkaW5hdGVzXTtcclxuICAgIGhpdFNoaXAuaGl0KCk7XHJcbiAgICByZXR1cm4gdHJ1ZTtcclxuICB9XHJcblxyXG4gIGZ1bmN0aW9uIGFsbFNoaXBzU3VuaygpIHtcclxuICAgIHJldHVybiBzaGlwcy5ldmVyeShzaGlwID0+IHNoaXAuaXNTdW5rKCkpO1xyXG4gIH1cclxuICBmdW5jdGlvbiBnZXRCb2FyZCgpe1xyXG4gICAgcmV0dXJuIGJvYXJkO1xyXG4gIH1cclxuXHJcbiAgcmV0dXJuIHtcclxuICAgIGJvYXJkLFxyXG4gICAgZ2V0Qm9hcmQsXHJcbiAgICBwbGFjZVNoaXAsXHJcbiAgICByZWNlaXZlQXR0YWNrLFxyXG4gICAgYWxsU2hpcHNTdW5rLFxyXG4gICAgbWlzc2VkQXR0YWNrcyxcclxuICB9O1xyXG59XHJcblxyXG5leHBvcnQgZGVmYXVsdCBHYW1lYm9hcmQ7IiwiZnVuY3Rpb24gU2hpcChsZW5ndGgpIHtcclxuICBsZXQgaGl0cyA9IDA7XHJcblxyXG4gIHJldHVybiB7XHJcbiAgICBsZW5ndGg6IGxlbmd0aCxcclxuICAgIGhpdCgpIHtcclxuICAgICAgaGl0cysrXHJcbiAgICAgIHJldHVybiBoaXRzO1xyXG4gICAgfSxcclxuICAgIGlzU3VuaygpIHtcclxuICAgICAgcmV0dXJuIGhpdHMgPT09IGxlbmd0aDtcclxuICAgIH0sXHJcbiAgICBnZXQgaGl0cygpe1xyXG4gICAgICByZXR1cm4gaGl0cztcclxuICAgIH1cclxuICB9O1xyXG59XHJcbmV4cG9ydCBkZWZhdWx0IFNoaXA7IiwiaW1wb3J0IFNoaXAgZnJvbSBcIi4vc2hpcFwiO1xyXG5pbXBvcnQgR2FtZWJvYXJkIGZyb20gXCIuL2dhbWVib2FyZFwiO1xyXG5cclxuZnVuY3Rpb24gcGxhY2VzaGlwcyhob2xkZXIsIHBsYXllcmJvYXJkKSB7XHJcbiAgaWYgKGhvbGRlciA9PT0gXCJwbGF5ZXJcIikge1xyXG4gICAgY29uc3Qgc2hpcHNMZW5ndGggPSBbNSwgNCwgMywgMl07XHJcbiAgICBsZXQgc2hpcHNsZW4gPSBzaGlwc0xlbmd0aC5sZW5ndGg7XHJcbiAgICBjb25zdCBjZWxscyA9IGRvY3VtZW50LnF1ZXJ5U2VsZWN0b3JBbGwoJy5jZWxsJyk7XHJcbiAgICBsZXQgZ2FtZSA9IHRydWU7XHJcbiAgICBsZXQgaSA9IDA7XHJcblxyXG4gICAgaWYgKGdhbWUpIHtcclxuICAgICAgY2VsbHMuZm9yRWFjaChjZWxsID0+IHtcclxuICAgICAgICBjZWxsLmFkZEV2ZW50TGlzdGVuZXIoJ2NsaWNrJywgKGV2ZW50KSA9PiB7XHJcbiAgICAgICAgICBjb25zdCBjZWxsID0gZXZlbnQudGFyZ2V0O1xyXG4gICAgICAgICAgY29uc3QgaW5kZXggPSBwYXJzZUludChjZWxsLmRhdGFzZXQuaW5kZXgpO1xyXG4gICAgICAgICAgY29uc3QgY2FuUGxhY2VTaGlwID0gY2hlY2tTaGlwUGxhY2VtZW50KHBsYXllcmJvYXJkLCBpbmRleCwgc2hpcHNMZW5ndGhbaV0pO1xyXG4gICAgICAgICAgY29uc3Qgbm9PdmVybGFwID0gY2hlY2tPdmVybGFwKGluZGV4LCBzaGlwc0xlbmd0aFtpXSk7XHJcblxyXG4gICAgICAgICAgaWYgKGNhblBsYWNlU2hpcCAmJiBub092ZXJsYXApIHtcclxuICAgICAgICAgICAgY29uc29sZS5sb2cocGxheWVyYm9hcmQuYm9hcmQpO1xyXG4gICAgICAgICAgICBjb25zdCBzaGlwID0gU2hpcChzaGlwc0xlbmd0aFtpXSk7XHJcbiAgICAgICAgICAgIHBsYXllcmJvYXJkLnBsYWNlU2hpcChzaGlwLCBpbmRleCk7ICBcclxuICAgICAgICAgICAgZm9yIChsZXQgayA9IDA7IGsgPCBzaGlwc0xlbmd0aFtpXTsgaysrKSB7XHJcbiAgICAgICAgICAgICAgZG9jdW1lbnQucXVlcnlTZWxlY3RvcihgLmgke2luZGV4ICsga31gKS5zdHlsZS5iYWNrZ3JvdW5kQ29sb3IgPSAnYmx1ZSc7XHJcbiAgICAgICAgICAgIH1cclxuICAgICAgICAgICAgaSsrO1xyXG4gICAgICAgICAgICBpZiAoaSA9PT0gc2hpcHNsZW4pIHtcclxuICAgICAgICAgICAgICBnYW1lID0gZmFsc2U7XHJcbiAgICAgICAgICAgIH1cclxuICAgICAgICAgIH1cclxuICAgICAgICB9KTtcclxuICAgICAgfSk7XHJcbiAgICB9XHJcbiAgfSBlbHNlIGlmIChob2xkZXIgPT09IFwiY29tcHV0ZXJcIikge1xyXG4gICAgY29uc3Qgc2hpcHNMZW5ndGggPSBbNSwgNCwgMywgMl07XHJcbiAgICBsZXQgc2hpcHNsZW4gPSBzaGlwc0xlbmd0aC5sZW5ndGg7XHJcbiAgICBsZXQgaSA9IDA7XHJcbiAgICBcclxuICAgIHdoaWxlIChpIDwgc2hpcHNsZW4pIHtcclxuICAgICAgbGV0IHNoaXAgPSBTaGlwKHNoaXBzTGVuZ3RoW2ldKTtcclxuICAgICAgbGV0IGluZGV4ID0gTWF0aC5mbG9vcihNYXRoLnJhbmRvbSgpICogMTAwKTtcclxuICAgICAgY29uc3Qgbm9PdmVybGFwID0gY2hlY2tPdmVybGFwKGluZGV4LCBzaGlwc0xlbmd0aFtpXSk7XHJcblxyXG4gICAgICBpZiAoIW5vT3ZlcmxhcCkgeyAvLyBDaGVjayBpZiB0aGUgc2hpcCBpcyBvdmVybGFwcGluZ1xyXG4gICAgICAgIGNvbnRpbnVlO1xyXG4gICAgICB9XHJcbiAgICAgIFxyXG4gICAgICBsZXQgdGVtcCA9IGluZGV4O1xyXG4gICAgICBwbGF5ZXJib2FyZC5wbGFjZVNoaXAoc2hpcCwgaW5kZXgpO1xyXG4gICAgICBcclxuICAgICAgZm9yIChsZXQgayA9IDA7IGsgPCBzaGlwc0xlbmd0aFtpXTsgaysrKSB7XHJcbiAgICAgICAgZG9jdW1lbnQucXVlcnlTZWxlY3RvcihgLmUke3RlbXB9YCkuc3R5bGUuYmFja2dyb3VuZENvbG9yID0gJ2JsdWUnO1xyXG4gICAgICAgIHRlbXArKztcclxuICAgICAgfVxyXG4gICAgICBcclxuICAgICAgaSsrOyBcclxuICAgIH0gICAgIFxyXG4gIH1cclxufVxyXG5cclxuZnVuY3Rpb24gY2hlY2tPdmVybGFwKHN0YXJ0SW5kZXgsIGxlbmd0aCkge1xyXG4gIGxldCBsYXN0Q2VsbEluZGV4ID0gc3RhcnRJbmRleCArIGxlbmd0aCAtIDE7XHJcbiAgbGV0IGluZGV4cm93ID0gTWF0aC5mbG9vcihzdGFydEluZGV4IC8gMTApO1xyXG4gIGxldCBsYXN0cm93ID0gTWF0aC5mbG9vcihsYXN0Q2VsbEluZGV4IC8gMTApO1xyXG4gIFxyXG4gIGlmIChsYXN0cm93ID4gaW5kZXhyb3cpIHtcclxuICAgIHJldHVybiBmYWxzZTtcclxuICB9XHJcbiAgXHJcbiAgcmV0dXJuIHRydWU7XHJcbn1cclxuXHJcbmZ1bmN0aW9uIGNoZWNrU2hpcFBsYWNlbWVudChwbGF5ZXJib2FyZCwgc3RhcnRJbmRleCwgbGVuZ3RoKSB7XHJcbiAgY29uc3QgYm9hcmQgPSBwbGF5ZXJib2FyZC5nZXRCb2FyZCgpO1xyXG4gIGZvciAobGV0IGkgPSAwOyBpIDwgbGVuZ3RoOyBpKyspIHtcclxuICAgIGNvbnN0IGluZGljZXMgPSBzdGFydEluZGV4ICsgaTtcclxuXHJcbiAgICBpZiAoYm9hcmRbaW5kaWNlc10gIT09IG51bGwpIHtcclxuICAgICAgcmV0dXJuIGZhbHNlO1xyXG4gICAgfVxyXG4gIH1cclxuICBcclxuICByZXR1cm4gdHJ1ZTtcclxufVxyXG5cclxuZXhwb3J0IHsgcGxhY2VzaGlwcyB9O1xyXG4iLCJpbXBvcnQgUGxheWVycyBmcm9tIFwiLi9wbGF5ZXJcIjtcclxuaW1wb3J0IEdhbWVib2FyZCBmcm9tIFwiLi9nYW1lYm9hcmRcIjtcclxuaW1wb3J0IFNoaXAgZnJvbSBcIi4vc2hpcFwiO1xyXG5pbXBvcnQgZG9NIGZyb20gXCIuL0RPTVwiO1xyXG5pbXBvcnQgeyBwbGFjZXNoaXBzIH0gZnJvbSBcIi4vcGxhY2VzaGlwc1wiO1xyXG5cclxuZnVuY3Rpb24gZ2FtZUxvb3AocGxheWVyMSwgcGxheWVyMikge1xyXG4gIGxldCBjb21wYm9hcmQsIHBsYXllcmJvYXJkO1xyXG4gIHBsYXllcmJvYXJkID0gR2FtZWJvYXJkKCk7XHJcbiAgY29tcGJvYXJkID0gR2FtZWJvYXJkKCk7XHJcbiAgY29uc3QgY2xpY2tlZENlbGxzID0gW107XHJcbiAgY29uc3QgcGxheWVyMWJvYXJkID0gZG9jdW1lbnQuZ2V0RWxlbWVudEJ5SWQoXCJwbGF5ZXJib2FyZFwiKTtcclxuICBjb25zdCBwbGF5ZXIyYm9hcmQgPSBkb2N1bWVudC5nZXRFbGVtZW50QnlJZChcImNvbXBib2FyZFwiKTtcclxuICBkb00ucmVuZGVyQm9hcmQocGxheWVyMWJvYXJkLFwicGxheWVyXCIpO1xyXG4gIGRvTS5yZW5kZXJCb2FyZChwbGF5ZXIyYm9hcmQsIFwiY29tcHV0ZXJcIik7XHJcblxyXG5cclxuICBwbGFjZXNoaXBzKFwicGxheWVyXCIscGxheWVyYm9hcmQpO1xyXG4gIHBsYWNlc2hpcHMoXCJjb21wdXRlclwiLGNvbXBib2FyZCk7XHJcblxyXG4gXHJcbiAgbGV0IHByZXZpb3VzQXR0YWNrID0gbmV3IFNldCgpOyAvL3RvIHByZXZlbnQgdGhlIGNvbXAgZnJvbSBhdHRhY2tpbmcgdGhlIHNhbWUgaW5kZXggdHdpY2VcclxuICBsZXQgY3VycmVudFBsYXllciA9IHBsYXllcjE7XHJcbiAgbGV0IGdhbWVPdmVyID0gZmFsc2U7XHJcblxyXG4gIGNvbnN0IGNlbGxzID0gZG9jdW1lbnQucXVlcnlTZWxlY3RvckFsbCgnLmNlbGwnKTtcclxuICBcclxuICBwbGF5ZXIyYm9hcmQuYWRkRXZlbnRMaXN0ZW5lcihcImNsaWNrXCIsIChlKSA9PiB7XHJcbiAgICBjb25zdCBpc3ZhbGlkY2xpY2sgPSBjaGVja0RvdWJsZShlKTtcclxuICAgIGlmKGlzdmFsaWRjbGljayl7XHJcbiAgICAgIGlmIChjdXJyZW50UGxheWVyICE9PSBwbGF5ZXIxIHx8IGdhbWVPdmVyKSB7XHJcbiAgICAgICAgcmV0dXJuO1xyXG4gICAgICB9XHJcbiAgICAgIGhhbmRsZUNsaWNrKGUpO1xyXG4gICAgICBjaGVja2dhbWVPdmVyKCk7XHJcbiAgICAgIGN1cnJlbnRQbGF5ZXIgPSBzd2l0Y2hQbGF5ZXIoKTtcclxuICAgICAgc2V0VGltZW91dChjb21wdXRlclR1cm4sIDUwMCk7XHJcbiAgICB9XHJcbiAgICBcclxuICB9KTtcclxuXHJcblxyXG4gIFxyXG4gIGZ1bmN0aW9uIGNoZWNrRG91YmxlKGUpe1xyXG4gICAgY29uc3QgY2VsbGluZGV4ID0gZS50YXJnZXQuZGF0YXNldC5pbmRleDtcclxuICAgIGlmKGNsaWNrZWRDZWxscy5pbmNsdWRlcyhjZWxsaW5kZXgpKXtcclxuICAgICAgcmV0dXJuIGZhbHNlO1xyXG4gICAgfVxyXG4gICAgY2xpY2tlZENlbGxzLnB1c2goY2VsbGluZGV4KTtcclxuICAgIHJldHVybiB0cnVlO1xyXG4gIH1cclxuXHJcbiAgZnVuY3Rpb24gaGFuZGxlQ2xpY2soZXZlbnQpIHtcclxuICAgIGlmIChnYW1lT3Zlcikge1xyXG4gICAgICByZXR1cm47XHJcbiAgICB9XHJcbiAgICBjb25zdCBjZWxsaW5kZXggPSBldmVudC50YXJnZXQuZGF0YXNldC5pbmRleDtcclxuICAgIGNvbnN0IHJlc3VsdCA9IGNvbXBib2FyZC5yZWNlaXZlQXR0YWNrKGNlbGxpbmRleCk7XHJcbiAgICBpZiAocmVzdWx0ID09PSB0cnVlKSB7XHJcbiAgICAgIGV2ZW50LnRhcmdldC5zdHlsZS5iYWNrZ3JvdW5kQ29sb3IgPSBcIiNmNzAyMDJcIjtcclxuICAgIH0gZWxzZSB7XHJcbiAgICAgIGV2ZW50LnRhcmdldC5zdHlsZS5iYWNrZ3JvdW5kQ29sb3IgPSBcIiM0YTQ4NDhcIjtcclxuICAgIH1cclxuICB9XHJcblxyXG4gIGZ1bmN0aW9uIGNvbXB1dGVyVHVybigpIHtcclxuICAgIGlmIChnYW1lT3Zlcikge1xyXG4gICAgICByZXR1cm47XHJcbiAgICB9XHJcbiAgICBsZXQgeCA9IE1hdGguZmxvb3IoTWF0aC5yYW5kb20oKSAqIDEwMCk7XHJcbiAgICB3aGlsZShwcmV2aW91c0F0dGFjay5oYXMoeCkpe1xyXG4gICAgICB4ID0gTWF0aC5mbG9vcihNYXRoLnJhbmRvbSgpICogMTAwKTtcclxuICAgIH1cclxuICAgIGNvbnN0IGNvbXBoaXQgPSBwbGF5ZXJib2FyZC5yZWNlaXZlQXR0YWNrKHgpO1xyXG4gICAgY29uc3QgY2VsbCA9IHBsYXllcjFib2FyZC5xdWVyeVNlbGVjdG9yKGBbZGF0YS1pbmRleD0nJHt4fSddYCk7XHJcbiAgICBpZiAoY29tcGhpdCA9PT0gdHJ1ZSkge1xyXG4gICAgICBjZWxsLnN0eWxlLmJhY2tncm91bmRDb2xvciA9IFwiI2Y3MDIwMlwiO1xyXG4gICAgfSBlbHNlIHtcclxuICAgICAgY2VsbC5zdHlsZS5iYWNrZ3JvdW5kQ29sb3IgPSBcIiM0YTQ4NDhcIjtcclxuICAgIH1cclxuICAgIHByZXZpb3VzQXR0YWNrLmFkZCh4KTtcclxuICAgIGNoZWNrZ2FtZU92ZXIoKTtcclxuICAgIGN1cnJlbnRQbGF5ZXIgPSBzd2l0Y2hQbGF5ZXIoKTtcclxuICB9XHJcblxyXG4gIGZ1bmN0aW9uIHN3aXRjaFBsYXllcigpIHtcclxuICAgIHJldHVybiAoY3VycmVudFBsYXllciA9IGN1cnJlbnRQbGF5ZXIgPT09IHBsYXllcjEgPyBwbGF5ZXIyIDogcGxheWVyMSk7XHJcbiAgfVxyXG5cclxuICBmdW5jdGlvbiBjaGVja2dhbWVPdmVyKCkge1xyXG4gICAgaWYgKHBsYXllcmJvYXJkLmFsbFNoaXBzU3VuaygpKSB7XHJcbiAgICAgIGdhbWVPdmVyID0gdHJ1ZTtcclxuICAgICAgY29uc29sZS5sb2coXCJHYW1lIG92ZXIhIENvbXB1dGVyIHdvbiFcIik7XHJcbiAgICAgIHBsYXllcjJib2FyZC5yZW1vdmVFdmVudExpc3RlbmVyKFwiY2xpY2tcIiwgaGFuZGxlQ2xpY2spO1xyXG4gICAgICByZXR1cm47XHJcbiAgICB9XHJcbiAgICBpZiAoY29tcGJvYXJkLmFsbFNoaXBzU3VuaygpKSB7XHJcbiAgICAgIGdhbWVPdmVyID0gdHJ1ZTtcclxuICAgICAgY29uc29sZS5sb2coXCJHYW1lIG92ZXIhIFBsYXllciB3b24hXCIpO1xyXG4gICAgICByZXR1cm47XHJcbiAgICB9XHJcbiAgfVxyXG59XHJcblxyXG5leHBvcnQgZGVmYXVsdCBnYW1lTG9vcDtcclxuIiwiaW1wb3J0IGRvTSBmcm9tIFwiLi9ET01cIjtcclxuaW1wb3J0IFBsYXllciBmcm9tIFwiLi9wbGF5ZXJcIjtcclxuaW1wb3J0IEdhbWVib2FyZCBmcm9tIFwiLi9nYW1lYm9hcmRcIjtcclxuaW1wb3J0IFNoaXAgZnJvbSBcIi4vc2hpcFwiO1xyXG5pbXBvcnQgZ2FtZUxvb3AgZnJvbSBcIi4vZ2FtZWxvb3BcIjtcclxuXHJcblxyXG5nYW1lTG9vcCh7bmFtZTogXCJQbGF5ZXJcIn0sIHtuYW1lOiBcIkNvbXB1dGVyXCJ9KTtcclxuIl0sIm5hbWVzIjpbImJvYXJkRWxlbWVudCIsImhvbGRlciIsImlubmVySFRNTCIsImkiLCJjZWxsIiwiZG9jdW1lbnQiLCJjcmVhdGVFbGVtZW50IiwiZGF0YXNldCIsImluZGV4IiwiY2xhc3NMaXN0IiwiYWRkIiwiaW5uZXJUZXh0IiwiYXBwZW5kQ2hpbGQiLCJib2FyZCIsIkFycmF5IiwiZmlsbCIsInNoaXBzIiwibWlzc2VkQXR0YWNrcyIsImdldEJvYXJkIiwicGxhY2VTaGlwIiwic2hpcCIsInNoaXBsZW5ndGgiLCJsZW5ndGgiLCJjb29yZGluYXRlcyIsInB1c2giLCJmb3JFYWNoIiwiY29vcmQiLCJyZWNlaXZlQXR0YWNrIiwiaGl0IiwiYWxsU2hpcHNTdW5rIiwiZXZlcnkiLCJpc1N1bmsiLCJoaXRzIiwicGxhY2VzaGlwcyIsInBsYXllcmJvYXJkIiwic2hpcHNMZW5ndGgiLCJzaGlwc2xlbiIsImNlbGxzIiwicXVlcnlTZWxlY3RvckFsbCIsImdhbWUiLCJhZGRFdmVudExpc3RlbmVyIiwiZXZlbnQiLCJ0YXJnZXQiLCJwYXJzZUludCIsImNhblBsYWNlU2hpcCIsInN0YXJ0SW5kZXgiLCJjaGVja1NoaXBQbGFjZW1lbnQiLCJub092ZXJsYXAiLCJjaGVja092ZXJsYXAiLCJjb25zb2xlIiwibG9nIiwiayIsInF1ZXJ5U2VsZWN0b3IiLCJzdHlsZSIsImJhY2tncm91bmRDb2xvciIsIk1hdGgiLCJmbG9vciIsInJhbmRvbSIsInRlbXAiLCJsYXN0Q2VsbEluZGV4IiwiaW5kZXhyb3ciLCJwbGF5ZXIxIiwicGxheWVyMiIsImNvbXBib2FyZCIsImNsaWNrZWRDZWxscyIsInBsYXllcjFib2FyZCIsImdldEVsZW1lbnRCeUlkIiwicGxheWVyMmJvYXJkIiwicHJldmlvdXNBdHRhY2siLCJTZXQiLCJjdXJyZW50UGxheWVyIiwiZ2FtZU92ZXIiLCJoYW5kbGVDbGljayIsImNlbGxpbmRleCIsInJlc3VsdCIsImNvbXB1dGVyVHVybiIsIngiLCJoYXMiLCJjb21waGl0IiwiY2hlY2tnYW1lT3ZlciIsInN3aXRjaFBsYXllciIsInJlbW92ZUV2ZW50TGlzdGVuZXIiLCJlIiwiaXN2YWxpZGNsaWNrIiwiaW5jbHVkZXMiLCJjaGVja0RvdWJsZSIsInNldFRpbWVvdXQiLCJuYW1lIl0sInNvdXJjZVJvb3QiOiIifQ==