(()=>{"use strict";const e=function(e,t){e.innerHTML="";for(let n=0;n<100;n++){const r=document.createElement("div");r.dataset.index=n,"player"==t?(r.classList.add("cell"),r.classList.add(`h${n}`)):"computer"==t&&(r.classList.add("enemycell"),r.classList.add(`e${n}`)),e.appendChild(r)}},t=function(){let e=Array(100).fill(null),t=[],n=[];return{getShips:function(){return t.length},getBoard:function(){return e},placeShip:function(n,r){let l=n.length,o=[];for(let e=0;e<l;e++)o.push(r+e);o.forEach((t=>{e[t]=n})),t.push(n)},receiveAttack:function(t){return null===e[t]?(n.push(t),!1):(e[t].hit(),!0)},allShipsSunk:function(){return t.every((e=>e.isSunk()))},missedAttacks:n}},n=function(e){let t=0;return{length:e,hit:()=>(t++,t),isSunk:()=>t===e,get hits(){return t}}};function r(e,t){if("player"===e){const e=[5,4,3,2];let r=e.length;const o=document.querySelectorAll(".cell");let u=!0,c=0;const i=document.getElementById("turn");u&&o.forEach((o=>{o.addEventListener("click",(o=>{const a=o.target,s=parseInt(a.dataset.index),d=function(e,t,n){const r=e.getBoard();for(let e=0;e<n;e++)if(null!==r[t+e])return!1;return!0}(t,s,e[c]),f=l(s,e[c]);if(i.innerText=0==c?"Place your Submarine":1==c?"Place your Attackerr":2==c?"Place your Ship":"Play",d&&f){const l=n(e[c]);t.placeShip(l,s);for(let t=0;t<e[c];t++)document.querySelector(`.h${s+t}`).style.backgroundColor="#292828";c++,c===r&&(u=!1)}}))}))}else if("computer"===e){const e=[5,4,3,2];let r=e.length,o=0;for(;o<r;){let r=n(e[o]),u=Math.floor(100*Math.random());l(u,e[o])&&(t.placeShip(r,u),o++)}}}function l(e,t){let n=e+t-1,r=Math.floor(e/10);return!(Math.floor(n/10)>r)}!function(n,l){let o,u;u=t(),o=t();const c=[],i=document.getElementById("playerboard"),a=document.getElementById("compboard");e(i,"player"),e(a,"computer"),r("player",u),r("computer",o),console.log(o.getShips());let s,d=new Set,f=n,h=!1,m=null,p=null;function y(e){if(h)return;const t=e.target.dataset.index,n=o.receiveAttack(t);e.target.style.backgroundColor=!0===n?"#f70202":"#02d91b"}function g(){null!=m||null!=p?null!=m?(s=m,m-=1):null!=p&&(s=p,p+=1):s=function(){let e=Math.floor(100*Math.random());for(;d.has(e);)e=Math.floor(100*Math.random());return m=e-1,p=e+1,e}(),function(e){if(h)return;const t=u.receiveAttack(e),n=i.querySelector(`[data-index='${e}']`);!0===t?n.style.backgroundColor="#f70202":(n.style.backgroundColor="#02d91b",null!=m?m=null:p=null),k(),f=S()}(s)}function S(){return f=f===n?l:n}function k(){return u.allShipsSunk()?(h=!0,document.getElementById("winner").innerText="Computer Win!",void a.removeEventListener("click",y)):o.allShipsSunk()?(h=!0,void(document.getElementById("winner").innerText="You Win!")):void 0}a.addEventListener("click",(e=>{const t=function(e){const t=e.target.dataset.index;return!c.includes(t)&&(c.push(t),!0)}(e);if(t){if(f!==n||h)return;y(e),k(),f=S(),setTimeout(g,100)}}))}({name:"Player"},{name:"Computer"})})();
//# sourceMappingURL=data:application/json;charset=utf-8;base64,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Q0FBWUgsR0FDakMsR0FBR0MsRUFBYSxDQUNkLEdBQUlqQixJQUFrQlgsR0FBV1ksRUFDL0IsT0FFRkcsRUFBWVksR0FDWkosSUFDQVosRUFBZ0JhLElBQ2hCTyxXQUFXYixFQUFjLElBQzNCLElBc0hKLENDdEpBLENBQVMsQ0FBQ2MsS0FBTSxVQUFXLENBQUNBLEtBQU0sWSIsInNvdXJjZXMiOlsid2VicGFjazovL3RoZS1iYXR0bGVzaGlwLy4vc2NyaXB0L0RPTS5qcyIsIndlYnBhY2s6Ly90aGUtYmF0dGxlc2hpcC8uL3NjcmlwdC9nYW1lYm9hcmQuanMiLCJ3ZWJwYWNrOi8vdGhlLWJhdHRsZXNoaXAvLi9zY3JpcHQvc2hpcC5qcyIsIndlYnBhY2s6Ly90aGUtYmF0dGxlc2hpcC8uL3NjcmlwdC9wbGFjZXNoaXBzLmpzIiwid2VicGFjazovL3RoZS1iYXR0bGVzaGlwLy4vc2NyaXB0L2dhbWVsb29wLmpzIiwid2VicGFjazovL3RoZS1iYXR0bGVzaGlwLy4vc2NyaXB0L2luZGV4LmpzIl0sInNvdXJjZXNDb250ZW50IjpbImNvbnN0IGRvTSA9ICgoKT0+e1xuICAgIGZ1bmN0aW9uIHJlbmRlckJvYXJkKGJvYXJkRWxlbWVudCwgaG9sZGVyKSB7XG4gICAgICAgIGJvYXJkRWxlbWVudC5pbm5lckhUTUwgPSAnJztcbiAgICAgICAgZm9yIChsZXQgaSA9IDA7IGkgPCAxMDA7IGkrKykge1xuICAgICAgICAgICAgY29uc3QgY2VsbCA9IGRvY3VtZW50LmNyZWF0ZUVsZW1lbnQoJ2RpdicpO1xuICAgICAgICAgICAgY2VsbC5kYXRhc2V0LmluZGV4ID0gaTtcbiAgICAgICAgICAgIGlmKGhvbGRlciA9PSBcInBsYXllclwiKXtcbiAgICAgICAgICAgICAgICBjZWxsLmNsYXNzTGlzdC5hZGQoJ2NlbGwnKTtcbiAgICAgICAgICAgICAgICBjZWxsLmNsYXNzTGlzdC5hZGQoYGgke2l9YCk7XG4gICAgICAgICAgICB9XG4gICAgICAgICAgICBlbHNlIGlmKGhvbGRlciA9PSBcImNvbXB1dGVyXCIpe1xuICAgICAgICAgICAgICAgIGNlbGwuY2xhc3NMaXN0LmFkZCgnZW5lbXljZWxsJyk7XG4gICAgICAgICAgICAgICAgY2VsbC5jbGFzc0xpc3QuYWRkKGBlJHtpfWApO1xuICAgICAgICAgICAgfVxuICAgICAgICAgICAgYm9hcmRFbGVtZW50LmFwcGVuZENoaWxkKGNlbGwpO1xuICAgICAgICB9XG4gICAgfTtcblxuICAgIHJldHVybiB7XG4gICAgICAgIHJlbmRlckJvYXJkXG4gICAgfVxufSkoKTtcblxuXG5leHBvcnQgZGVmYXVsdCBkb00iLCJpbXBvcnQgU2hpcCBmcm9tIFwiLi9zaGlwXCI7XG5mdW5jdGlvbiBHYW1lYm9hcmQoKSB7XG4gIGxldCBib2FyZCA9IEFycmF5KDEwMCkuZmlsbChudWxsKTtcbiAgbGV0IHNoaXBzID0gW107XG4gIGxldCBtaXNzZWRBdHRhY2tzID0gW107XG5cblxuICBmdW5jdGlvbiBwbGFjZVNoaXAoc2hpcCxpbmRleCkge1xuICAgIGxldCBzaGlwbGVuZ3RoID0gc2hpcC5sZW5ndGg7XG4gICAgbGV0IGNvb3JkaW5hdGVzID0gW107XG4gICAgZm9yKGxldCBpPTA7aTxzaGlwbGVuZ3RoO2krKyl7XG4gICAgICBjb29yZGluYXRlcy5wdXNoKGluZGV4K2kpO1xuICAgIH1cbiAgICBjb29yZGluYXRlcy5mb3JFYWNoKGNvb3JkID0+IHtcbiAgICAgIGJvYXJkW2Nvb3JkXSA9IHNoaXA7XG4gICAgfSk7XG4gICAgc2hpcHMucHVzaChzaGlwKTtcblxuICB9XG4gIFxuICBmdW5jdGlvbiByZWNlaXZlQXR0YWNrKGNvb3JkaW5hdGVzKSB7XG4gICAgaWYgKGJvYXJkW2Nvb3JkaW5hdGVzXSA9PT0gbnVsbCkge1xuICAgICAgbWlzc2VkQXR0YWNrcy5wdXNoKGNvb3JkaW5hdGVzKTtcbiAgICAgIHJldHVybiBmYWxzZTtcbiAgICB9XG4gICAgY29uc3QgaGl0U2hpcCA9IGJvYXJkW2Nvb3JkaW5hdGVzXTtcbiAgICBoaXRTaGlwLmhpdCgpO1xuICAgIHJldHVybiB0cnVlO1xuICB9XG5cbiAgZnVuY3Rpb24gYWxsU2hpcHNTdW5rKCkge1xuICAgIHJldHVybiBzaGlwcy5ldmVyeShzaGlwID0+IHNoaXAuaXNTdW5rKCkpO1xuICB9XG4gIGZ1bmN0aW9uIGdldEJvYXJkKCl7XG4gICAgcmV0dXJuIGJvYXJkO1xuICB9XG4gIGZ1bmN0aW9uIGdldFNoaXBzKCl7XG4gICAgcmV0dXJuIHNoaXBzLmxlbmd0aDtcbiAgfVxuICByZXR1cm4ge1xuICAgIGdldFNoaXBzLFxuICAgIGdldEJvYXJkLFxuICAgIHBsYWNlU2hpcCxcbiAgICByZWNlaXZlQXR0YWNrLFxuICAgIGFsbFNoaXBzU3VuayxcbiAgICBtaXNzZWRBdHRhY2tzLFxuICB9O1xufVxuXG5leHBvcnQgZGVmYXVsdCBHYW1lYm9hcmQ7IiwiZnVuY3Rpb24gU2hpcChsZW5ndGgpIHtcbiAgbGV0IGhpdHMgPSAwO1xuXG4gIHJldHVybiB7XG4gICAgbGVuZ3RoOiBsZW5ndGgsXG4gICAgaGl0KCkge1xuICAgICAgaGl0cysrXG4gICAgICByZXR1cm4gaGl0cztcbiAgICB9LFxuICAgIGlzU3VuaygpIHtcbiAgICAgIHJldHVybiBoaXRzID09PSBsZW5ndGg7XG4gICAgfSxcbiAgICBnZXQgaGl0cygpe1xuICAgICAgcmV0dXJuIGhpdHM7XG4gICAgfVxuICB9O1xufVxuZXhwb3J0IGRlZmF1bHQgU2hpcDsiLCJpbXBvcnQgU2hpcCBmcm9tIFwiLi9zaGlwXCI7XG5pbXBvcnQgR2FtZWJvYXJkIGZyb20gXCIuL2dhbWVib2FyZFwiO1xuXG5mdW5jdGlvbiBwbGFjZXNoaXBzKGhvbGRlciwgcGxheWVyYm9hcmQpIHtcbiAgaWYgKGhvbGRlciA9PT0gXCJwbGF5ZXJcIikge1xuICAgIGNvbnN0IHNoaXBzTGVuZ3RoID0gWzUsIDQsIDMsIDJdO1xuICAgIGxldCBzaGlwc2xlbiA9IHNoaXBzTGVuZ3RoLmxlbmd0aDtcbiAgICBjb25zdCBjZWxscyA9IGRvY3VtZW50LnF1ZXJ5U2VsZWN0b3JBbGwoJy5jZWxsJyk7XG4gICAgbGV0IGdhbWUgPSB0cnVlO1xuICAgIGxldCBpID0gMDtcbiAgICBjb25zdCB0dXJuID0gZG9jdW1lbnQuZ2V0RWxlbWVudEJ5SWQoJ3R1cm4nKTtcbiAgICBpZiAoZ2FtZSkge1xuICAgICAgY2VsbHMuZm9yRWFjaChjZWxsID0+IHtcbiAgICAgICAgY2VsbC5hZGRFdmVudExpc3RlbmVyKCdjbGljaycsIChldmVudCkgPT4ge1xuICAgICAgICAgIGNvbnN0IGNlbGwgPSBldmVudC50YXJnZXQ7XG4gICAgICAgICAgY29uc3QgaW5kZXggPSBwYXJzZUludChjZWxsLmRhdGFzZXQuaW5kZXgpO1xuICAgICAgICAgIGNvbnN0IGNhblBsYWNlU2hpcCA9IGNoZWNrU2hpcFBsYWNlbWVudChwbGF5ZXJib2FyZCwgaW5kZXgsIHNoaXBzTGVuZ3RoW2ldKTtcbiAgICAgICAgICBjb25zdCBub092ZXJsYXAgPSBjaGVja092ZXJsYXAoaW5kZXgsIHNoaXBzTGVuZ3RoW2ldKTtcbiAgICAgICAgICBpZihpID09MCl7XG4gICAgICAgICAgICB0dXJuLmlubmVyVGV4dCA9IFwiUGxhY2UgeW91ciBTdWJtYXJpbmVcIjtcbiAgICAgICAgICB9XG4gICAgICAgICAgZWxzZSBpZihpPT0xKXtcbiAgICAgICAgICAgIHR1cm4uaW5uZXJUZXh0ID0gXCJQbGFjZSB5b3VyIEF0dGFja2VyclwiO1xuICAgICAgICAgIH1cbiAgICAgICAgICBlbHNlIGlmKGk9PTIpe1xuICAgICAgICAgICAgdHVybi5pbm5lclRleHQgPSBcIlBsYWNlIHlvdXIgU2hpcFwiO1xuICAgICAgICAgIH1cbiAgICAgICAgICBlbHNle1xuICAgICAgICAgICAgdHVybi5pbm5lclRleHQgPSBcIlBsYXlcIjtcbiAgICAgICAgICB9XG4gICAgICAgICAgaWYgKGNhblBsYWNlU2hpcCAmJiBub092ZXJsYXApIHtcbiAgICAgICAgICAgIGNvbnN0IHNoaXAgPSBTaGlwKHNoaXBzTGVuZ3RoW2ldKTtcbiAgICAgICAgICAgIHBsYXllcmJvYXJkLnBsYWNlU2hpcChzaGlwLCBpbmRleCk7ICBcbiAgICAgICAgICAgIGZvciAobGV0IGsgPSAwOyBrIDwgc2hpcHNMZW5ndGhbaV07IGsrKykge1xuICAgICAgICAgICAgICBkb2N1bWVudC5xdWVyeVNlbGVjdG9yKGAuaCR7aW5kZXggKyBrfWApLnN0eWxlLmJhY2tncm91bmRDb2xvciA9IFwiIzI5MjgyOFwiO1xuICAgICAgICAgICAgfVxuICAgICAgICAgICAgaSsrO1xuICAgICAgICAgICAgaWYgKGkgPT09IHNoaXBzbGVuKSB7XG4gICAgICAgICAgICAgIGdhbWUgPSBmYWxzZTtcbiAgICAgICAgICAgIH1cbiAgICAgICAgICB9XG4gICAgICAgIH0pO1xuICAgICAgfSk7XG4gICAgfVxuICB9IGVsc2UgaWYgKGhvbGRlciA9PT0gXCJjb21wdXRlclwiKSB7XG4gICAgY29uc3Qgc2hpcHNMZW5ndGggPSBbNSwgNCwgMywgMl07XG4gICAgbGV0IHNoaXBzbGVuID0gc2hpcHNMZW5ndGgubGVuZ3RoO1xuICAgIGxldCBpID0gMDtcbiAgICBcbiAgICB3aGlsZSAoaSA8IHNoaXBzbGVuKSB7XG4gICAgICBsZXQgc2hpcCA9IFNoaXAoc2hpcHNMZW5ndGhbaV0pO1xuICAgICAgbGV0IGluZGV4ID0gTWF0aC5mbG9vcihNYXRoLnJhbmRvbSgpICogMTAwKTtcbiAgICAgIGNvbnN0IG5vT3ZlcmxhcCA9IGNoZWNrT3ZlcmxhcChpbmRleCwgc2hpcHNMZW5ndGhbaV0pO1xuXG4gICAgICBpZiAoIW5vT3ZlcmxhcCkgeyAvLyBDaGVjayBpZiB0aGUgc2hpcCBpcyBvdmVybGFwcGluZ1xuICAgICAgICBjb250aW51ZTtcbiAgICAgIH0gXG4gICAgICBwbGF5ZXJib2FyZC5wbGFjZVNoaXAoc2hpcCwgaW5kZXgpO1xuICAgICAgaSsrOyBcbiAgICB9ICAgICBcbiAgfVxufVxuXG5mdW5jdGlvbiBjaGVja092ZXJsYXAoc3RhcnRJbmRleCwgbGVuZ3RoKSB7XG4gIGxldCBsYXN0Q2VsbEluZGV4ID0gc3RhcnRJbmRleCArIGxlbmd0aCAtIDE7XG4gIGxldCBpbmRleHJvdyA9IE1hdGguZmxvb3Ioc3RhcnRJbmRleCAvIDEwKTtcbiAgbGV0IGxhc3Ryb3cgPSBNYXRoLmZsb29yKGxhc3RDZWxsSW5kZXggLyAxMCk7XG4gIFxuICBpZiAobGFzdHJvdyA+IGluZGV4cm93KSB7XG4gICAgcmV0dXJuIGZhbHNlO1xuICB9XG4gIFxuICByZXR1cm4gdHJ1ZTtcbn1cblxuZnVuY3Rpb24gY2hlY2tTaGlwUGxhY2VtZW50KHBsYXllcmJvYXJkLCBzdGFydEluZGV4LCBsZW5ndGgpIHtcbiAgY29uc3QgYm9hcmQgPSBwbGF5ZXJib2FyZC5nZXRCb2FyZCgpO1xuICBmb3IgKGxldCBpID0gMDsgaSA8IGxlbmd0aDsgaSsrKSB7XG4gICAgY29uc3QgaW5kaWNlcyA9IHN0YXJ0SW5kZXggKyBpO1xuXG4gICAgaWYgKGJvYXJkW2luZGljZXNdICE9PSBudWxsKSB7XG4gICAgICByZXR1cm4gZmFsc2U7XG4gICAgfVxuICB9XG4gIFxuICByZXR1cm4gdHJ1ZTtcbn1cblxuZXhwb3J0IHsgcGxhY2VzaGlwcyB9O1xuIiwiaW1wb3J0IFBsYXllcnMgZnJvbSBcIi4vcGxheWVyXCI7XG5pbXBvcnQgR2FtZWJvYXJkIGZyb20gXCIuL2dhbWVib2FyZFwiO1xuaW1wb3J0IFNoaXAgZnJvbSBcIi4vc2hpcFwiO1xuaW1wb3J0IGRvTSBmcm9tIFwiLi9ET01cIjtcbmltcG9ydCB7IHBsYWNlc2hpcHMgfSBmcm9tIFwiLi9wbGFjZXNoaXBzXCI7XG5cbmZ1bmN0aW9uIGdhbWVMb29wKHBsYXllcjEsIHBsYXllcjIpIHtcbiAgbGV0IGNvbXBib2FyZCwgcGxheWVyYm9hcmQ7XG4gIHBsYXllcmJvYXJkID0gR2FtZWJvYXJkKCk7XG4gIGNvbXBib2FyZCA9IEdhbWVib2FyZCgpO1xuICBjb25zdCBjbGlja2VkQ2VsbHMgPSBbXTtcbiAgY29uc3QgcGxheWVyMWJvYXJkID0gZG9jdW1lbnQuZ2V0RWxlbWVudEJ5SWQoXCJwbGF5ZXJib2FyZFwiKTtcbiAgY29uc3QgcGxheWVyMmJvYXJkID0gZG9jdW1lbnQuZ2V0RWxlbWVudEJ5SWQoXCJjb21wYm9hcmRcIik7XG4gIGRvTS5yZW5kZXJCb2FyZChwbGF5ZXIxYm9hcmQsXCJwbGF5ZXJcIik7XG4gIGRvTS5yZW5kZXJCb2FyZChwbGF5ZXIyYm9hcmQsIFwiY29tcHV0ZXJcIik7XG5cblxuICBwbGFjZXNoaXBzKFwicGxheWVyXCIscGxheWVyYm9hcmQpO1xuICBwbGFjZXNoaXBzKFwiY29tcHV0ZXJcIixjb21wYm9hcmQpO1xuXG4gY29uc29sZS5sb2coY29tcGJvYXJkLmdldFNoaXBzKCkpXG4gIGxldCBwcmV2aW91c0F0dGFjayA9IG5ldyBTZXQoKTsgLy90byBwcmV2ZW50IHRoZSBjb21wIGZyb20gYXR0YWNraW5nIHRoZSBzYW1lIGluZGV4IHR3aWNlXG4gIGxldCBjdXJyZW50UGxheWVyID0gcGxheWVyMTtcbiAgbGV0IGdhbWVPdmVyID0gZmFsc2U7XG4gIGxldCBwcmV2aW91c0hpdHMgPSBbXTtcbiAgbGV0IGxlZnQgPSBudWxsO1xuICBsZXQgcmlnaHQgPSBudWxsO1xuXG4gIFxuICBwbGF5ZXIyYm9hcmQuYWRkRXZlbnRMaXN0ZW5lcihcImNsaWNrXCIsIChlKSA9PiB7XG4gICAgY29uc3QgaXN2YWxpZGNsaWNrID0gY2hlY2tEb3VibGUoZSk7XG4gICAgaWYoaXN2YWxpZGNsaWNrKXtcbiAgICAgIGlmIChjdXJyZW50UGxheWVyICE9PSBwbGF5ZXIxIHx8IGdhbWVPdmVyKSB7XG4gICAgICAgIHJldHVybjtcbiAgICAgIH1cbiAgICAgIGhhbmRsZUNsaWNrKGUpO1xuICAgICAgY2hlY2tnYW1lT3ZlcigpO1xuICAgICAgY3VycmVudFBsYXllciA9IHN3aXRjaFBsYXllcigpO1xuICAgICAgc2V0VGltZW91dChjb21wdXRlclR1cm4sIDEwMCk7XG4gICAgfVxuICAgIFxuICB9KTtcbiAgXG4gIGZ1bmN0aW9uIGNoZWNrRG91YmxlKGUpe1xuICAgIGNvbnN0IGNlbGxpbmRleCA9IGUudGFyZ2V0LmRhdGFzZXQuaW5kZXg7XG4gICAgaWYoY2xpY2tlZENlbGxzLmluY2x1ZGVzKGNlbGxpbmRleCkpe1xuICAgICAgcmV0dXJuIGZhbHNlO1xuICAgIH1cbiAgICBjbGlja2VkQ2VsbHMucHVzaChjZWxsaW5kZXgpO1xuICAgIHJldHVybiB0cnVlO1xuICB9XG5cbiAgZnVuY3Rpb24gaGFuZGxlQ2xpY2soZXZlbnQpIHtcbiAgICBpZiAoZ2FtZU92ZXIpIHtcbiAgICAgIHJldHVybjtcbiAgICB9XG4gICAgY29uc3QgY2VsbGluZGV4ID0gZXZlbnQudGFyZ2V0LmRhdGFzZXQuaW5kZXg7XG4gICAgY29uc3QgcmVzdWx0ID0gY29tcGJvYXJkLnJlY2VpdmVBdHRhY2soY2VsbGluZGV4KTtcbiAgICBpZiAocmVzdWx0ID09PSB0cnVlKSB7XG4gICAgICBldmVudC50YXJnZXQuc3R5bGUuYmFja2dyb3VuZENvbG9yID0gXCIjZjcwMjAyXCI7XG4gICAgfSBlbHNlIHtcbiAgICAgIGV2ZW50LnRhcmdldC5zdHlsZS5iYWNrZ3JvdW5kQ29sb3IgPSBcIiMwMmQ5MWJcIjtcbiAgICB9XG4gIH1cbiAgbGV0IGF0dGFja0luZGV4O1xuXG4gIGZ1bmN0aW9uIGNvbXB1dGVyVHVybigpIHtcbiAgICAvLyBpZihwcmV2aW91c0hpdHMubGVuZ3RoID4gMCl7XG4gICAgaWYobGVmdCE9bnVsbCB8fCByaWdodCE9bnVsbCl7XG4gICAgICAvLyBjb25zdCBsYXN0QXR0YWNrID0gcHJldmlvdXNIaXRzW3ByZXZpb3VzSGl0cy5sZW5ndGggLSAxXTtcbiAgICAgIC8vIGNvbnN0IGxhc3RBZGphY2VudEluZGV4ID0gZ2V0QWRqYWNlbnRJbmRleChsYXN0QXR0YWNrKTtcbiAgICAgIC8vIGNvbnNvbGUubG9nKGxhc3RBZGphY2VudEluZGV4KTtcbiAgICAgIC8vIGZvcihjb25zdCBpbmRleCBvZiBsYXN0QWRqYWNlbnRJbmRleCl7XG4gICAgICAvLyAgIGlmKCFwcmV2aW91c0F0dGFjay5oYXMoaW5kZXgpKXtcbiAgICAgIC8vICAgICBhdHRhY2tJbmRleCA9IGluZGV4O1xuICAgICAgLy8gICAgIGJyZWFrO1xuICAgICAgLy8gICB9XG4gICAgICAvLyB9XG4gICAgICAvLyBwcmV2aW91c0hpdHMucG9wKCk7IFxuICAgICAgaWYobGVmdCAhPSBudWxsKXtcbiAgICAgICAgYXR0YWNrSW5kZXggPSBsZWZ0XG4gICAgICAgIGxlZnQgPSBsZWZ0IC0gMVxuICAgICAgfVxuICAgICAgZWxzZSBpZihyaWdodCAhPSBudWxsKXtcbiAgICAgICAgYXR0YWNrSW5kZXggPSByaWdodFxuICAgICAgICByaWdodCA9IHJpZ2h0ICsgMVxuICAgICAgfVxuICAgIH1cbiAgICBlbHNle1xuICAgICAgYXR0YWNrSW5kZXggPSByYW5kb21BdHRhY2soKTtcbiAgICB9XG4gICAgXG4gICAgY29tcHV0ZXJBSShhdHRhY2tJbmRleCk7XG4gIH1cblxuICBmdW5jdGlvbiByYW5kb21BdHRhY2soKXtcbiAgICBsZXQgeCA9IE1hdGguZmxvb3IoTWF0aC5yYW5kb20oKSAqIDEwMCk7XG4gICAgd2hpbGUocHJldmlvdXNBdHRhY2suaGFzKHgpKXtcbiAgICAgIHggPSBNYXRoLmZsb29yKE1hdGgucmFuZG9tKCkgKiAxMDApO1xuICAgIH1cbiAgICBsZWZ0ID0geCAtIDFcbiAgICByaWdodCA9IHggKyAxXG4gICAgcmV0dXJuIHg7XG4gIH1cbiAgXG4gIGZ1bmN0aW9uIGNvbXB1dGVyQUkoaSl7XG4gICAgaWYgKGdhbWVPdmVyKSB7XG4gICAgICByZXR1cm47XG4gICAgfVxuICAgIGNvbnN0IGNvbXBoaXQgPSBwbGF5ZXJib2FyZC5yZWNlaXZlQXR0YWNrKGkpO1xuICAgIGNvbnN0IGNlbGwgPSBwbGF5ZXIxYm9hcmQucXVlcnlTZWxlY3RvcihgW2RhdGEtaW5kZXg9JyR7aX0nXWApO1xuICAgIGlmIChjb21waGl0ID09PSB0cnVlKSB7XG4gICAgICBjZWxsLnN0eWxlLmJhY2tncm91bmRDb2xvciA9IFwiI2Y3MDIwMlwiO1xuICAgICAgLy8gcHJldmlvdXNIaXRzLnB1c2goaSk7XG4gICAgICAvLyBjb25zb2xlLmxvZyhwcmV2aW91c0hpdHMpO1xuICAgIH0gZWxzZSB7XG4gICAgICBjZWxsLnN0eWxlLmJhY2tncm91bmRDb2xvciA9IFwiIzAyZDkxYlwiO1xuICAgICAgaWYobGVmdCAhPSBudWxsKVxuICAgICAgICBsZWZ0ID0gbnVsbFxuICAgICAgZWxzZVxuICAgICAgICByaWdodCA9IG51bGxcbiAgICB9XG4gICAgLy8gcHJldmlvdXNBdHRhY2suYWRkKGkpO1xuICAgIGNoZWNrZ2FtZU92ZXIoKTtcbiAgICBjdXJyZW50UGxheWVyID0gc3dpdGNoUGxheWVyKCk7XG4gIH1cblxuICBmdW5jdGlvbiBnZXRBZGphY2VudEluZGV4KGluZGV4KXtcbiAgICBjb25zdCBhZGphY2VudEluZGV4ZXMgPSBbXTtcbiAgICBjb25zdCBjb2wgPSBpbmRleCAlIDEwO1xuICAgIGlmKGNvbCA+IDApe1xuICAgICAgYWRqYWNlbnRJbmRleGVzLnB1c2goaW5kZXggLSAxKTtcbiAgICB9XG4gICAgaWYoY29sIDwgOSl7XG4gICAgICBhZGphY2VudEluZGV4ZXMucHVzaChpbmRleCArIDEpO1xuICAgIH1cbiAgICByZXR1cm4gYWRqYWNlbnRJbmRleGVzO1xuICB9XG5cblxuICBmdW5jdGlvbiBzd2l0Y2hQbGF5ZXIoKSB7XG4gICAgcmV0dXJuIChjdXJyZW50UGxheWVyID0gY3VycmVudFBsYXllciA9PT0gcGxheWVyMSA/IHBsYXllcjIgOiBwbGF5ZXIxKTtcbiAgfVxuXG4gIGZ1bmN0aW9uIGNoZWNrZ2FtZU92ZXIoKSB7XG4gICAgaWYgKHBsYXllcmJvYXJkLmFsbFNoaXBzU3VuaygpKSB7XG4gICAgICBnYW1lT3ZlciA9IHRydWU7XG4gICAgICBkb2N1bWVudC5nZXRFbGVtZW50QnlJZCgnd2lubmVyJykuaW5uZXJUZXh0ID0gXCJDb21wdXRlciBXaW4hXCI7XG4gICAgICBwbGF5ZXIyYm9hcmQucmVtb3ZlRXZlbnRMaXN0ZW5lcihcImNsaWNrXCIsIGhhbmRsZUNsaWNrKTtcbiAgICAgIHJldHVybjtcbiAgICB9XG4gICAgaWYgKGNvbXBib2FyZC5hbGxTaGlwc1N1bmsoKSkge1xuICAgICAgZ2FtZU92ZXIgPSB0cnVlO1xuICAgICAgZG9jdW1lbnQuZ2V0RWxlbWVudEJ5SWQoJ3dpbm5lcicpLmlubmVyVGV4dCA9IFwiWW91IFdpbiFcIjtcbiAgICAgIHJldHVybjtcbiAgICB9XG4gIH1cbn1cblxuZXhwb3J0IGRlZmF1bHQgZ2FtZUxvb3A7XG4iLCJpbXBvcnQgZG9NIGZyb20gXCIuL0RPTVwiO1xuaW1wb3J0IFBsYXllciBmcm9tIFwiLi9wbGF5ZXJcIjtcbmltcG9ydCBHYW1lYm9hcmQgZnJvbSBcIi4vZ2FtZWJvYXJkXCI7XG5pbXBvcnQgU2hpcCBmcm9tIFwiLi9zaGlwXCI7XG5pbXBvcnQgZ2FtZUxvb3AgZnJvbSBcIi4vZ2FtZWxvb3BcIjtcblxuXG5nYW1lTG9vcCh7bmFtZTogXCJQbGF5ZXJcIn0sIHtuYW1lOiBcIkNvbXB1dGVyXCJ9KTtcbiJdLCJuYW1lcyI6WyJib2FyZEVsZW1lbnQiLCJob2xkZXIiLCJpbm5lckhUTUwiLCJpIiwiY2VsbCIsImRvY3VtZW50IiwiY3JlYXRlRWxlbWVudCIsImRhdGFzZXQiLCJpbmRleCIsImNsYXNzTGlzdCIsImFkZCIsImFwcGVuZENoaWxkIiwiYm9hcmQiLCJBcnJheSIsImZpbGwiLCJzaGlwcyIsIm1pc3NlZEF0dGFja3MiLCJnZXRTaGlwcyIsImxlbmd0aCIsImdldEJvYXJkIiwicGxhY2VTaGlwIiwic2hpcCIsInNoaXBsZW5ndGgiLCJjb29yZGluYXRlcyIsInB1c2giLCJmb3JFYWNoIiwiY29vcmQiLCJyZWNlaXZlQXR0YWNrIiwiaGl0IiwiYWxsU2hpcHNTdW5rIiwiZXZlcnkiLCJpc1N1bmsiLCJoaXRzIiwicGxhY2VzaGlwcyIsInBsYXllcmJvYXJkIiwic2hpcHNMZW5ndGgiLCJzaGlwc2xlbiIsImNlbGxzIiwicXVlcnlTZWxlY3RvckFsbCIsImdhbWUiLCJ0dXJuIiwiZ2V0RWxlbWVudEJ5SWQiLCJhZGRFdmVudExpc3RlbmVyIiwiZXZlbnQiLCJ0YXJnZXQiLCJwYXJzZUludCIsImNhblBsYWNlU2hpcCIsInN0YXJ0SW5kZXgiLCJjaGVja1NoaXBQbGFjZW1lbnQiLCJub092ZXJsYXAiLCJjaGVja092ZXJsYXAiLCJpbm5lclRleHQiLCJrIiwicXVlcnlTZWxlY3RvciIsInN0eWxlIiwiYmFja2dyb3VuZENvbG9yIiwiTWF0aCIsImZsb29yIiwicmFuZG9tIiwibGFzdENlbGxJbmRleCIsImluZGV4cm93IiwicGxheWVyMSIsInBsYXllcjIiLCJjb21wYm9hcmQiLCJjbGlja2VkQ2VsbHMiLCJwbGF5ZXIxYm9hcmQiLCJwbGF5ZXIyYm9hcmQiLCJjb25zb2xlIiwibG9nIiwiYXR0YWNrSW5kZXgiLCJwcmV2aW91c0F0dGFjayIsIlNldCIsImN1cnJlbnRQbGF5ZXIiLCJnYW1lT3ZlciIsImxlZnQiLCJyaWdodCIsImhhbmRsZUNsaWNrIiwiY2VsbGluZGV4IiwicmVzdWx0IiwiY29tcHV0ZXJUdXJuIiwieCIsImhhcyIsInJhbmRvbUF0dGFjayIsImNvbXBoaXQiLCJjaGVja2dhbWVPdmVyIiwic3dpdGNoUGxheWVyIiwiY29tcHV0ZXJBSSIsInJlbW92ZUV2ZW50TGlzdGVuZXIiLCJlIiwiaXN2YWxpZGNsaWNrIiwiaW5jbHVkZXMiLCJjaGVja0RvdWJsZSIsInNldFRpbWVvdXQiLCJuYW1lIl0sInNvdXJjZVJvb3QiOiIifQ==